import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/vite/pages/auth-callback.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=9303f522"; const Fragment = __vite__cjsImport0_react_jsxDevRuntime["Fragment"]; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = RefreshRuntime.getRefreshReg("C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx");
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=9303f522"; const useEffect = __vite__cjsImport3_react["useEffect"]; const useState = __vite__cjsImport3_react["useState"];
import { useNavigate, useSearchParams } from "/node_modules/.vite/deps/react-router-dom.js?v=9303f522";
import { supabase } from "/src/lib/supabase/client.ts";
import { DEFAULT_AUTH_REDIRECT, sanitizeRedirect } from "/src/lib/auth/roles.ts";
import { useAuth } from "/src/vite/auth/auth-provider.tsx";
export function AuthCallbackPage() {
  _s();
  const navigate = useNavigate();
  const [params] = useSearchParams();
  const auth = useAuth();
  const [error, setError] = useState(null);
  useEffect(() => {
    const handleCallback = async () => {
      try {
        const code = params.get("code");
        if (!code) {
          const errorParam = params.get("error");
          const errorDescription = params.get("error_description");
          if (errorParam) {
            console.error("OAuth error:", errorParam, errorDescription);
            setError(errorDescription || "Authentication failed");
            setTimeout(() => {
              navigate("/login?error=oauth_failed", { replace: true });
            }, 2e3);
            return;
          }
          if (auth.session) {
            const redirectTo2 = sanitizeRedirect(params.get("redirectTo")) ?? DEFAULT_AUTH_REDIRECT;
            navigate(redirectTo2, { replace: true });
            return;
          }
          navigate("/login?error=invalid_callback", { replace: true });
          return;
        }
        const { data, error: exchangeError } = await supabase.auth.exchangeCodeForSession(code);
        if (exchangeError) {
          console.error("Error exchanging code for session:", exchangeError);
          setError("Failed to complete authentication");
          setTimeout(() => {
            navigate("/login?error=session_exchange_failed", { replace: true });
          }, 2e3);
          return;
        }
        if (!data.session) {
          setError("No session created");
          setTimeout(() => {
            navigate("/login?error=no_session", { replace: true });
          }, 2e3);
          return;
        }
        await auth.refresh();
        const redirectTo = sanitizeRedirect(params.get("redirectTo")) ?? DEFAULT_AUTH_REDIRECT;
        navigate(redirectTo, { replace: true });
      } catch (err) {
        console.error("Callback error:", err);
        setError("An unexpected error occurred");
        setTimeout(() => {
          navigate("/login?error=callback_error", { replace: true });
        }, 2e3);
      }
    };
    handleCallback();
  }, [params, navigate, auth]);
  return /* @__PURE__ */ jsxDEV("main", { className: "flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 px-4 py-12", children: /* @__PURE__ */ jsxDEV("div", { className: "w-full max-w-md rounded-2xl border border-white/10 bg-white/5 p-8 shadow-2xl backdrop-blur-lg text-center", children: error ? /* @__PURE__ */ jsxDEV(Fragment, { children: [
    /* @__PURE__ */ jsxDEV("div", { className: "mb-4 text-4xl", children: "⚠️" }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
      lineNumber: 108,
      columnNumber: 13
    }, this),
    /* @__PURE__ */ jsxDEV("h1", { className: "text-xl font-semibold text-white mb-2", children: "Authentication Error" }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
      lineNumber: 109,
      columnNumber: 13
    }, this),
    /* @__PURE__ */ jsxDEV("p", { className: "text-sm text-white/70 mb-4", children: error }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
      lineNumber: 110,
      columnNumber: 13
    }, this),
    /* @__PURE__ */ jsxDEV("p", { className: "text-xs text-white/50", children: "Redirecting to login..." }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
      lineNumber: 111,
      columnNumber: 13
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
    lineNumber: 107,
    columnNumber: 9
  }, this) : /* @__PURE__ */ jsxDEV(Fragment, { children: [
    /* @__PURE__ */ jsxDEV("div", { className: "mb-4", children: /* @__PURE__ */ jsxDEV("div", { className: "inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary" }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
      lineNumber: 116,
      columnNumber: 15
    }, this) }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
      lineNumber: 115,
      columnNumber: 13
    }, this),
    /* @__PURE__ */ jsxDEV("h1", { className: "text-xl font-semibold text-white mb-2", children: "Completing sign in..." }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
      lineNumber: 118,
      columnNumber: 13
    }, this),
    /* @__PURE__ */ jsxDEV("p", { className: "text-sm text-white/70", children: "Please wait while we authenticate your account." }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
      lineNumber: 119,
      columnNumber: 13
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
    lineNumber: 114,
    columnNumber: 9
  }, this) }, void 0, false, {
    fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
    lineNumber: 105,
    columnNumber: 7
  }, this) }, void 0, false, {
    fileName: "C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx",
    lineNumber: 104,
    columnNumber: 5
  }, this);
}
_s(AuthCallbackPage, "P9yERnfirKb76k0Vy4DOs6Pwqtg=", false, function() {
  return [useNavigate, useSearchParams, useAuth];
});
_c = AuthCallbackPage;
var _c;
$RefreshReg$(_c, "AuthCallbackPage");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/Projects/Source 4 Industries/src/vite/pages/auth-callback.tsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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LHVCQUFDLE9BQUUsV0FBVSw4QkFBOEJBLG1CQUEzQztBQUFBO0FBQUE7QUFBQTtBQUFBLFdBQWlEO0FBQUEsSUFDakQsdUJBQUMsT0FBRSxXQUFVLHlCQUF3Qix1Q0FBckM7QUFBQTtBQUFBO0FBQUE7QUFBQSxXQUE0RDtBQUFBLE9BSjlEO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0FLQSxJQUVBLG1DQUNFO0FBQUEsMkJBQUMsU0FBSSxXQUFVLFFBQ2IsaUNBQUMsU0FBSSxXQUFVLDhFQUFmO0FBQUE7QUFBQTtBQUFBO0FBQUEsV0FBMEYsS0FENUY7QUFBQTtBQUFBO0FBQUE7QUFBQSxXQUVBO0FBQUEsSUFDQSx1QkFBQyxRQUFHLFdBQVUseUNBQXdDLHFDQUF0RDtBQUFBO0FBQUE7QUFBQTtBQUFBLFdBQTJFO0FBQUEsSUFDM0UsdUJBQUMsT0FBRSxXQUFVLHlCQUF3QiwrREFBckM7QUFBQTtBQUFBO0FBQUE7QUFBQSxXQUFvRjtBQUFBLE9BTHRGO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0FNQSxLQWZKO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0FpQkEsS0FsQkY7QUFBQTtBQUFBO0FBQUE7QUFBQSxTQW1CQTtBQUVKO0FBQUNKLEdBbEdlRCxrQkFBZ0I7QUFBQSxVQUNiTixhQUNBQyxpQkFDSkksT0FBTztBQUFBO0FBQUF1QixLQUhOdEI7QUFBZ0IsSUFBQXNCO0FBQUFDLGFBQUFELElBQUEiLCJuYW1lcyI6WyJ1c2VFZmZlY3QiLCJ1c2VTdGF0ZSIsInVzZU5hdmlnYXRlIiwidXNlU2VhcmNoUGFyYW1zIiwic3VwYWJhc2UiLCJERUZBVUxUX0FVVEhfUkVESVJFQ1QiLCJzYW5pdGl6ZVJlZGlyZWN0IiwidXNlQXV0aCIsIkF1dGhDYWxsYmFja1BhZ2UiLCJfcyIsIm5hdmlnYXRlIiwicGFyYW1zIiwiYXV0aCIsImVycm9yIiwic2V0RXJyb3IiLCJoYW5kbGVDYWxsYmFjayIsImNvZGUiLCJnZXQiLCJlcnJvclBhcmFtIiwiZXJyb3JEZXNjcmlwdGlvbiIsImNvbnNvbGUiLCJzZXRUaW1lb3V0IiwicmVwbGFjZSIsInNlc3Npb24iLCJyZWRpcmVjdFRvIiwiZGF0YSIsImV4Y2hhbmdlRXJyb3IiLCJleGNoYW5nZUNvZGVGb3JTZXNzaW9uIiwicmVmcmVzaCIsImVyciIsIl9jIiwiJFJlZnJlc2hSZWckIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbImF1dGgtY2FsbGJhY2sudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZU5hdmlnYXRlLCB1c2VTZWFyY2hQYXJhbXMgfSBmcm9tIFwicmVhY3Qtcm91dGVyLWRvbVwiO1xuXG5pbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gXCJAL2xpYi9zdXBhYmFzZS9jbGllbnRcIjtcbmltcG9ydCB7IERFRkFVTFRfQVVUSF9SRURJUkVDVCwgc2FuaXRpemVSZWRpcmVjdCB9IGZyb20gXCJAL2xpYi9hdXRoL3JvbGVzXCI7XG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSBcIi4uL2F1dGgvYXV0aC1wcm92aWRlclwiO1xuXG5leHBvcnQgZnVuY3Rpb24gQXV0aENhbGxiYWNrUGFnZSgpIHtcbiAgY29uc3QgbmF2aWdhdGUgPSB1c2VOYXZpZ2F0ZSgpO1xuICBjb25zdCBbcGFyYW1zXSA9IHVzZVNlYXJjaFBhcmFtcygpO1xuICBjb25zdCBhdXRoID0gdXNlQXV0aCgpO1xuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlQ2FsbGJhY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBHZXQgdGhlIE9BdXRoIGNvZGUgZnJvbSBVUkwgcGFyYW1zXG4gICAgICAgIGNvbnN0IGNvZGUgPSBwYXJhbXMuZ2V0KFwiY29kZVwiKTtcblxuICAgICAgICBpZiAoIWNvZGUpIHtcbiAgICAgICAgICAvLyBDaGVjayBmb3IgZXJyb3IgaW4gcGFyYW1zXG4gICAgICAgICAgY29uc3QgZXJyb3JQYXJhbSA9IHBhcmFtcy5nZXQoXCJlcnJvclwiKTtcbiAgICAgICAgICBjb25zdCBlcnJvckRlc2NyaXB0aW9uID0gcGFyYW1zLmdldChcImVycm9yX2Rlc2NyaXB0aW9uXCIpO1xuXG4gICAgICAgICAgaWYgKGVycm9yUGFyYW0pIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJPQXV0aCBlcnJvcjpcIiwgZXJyb3JQYXJhbSwgZXJyb3JEZXNjcmlwdGlvbik7XG4gICAgICAgICAgICBzZXRFcnJvcihlcnJvckRlc2NyaXB0aW9uIHx8IFwiQXV0aGVudGljYXRpb24gZmFpbGVkXCIpO1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIG5hdmlnYXRlKFwiL2xvZ2luP2Vycm9yPW9hdXRoX2ZhaWxlZFwiLCB7IHJlcGxhY2U6IHRydWUgfSk7XG4gICAgICAgICAgICB9LCAyMDAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBObyBjb2RlIGFuZCBubyBlcnJvciAtIG1pZ2h0IGJlIGFscmVhZHkgYXV0aGVudGljYXRlZFxuICAgICAgICAgIGlmIChhdXRoLnNlc3Npb24pIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZGlyZWN0VG8gPSBzYW5pdGl6ZVJlZGlyZWN0KHBhcmFtcy5nZXQoXCJyZWRpcmVjdFRvXCIpKSA/PyBERUZBVUxUX0FVVEhfUkVESVJFQ1Q7XG4gICAgICAgICAgICBuYXZpZ2F0ZShyZWRpcmVjdFRvLCB7IHJlcGxhY2U6IHRydWUgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gSW52YWxpZCBzdGF0ZVxuICAgICAgICAgIG5hdmlnYXRlKFwiL2xvZ2luP2Vycm9yPWludmFsaWRfY2FsbGJhY2tcIiwgeyByZXBsYWNlOiB0cnVlIH0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEV4Y2hhbmdlIGNvZGUgZm9yIHNlc3Npb25cbiAgICAgICAgY29uc3QgeyBkYXRhLCBlcnJvcjogZXhjaGFuZ2VFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5leGNoYW5nZUNvZGVGb3JTZXNzaW9uKGNvZGUpO1xuXG4gICAgICAgIGlmIChleGNoYW5nZUVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGV4Y2hhbmdpbmcgY29kZSBmb3Igc2Vzc2lvbjpcIiwgZXhjaGFuZ2VFcnJvcik7XG4gICAgICAgICAgc2V0RXJyb3IoXCJGYWlsZWQgdG8gY29tcGxldGUgYXV0aGVudGljYXRpb25cIik7XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBuYXZpZ2F0ZShcIi9sb2dpbj9lcnJvcj1zZXNzaW9uX2V4Y2hhbmdlX2ZhaWxlZFwiLCB7IHJlcGxhY2U6IHRydWUgfSk7XG4gICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFkYXRhLnNlc3Npb24pIHtcbiAgICAgICAgICBzZXRFcnJvcihcIk5vIHNlc3Npb24gY3JlYXRlZFwiKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIG5hdmlnYXRlKFwiL2xvZ2luP2Vycm9yPW5vX3Nlc3Npb25cIiwgeyByZXBsYWNlOiB0cnVlIH0pO1xuICAgICAgICAgIH0sIDIwMDApO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlZnJlc2ggYXV0aCBzdGF0ZVxuICAgICAgICBhd2FpdCBhdXRoLnJlZnJlc2goKTtcblxuICAgICAgICAvLyBSZWRpcmVjdCB0byBpbnRlbmRlZCBkZXN0aW5hdGlvblxuICAgICAgICBjb25zdCByZWRpcmVjdFRvID0gc2FuaXRpemVSZWRpcmVjdChwYXJhbXMuZ2V0KFwicmVkaXJlY3RUb1wiKSkgPz8gREVGQVVMVF9BVVRIX1JFRElSRUNUO1xuICAgICAgICBuYXZpZ2F0ZShyZWRpcmVjdFRvLCB7IHJlcGxhY2U6IHRydWUgfSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNhbGxiYWNrIGVycm9yOlwiLCBlcnIpO1xuICAgICAgICBzZXRFcnJvcihcIkFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWRcIik7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIG5hdmlnYXRlKFwiL2xvZ2luP2Vycm9yPWNhbGxiYWNrX2Vycm9yXCIsIHsgcmVwbGFjZTogdHJ1ZSB9KTtcbiAgICAgICAgfSwgMjAwMCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGhhbmRsZUNhbGxiYWNrKCk7XG4gIH0sIFtwYXJhbXMsIG5hdmlnYXRlLCBhdXRoXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8bWFpbiBjbGFzc05hbWU9XCJmbGV4IG1pbi1oLXNjcmVlbiBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgYmctZ3JhZGllbnQtdG8tYnIgZnJvbS1zbGF0ZS05NTAgdmlhLXNsYXRlLTkwMCB0by1zbGF0ZS05NTAgcHgtNCBweS0xMlwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LWZ1bGwgbWF4LXctbWQgcm91bmRlZC0yeGwgYm9yZGVyIGJvcmRlci13aGl0ZS8xMCBiZy13aGl0ZS81IHAtOCBzaGFkb3ctMnhsIGJhY2tkcm9wLWJsdXItbGcgdGV4dC1jZW50ZXJcIj5cbiAgICAgICAge2Vycm9yID8gKFxuICAgICAgICAgIDw+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1iLTQgdGV4dC00eGxcIj7imqDvuI88L2Rpdj5cbiAgICAgICAgICAgIDxoMSBjbGFzc05hbWU9XCJ0ZXh0LXhsIGZvbnQtc2VtaWJvbGQgdGV4dC13aGl0ZSBtYi0yXCI+QXV0aGVudGljYXRpb24gRXJyb3I8L2gxPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXdoaXRlLzcwIG1iLTRcIj57ZXJyb3J9PC9wPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LXdoaXRlLzUwXCI+UmVkaXJlY3RpbmcgdG8gbG9naW4uLi48L3A+XG4gICAgICAgICAgPC8+XG4gICAgICAgICkgOiAoXG4gICAgICAgICAgPD5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWItNFwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImlubGluZS1ibG9jayBhbmltYXRlLXNwaW4gcm91bmRlZC1mdWxsIGgtOCB3LTggYm9yZGVyLWItMiBib3JkZXItcHJpbWFyeVwiPjwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8aDEgY2xhc3NOYW1lPVwidGV4dC14bCBmb250LXNlbWlib2xkIHRleHQtd2hpdGUgbWItMlwiPkNvbXBsZXRpbmcgc2lnbiBpbi4uLjwvaDE+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtd2hpdGUvNzBcIj5QbGVhc2Ugd2FpdCB3aGlsZSB3ZSBhdXRoZW50aWNhdGUgeW91ciBhY2NvdW50LjwvcD5cbiAgICAgICAgICA8Lz5cbiAgICAgICAgKX1cbiAgICAgIDwvZGl2PlxuICAgIDwvbWFpbj5cbiAgKTtcbn1cbiJdLCJmaWxlIjoiQzovUHJvamVjdHMvU291cmNlIDQgSW5kdXN0cmllcy9zcmMvdml0ZS9wYWdlcy9hdXRoLWNhbGxiYWNrLnRzeCJ9