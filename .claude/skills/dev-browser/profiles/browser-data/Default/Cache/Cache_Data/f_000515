import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/pages/data/merchant-center/merchant-center-client.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=96fa1abf"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = RefreshRuntime.getRefreshReg("C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx");
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=96fa1abf"; const useState = __vite__cjsImport3_react["useState"];
import { SectionHeader } from "/src/components/section-header.tsx";
import { InlineAlert } from "/src/components/ui/inline-alert.tsx?t=1768449300285";
import { SyncButton } from "/src/pages/data/merchant-center/sync-button.tsx";
import { FeedHealthMetrics } from "/src/pages/data/merchant-center/feed-health-metrics.tsx";
import { FeedHealthCharts } from "/src/pages/data/merchant-center/feed-health-charts.tsx";
import { ProductTable } from "/src/pages/data/merchant-center/product-table.tsx";
import { AlertsList } from "/src/pages/data/merchant-center/alerts-list.tsx";
export function MerchantCenterClient({
  summary,
  products,
  alerts,
  dailyMetrics,
  errorBreakdown,
  onSync,
  syncing
}) {
  _s();
  const [acknowledgingAlerts, setAcknowledgingAlerts] = useState(/* @__PURE__ */ new Set());
  const handleFetchIssues = async (productId) => {
    try {
      const res = await fetch(`/api/data/merchant-center/products/${productId}/issues`);
      if (!res.ok) {
        throw new Error(`Failed to fetch issues: ${res.status}`);
      }
      const data = await res.json();
      return data.data?.data || [];
    } catch (error) {
      console.error("Error fetching product issues:", error);
      return [];
    }
  };
  const handleAcknowledgeAlert = async (alertId) => {
    setAcknowledgingAlerts((prev) => new Set(prev).add(alertId));
    try {
      const res = await fetch(`/api/data/merchant-center/alerts/${alertId}/acknowledge`, {
        method: "POST"
      });
      if (res.ok) {
        window.location.reload();
      } else {
        console.error("Failed to acknowledge alert");
      }
    } catch (error) {
      console.error("Error acknowledging alert:", error);
    } finally {
      setAcknowledgingAlerts((prev) => {
        const next = new Set(prev);
        next.delete(alertId);
        return next;
      });
    }
  };
  if (summary.error || !summary.data) {
    return /* @__PURE__ */ jsxDEV("div", { className: "space-y-8", children: [
      /* @__PURE__ */ jsxDEV(
        SectionHeader,
        {
          title: "Merchant Center",
          description: "Monitor Google Merchant Center product feed status and health"
        },
        void 0,
        false,
        {
          fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
          lineNumber: 106,
          columnNumber: 9
        },
        this
      ),
      /* @__PURE__ */ jsxDEV(
        InlineAlert,
        {
          variant: "warning",
          message: summary.error || "Failed to load merchant center summary"
        },
        void 0,
        false,
        {
          fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
          lineNumber: 110,
          columnNumber: 9
        },
        this
      )
    ] }, void 0, true, {
      fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
      lineNumber: 105,
      columnNumber: 7
    }, this);
  }
  const summaryData = summary.data;
  const productsData = products.data || [];
  const alertsData = alerts.data || [];
  const dailyMetricsData = dailyMetrics.data || [];
  const errorBreakdownData = errorBreakdown.data || [];
  return /* @__PURE__ */ jsxDEV("div", { className: "flex flex-col gap-8 p-6", children: [
    /* @__PURE__ */ jsxDEV("div", { className: "flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4", children: [
      /* @__PURE__ */ jsxDEV(
        SectionHeader,
        {
          title: "Merchant Center",
          description: "Monitor Google Merchant Center product feed status and health"
        },
        void 0,
        false,
        {
          fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
          lineNumber: 128,
          columnNumber: 9
        },
        this
      ),
      /* @__PURE__ */ jsxDEV(
        SyncButton,
        {
          onSync,
          syncing,
          lastSyncedAt: summaryData.lastSyncedAt
        },
        void 0,
        false,
        {
          fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
          lineNumber: 132,
          columnNumber: 9
        },
        this
      )
    ] }, void 0, true, {
      fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
      lineNumber: 127,
      columnNumber: 7
    }, this),
    summary.warning && /* @__PURE__ */ jsxDEV(InlineAlert, { variant: "info", message: summary.warning }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
      lineNumber: 141,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV(FeedHealthMetrics, { summary: summaryData }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
      lineNumber: 145,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV(
      FeedHealthCharts,
      {
        summary: summaryData,
        dailyMetrics: dailyMetricsData,
        errorBreakdown: errorBreakdownData
      },
      void 0,
      false,
      {
        fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
        lineNumber: 148,
        columnNumber: 7
      },
      this
    ),
    alertsData.length > 0 && /* @__PURE__ */ jsxDEV(
      AlertsList,
      {
        alerts: alertsData,
        onAcknowledge: handleAcknowledgeAlert
      },
      void 0,
      false,
      {
        fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
        lineNumber: 156,
        columnNumber: 7
      },
      this
    ),
    productsData.length > 0 ? /* @__PURE__ */ jsxDEV(
      ProductTable,
      {
        products: productsData,
        onFetchIssues: handleFetchIssues
      },
      void 0,
      false,
      {
        fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
        lineNumber: 164,
        columnNumber: 7
      },
      this
    ) : /* @__PURE__ */ jsxDEV(
      InlineAlert,
      {
        variant: "info",
        message: "No products found. Run a sync to import products from Google Merchant Center."
      },
      void 0,
      false,
      {
        fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
        lineNumber: 169,
        columnNumber: 7
      },
      this
    ),
    summary.source && /* @__PURE__ */ jsxDEV("div", { className: "text-xs text-muted-foreground text-center", children: [
      "Data source: ",
      summary.source,
      summary.refreshedAt && ` â€¢ Last refreshed: ${new Date(summary.refreshedAt).toLocaleString()}`
    ] }, void 0, true, {
      fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
      lineNumber: 177,
      columnNumber: 7
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx",
    lineNumber: 125,
    columnNumber: 5
  }, this);
}
_s(MerchantCenterClient, "282CnacjBvx960Jqmcl4dSEncCE=");
_c = MerchantCenterClient;
var _c;
$RefreshReg$(_c, "MerchantCenterClient");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/Projects/Source 4 Industries/src/pages/data/merchant-center/merchant-center-client.tsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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QUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFFeUY7QUFBQSxJQUsxRlgsUUFBUXdDLFVBQ1AsdUJBQUMsU0FBSSxXQUFVLDZDQUE0QztBQUFBO0FBQUEsTUFDM0N4QyxRQUFRd0M7QUFBQUEsTUFDckJ4QyxRQUFReUMsZUFBZSxzQkFBc0IsSUFBSUMsS0FBSzFDLFFBQVF5QyxXQUFXLEVBQUVFLGVBQWUsQ0FBQztBQUFBLFNBRjlGO0FBQUE7QUFBQTtBQUFBO0FBQUEsV0FHQTtBQUFBLE9BdkRKO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0F5REE7QUFFSjtBQUFDcEMsR0F0SWVSLHNCQUFvQjtBQUFBNkMsS0FBcEI3QztBQUFvQixJQUFBNkM7QUFBQUMsYUFBQUQsSUFBQSIsIm5hbWVzIjpbInVzZVN0YXRlIiwiU2VjdGlvbkhlYWRlciIsIklubGluZUFsZXJ0IiwiU3luY0J1dHRvbiIsIkZlZWRIZWFsdGhNZXRyaWNzIiwiRmVlZEhlYWx0aENoYXJ0cyIsIlByb2R1Y3RUYWJsZSIsIkFsZXJ0c0xpc3QiLCJNZXJjaGFudENlbnRlckNsaWVudCIsInN1bW1hcnkiLCJwcm9kdWN0cyIsImFsZXJ0cyIsImRhaWx5TWV0cmljcyIsImVycm9yQnJlYWtkb3duIiwib25TeW5jIiwic3luY2luZyIsIl9zIiwiYWNrbm93bGVkZ2luZ0FsZXJ0cyIsInNldEFja25vd2xlZGdpbmdBbGVydHMiLCJTZXQiLCJoYW5kbGVGZXRjaElzc3VlcyIsInByb2R1Y3RJZCIsInJlcyIsImZldGNoIiwib2siLCJFcnJvciIsInN0YXR1cyIsImRhdGEiLCJqc29uIiwiZXJyb3IiLCJjb25zb2xlIiwiaGFuZGxlQWNrbm93bGVkZ2VBbGVydCIsImFsZXJ0SWQiLCJwcmV2IiwiYWRkIiwibWV0aG9kIiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJuZXh0IiwiZGVsZXRlIiwic3VtbWFyeURhdGEiLCJwcm9kdWN0c0RhdGEiLCJhbGVydHNEYXRhIiwiZGFpbHlNZXRyaWNzRGF0YSIsImVycm9yQnJlYWtkb3duRGF0YSIsImxhc3RTeW5jZWRBdCIsIndhcm5pbmciLCJsZW5ndGgiLCJzb3VyY2UiLCJyZWZyZXNoZWRBdCIsIkRhdGUiLCJ0b0xvY2FsZVN0cmluZyIsIl9jIiwiJFJlZnJlc2hSZWckIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbIm1lcmNoYW50LWNlbnRlci1jbGllbnQudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCB7IFNlY3Rpb25IZWFkZXIgfSBmcm9tIFwiQC9jb21wb25lbnRzL3NlY3Rpb24taGVhZGVyXCI7XHJcbmltcG9ydCB7IElubGluZUFsZXJ0IH0gZnJvbSBcIkAvY29tcG9uZW50cy91aS9pbmxpbmUtYWxlcnRcIjtcclxuaW1wb3J0IHtcclxuICBNZXJjaGFudENlbnRlclN1bW1hcnksXHJcbiAgTWVyY2hhbnRDZW50ZXJQcm9kdWN0LFxyXG4gIE1lcmNoYW50Q2VudGVyQWxlcnQsXHJcbiAgTWVyY2hhbnRDZW50ZXJEYWlseU1ldHJpY3MsXHJcbiAgTWVyY2hhbnRDZW50ZXJJc3N1ZSxcclxuICBFcnJvckJyZWFrZG93bixcclxufSBmcm9tIFwiQC9saWIvZGF0YS9tZXJjaGFudC1jZW50ZXJcIjtcclxuXHJcbmltcG9ydCB7IFN5bmNCdXR0b24gfSBmcm9tIFwiLi9zeW5jLWJ1dHRvblwiO1xyXG5pbXBvcnQgeyBGZWVkSGVhbHRoTWV0cmljcyB9IGZyb20gXCIuL2ZlZWQtaGVhbHRoLW1ldHJpY3NcIjtcclxuaW1wb3J0IHsgRmVlZEhlYWx0aENoYXJ0cyB9IGZyb20gXCIuL2ZlZWQtaGVhbHRoLWNoYXJ0c1wiO1xyXG5pbXBvcnQgeyBQcm9kdWN0VGFibGUgfSBmcm9tIFwiLi9wcm9kdWN0LXRhYmxlXCI7XHJcbmltcG9ydCB7IEFsZXJ0c0xpc3QgfSBmcm9tIFwiLi9hbGVydHMtbGlzdFwiO1xyXG5cclxudHlwZSBBcGlSZXNwb25zZTxUPiA9IHsgZGF0YT86IFQ7IGVycm9yPzogc3RyaW5nOyB3YXJuaW5nPzogc3RyaW5nOyBzb3VyY2U/OiBzdHJpbmc7IHJlZnJlc2hlZEF0Pzogc3RyaW5nIH07XHJcblxyXG50eXBlIE1lcmNoYW50Q2VudGVyQ2xpZW50UHJvcHMgPSB7XHJcbiAgc3VtbWFyeTogQXBpUmVzcG9uc2U8TWVyY2hhbnRDZW50ZXJTdW1tYXJ5PjtcclxuICBwcm9kdWN0czogQXBpUmVzcG9uc2U8TWVyY2hhbnRDZW50ZXJQcm9kdWN0W10+O1xyXG4gIGFsZXJ0czogQXBpUmVzcG9uc2U8TWVyY2hhbnRDZW50ZXJBbGVydFtdPjtcclxuICBkYWlseU1ldHJpY3M6IEFwaVJlc3BvbnNlPE1lcmNoYW50Q2VudGVyRGFpbHlNZXRyaWNzW10+O1xyXG4gIGVycm9yQnJlYWtkb3duOiBBcGlSZXNwb25zZTxFcnJvckJyZWFrZG93bltdPjtcclxuICBvblN5bmM6ICgpID0+IHZvaWQ7XHJcbiAgc3luY2luZzogYm9vbGVhbjtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBNZXJjaGFudENlbnRlckNsaWVudCh7XHJcbiAgc3VtbWFyeSxcclxuICBwcm9kdWN0cyxcclxuICBhbGVydHMsXHJcbiAgZGFpbHlNZXRyaWNzLFxyXG4gIGVycm9yQnJlYWtkb3duLFxyXG4gIG9uU3luYyxcclxuICBzeW5jaW5nLFxyXG59OiBNZXJjaGFudENlbnRlckNsaWVudFByb3BzKSB7XHJcbiAgY29uc3QgW2Fja25vd2xlZGdpbmdBbGVydHMsIHNldEFja25vd2xlZGdpbmdBbGVydHNdID0gdXNlU3RhdGU8U2V0PHN0cmluZz4+KG5ldyBTZXQoKSk7XHJcblxyXG4gIC8vIEhhbmRsZSBmZXRjaGluZyBpc3N1ZXMgZm9yIGEgc3BlY2lmaWMgcHJvZHVjdFxyXG4gIGNvbnN0IGhhbmRsZUZldGNoSXNzdWVzID0gYXN5bmMgKHByb2R1Y3RJZDogc3RyaW5nKTogUHJvbWlzZTxNZXJjaGFudENlbnRlcklzc3VlW10+ID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGAvYXBpL2RhdGEvbWVyY2hhbnQtY2VudGVyL3Byb2R1Y3RzLyR7cHJvZHVjdElkfS9pc3N1ZXNgKTtcclxuICAgICAgaWYgKCFyZXMub2spIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBpc3N1ZXM6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzLmpzb24oKTtcclxuICAgICAgcmV0dXJuIGRhdGEuZGF0YT8uZGF0YSB8fCBbXTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBwcm9kdWN0IGlzc3VlczpcIiwgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gSGFuZGxlIGFja25vd2xlZGdpbmcgYW4gYWxlcnRcclxuICBjb25zdCBoYW5kbGVBY2tub3dsZWRnZUFsZXJ0ID0gYXN5bmMgKGFsZXJ0SWQ6IHN0cmluZykgPT4ge1xyXG4gICAgc2V0QWNrbm93bGVkZ2luZ0FsZXJ0cyhwcmV2ID0+IG5ldyBTZXQocHJldikuYWRkKGFsZXJ0SWQpKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgL2FwaS9kYXRhL21lcmNoYW50LWNlbnRlci9hbGVydHMvJHthbGVydElkfS9hY2tub3dsZWRnZWAsIHtcclxuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAvLyBSZWZyZXNoIHRoZSBwYWdlIHRvIHVwZGF0ZSBhbGVydCBzdGF0dXNcclxuICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBhY2tub3dsZWRnZSBhbGVydFwiKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGFja25vd2xlZGdpbmcgYWxlcnQ6XCIsIGVycm9yKTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHNldEFja25vd2xlZGdpbmdBbGVydHMocHJldiA9PiB7XHJcbiAgICAgICAgY29uc3QgbmV4dCA9IG5ldyBTZXQocHJldik7XHJcbiAgICAgICAgbmV4dC5kZWxldGUoYWxlcnRJZCk7XHJcbiAgICAgICAgcmV0dXJuIG5leHQ7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vIFNob3cgZXJyb3IgaWYgY3JpdGljYWwgZGF0YSBpcyBtaXNzaW5nXHJcbiAgaWYgKHN1bW1hcnkuZXJyb3IgfHwgIXN1bW1hcnkuZGF0YSkge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LThcIj5cclxuICAgICAgICA8U2VjdGlvbkhlYWRlclxyXG4gICAgICAgICAgdGl0bGU9XCJNZXJjaGFudCBDZW50ZXJcIlxyXG4gICAgICAgICAgZGVzY3JpcHRpb249XCJNb25pdG9yIEdvb2dsZSBNZXJjaGFudCBDZW50ZXIgcHJvZHVjdCBmZWVkIHN0YXR1cyBhbmQgaGVhbHRoXCJcclxuICAgICAgICAvPlxyXG4gICAgICAgIDxJbmxpbmVBbGVydFxyXG4gICAgICAgICAgdmFyaWFudD1cIndhcm5pbmdcIlxyXG4gICAgICAgICAgbWVzc2FnZT17c3VtbWFyeS5lcnJvciB8fCBcIkZhaWxlZCB0byBsb2FkIG1lcmNoYW50IGNlbnRlciBzdW1tYXJ5XCJ9XHJcbiAgICAgICAgLz5cclxuICAgICAgPC9kaXY+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgc3VtbWFyeURhdGEgPSBzdW1tYXJ5LmRhdGE7XHJcbiAgY29uc3QgcHJvZHVjdHNEYXRhID0gcHJvZHVjdHMuZGF0YSB8fCBbXTtcclxuICBjb25zdCBhbGVydHNEYXRhID0gYWxlcnRzLmRhdGEgfHwgW107XHJcbiAgY29uc3QgZGFpbHlNZXRyaWNzRGF0YSA9IGRhaWx5TWV0cmljcy5kYXRhIHx8IFtdO1xyXG4gIGNvbnN0IGVycm9yQnJlYWtkb3duRGF0YSA9IGVycm9yQnJlYWtkb3duLmRhdGEgfHwgW107XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC1jb2wgZ2FwLTggcC02XCI+XHJcbiAgICAgIHsvKiBIZWFkZXIgd2l0aCBTeW5jIEJ1dHRvbiAqL31cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtY29sIHNtOmZsZXgtcm93IHNtOml0ZW1zLWNlbnRlciBzbTpqdXN0aWZ5LWJldHdlZW4gZ2FwLTRcIj5cclxuICAgICAgICA8U2VjdGlvbkhlYWRlclxyXG4gICAgICAgICAgdGl0bGU9XCJNZXJjaGFudCBDZW50ZXJcIlxyXG4gICAgICAgICAgZGVzY3JpcHRpb249XCJNb25pdG9yIEdvb2dsZSBNZXJjaGFudCBDZW50ZXIgcHJvZHVjdCBmZWVkIHN0YXR1cyBhbmQgaGVhbHRoXCJcclxuICAgICAgICAvPlxyXG4gICAgICAgIDxTeW5jQnV0dG9uXHJcbiAgICAgICAgICBvblN5bmM9e29uU3luY31cclxuICAgICAgICAgIHN5bmNpbmc9e3N5bmNpbmd9XHJcbiAgICAgICAgICBsYXN0U3luY2VkQXQ9e3N1bW1hcnlEYXRhLmxhc3RTeW5jZWRBdH1cclxuICAgICAgICAvPlxyXG4gICAgICA8L2Rpdj5cclxuXHJcbiAgICAgIHsvKiBTaG93IHdhcm5pbmdzIGlmIGFueSAqL31cclxuICAgICAge3N1bW1hcnkud2FybmluZyAmJiAoXHJcbiAgICAgICAgPElubGluZUFsZXJ0IHZhcmlhbnQ9XCJpbmZvXCIgbWVzc2FnZT17c3VtbWFyeS53YXJuaW5nfSAvPlxyXG4gICAgICApfVxyXG5cclxuICAgICAgey8qIEtleSBNZXRyaWNzICovfVxyXG4gICAgICA8RmVlZEhlYWx0aE1ldHJpY3Mgc3VtbWFyeT17c3VtbWFyeURhdGF9IC8+XHJcblxyXG4gICAgICB7LyogRmVlZCBIZWFsdGggQ2hhcnRzICovfVxyXG4gICAgICA8RmVlZEhlYWx0aENoYXJ0c1xyXG4gICAgICAgIHN1bW1hcnk9e3N1bW1hcnlEYXRhfVxyXG4gICAgICAgIGRhaWx5TWV0cmljcz17ZGFpbHlNZXRyaWNzRGF0YX1cclxuICAgICAgICBlcnJvckJyZWFrZG93bj17ZXJyb3JCcmVha2Rvd25EYXRhfVxyXG4gICAgICAvPlxyXG5cclxuICAgICAgey8qIEFsZXJ0cyBTZWN0aW9uICovfVxyXG4gICAgICB7YWxlcnRzRGF0YS5sZW5ndGggPiAwICYmIChcclxuICAgICAgICA8QWxlcnRzTGlzdFxyXG4gICAgICAgICAgYWxlcnRzPXthbGVydHNEYXRhfVxyXG4gICAgICAgICAgb25BY2tub3dsZWRnZT17aGFuZGxlQWNrbm93bGVkZ2VBbGVydH1cclxuICAgICAgICAvPlxyXG4gICAgICApfVxyXG5cclxuICAgICAgey8qIFByb2R1Y3QgTGlzdCB3aXRoIElzc3VlcyAqL31cclxuICAgICAge3Byb2R1Y3RzRGF0YS5sZW5ndGggPiAwID8gKFxyXG4gICAgICAgIDxQcm9kdWN0VGFibGVcclxuICAgICAgICAgIHByb2R1Y3RzPXtwcm9kdWN0c0RhdGF9XHJcbiAgICAgICAgICBvbkZldGNoSXNzdWVzPXtoYW5kbGVGZXRjaElzc3Vlc31cclxuICAgICAgICAvPlxyXG4gICAgICApIDogKFxyXG4gICAgICAgIDxJbmxpbmVBbGVydFxyXG4gICAgICAgICAgdmFyaWFudD1cImluZm9cIlxyXG4gICAgICAgICAgbWVzc2FnZT1cIk5vIHByb2R1Y3RzIGZvdW5kLiBSdW4gYSBzeW5jIHRvIGltcG9ydCBwcm9kdWN0cyBmcm9tIEdvb2dsZSBNZXJjaGFudCBDZW50ZXIuXCJcclxuICAgICAgICAvPlxyXG4gICAgICApfVxyXG5cclxuICAgICAgey8qIERhdGEgU291cmNlIEluZm8gKi99XHJcbiAgICAgIHtzdW1tYXJ5LnNvdXJjZSAmJiAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCB0ZXh0LWNlbnRlclwiPlxyXG4gICAgICAgICAgRGF0YSBzb3VyY2U6IHtzdW1tYXJ5LnNvdXJjZX1cclxuICAgICAgICAgIHtzdW1tYXJ5LnJlZnJlc2hlZEF0ICYmIGAg4oCiIExhc3QgcmVmcmVzaGVkOiAke25ldyBEYXRlKHN1bW1hcnkucmVmcmVzaGVkQXQpLnRvTG9jYWxlU3RyaW5nKCl9YH1cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgKX1cclxuICAgIDwvZGl2PlxyXG4gICk7XHJcbn1cclxuIl0sImZpbGUiOiJDOi9Qcm9qZWN0cy9Tb3VyY2UgNCBJbmR1c3RyaWVzL3NyYy9wYWdlcy9kYXRhL21lcmNoYW50LWNlbnRlci9tZXJjaGFudC1jZW50ZXItY2xpZW50LnRzeCJ9