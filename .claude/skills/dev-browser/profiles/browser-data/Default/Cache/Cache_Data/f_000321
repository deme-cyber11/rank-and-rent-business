import { supabase } from "/src/lib/supabase.ts";
export class SubmissionAnalyticsTracker {
  analytics;
  startTime;
  stepStartTimes = {};
  constructor() {
    this.sessionId = crypto.randomUUID();
    this.startTime = performance.now();
    this.analytics = {
      sessionId: this.sessionId,
      success: false,
      totalDocuments: 0,
      applicationDocuments: 0,
      bankStatementDocuments: 0,
      otherDocuments: 0,
      totalDocumentSizeBytes: 0,
      apiModelsUsed: [],
      stepsCompleted: {}
    };
    this.captureClientInfo();
  }
  sessionId;
  captureClientInfo() {
    try {
      const ua = navigator.userAgent;
      const connection = navigator.connection;
      this.analytics.clientInfo = {
        browser: this.getBrowser(ua),
        os: this.getOS(ua),
        screenSize: `${window.screen.width}x${window.screen.height}`,
        connectionType: connection?.effectiveType || "unknown"
      };
    } catch {
    }
  }
  getBrowser(ua) {
    if (ua.includes("Chrome")) return "Chrome";
    if (ua.includes("Firefox")) return "Firefox";
    if (ua.includes("Safari")) return "Safari";
    if (ua.includes("Edge")) return "Edge";
    return "Other";
  }
  getOS(ua) {
    if (ua.includes("Windows")) return "Windows";
    if (ua.includes("Mac")) return "macOS";
    if (ua.includes("Linux")) return "Linux";
    if (ua.includes("iPhone") || ua.includes("iPad")) return "iOS";
    if (ua.includes("Android")) return "Android";
    return "Other";
  }
  setUserId(userId) {
    this.analytics.userId = userId;
  }
  setDealId(dealId) {
    this.analytics.dealId = dealId;
  }
  setDocumentMetrics(files) {
    this.analytics.totalDocuments = files.length;
    this.analytics.totalDocumentSizeBytes = files.reduce((sum, f) => sum + f.size, 0);
    files.forEach((file) => {
      const name = file.name.toLowerCase();
      if (name.includes("application") || name.includes("app")) {
        this.analytics.applicationDocuments++;
      } else if (name.includes("statement") || name.includes("bank")) {
        this.analytics.bankStatementDocuments++;
      } else {
        this.analytics.otherDocuments++;
      }
    });
  }
  startStep(stepName) {
    this.stepStartTimes[stepName] = performance.now();
  }
  endStep(stepName, success = true) {
    const startTime = this.stepStartTimes[stepName];
    if (!startTime) return 0;
    const duration = Math.round(performance.now() - startTime);
    this.analytics.stepsCompleted[stepName] = success;
    switch (stepName) {
      case "step1_drive_upload":
        this.analytics.step1DriveUploadMs = duration;
        break;
      case "step2_parse_application":
        this.analytics.step2ParseApplicationMs = duration;
        break;
      case "step3_parse_statements":
        this.analytics.step3ParseStatementsMs = duration;
        break;
      case "step4_create_deal":
        this.analytics.step4CreateDealMs = duration;
        break;
      case "step5_match_lenders":
        this.analytics.step5MatchLendersMs = duration;
        break;
      case "step6_submit":
        this.analytics.step6SubmitMs = duration;
        break;
    }
    if (!success) {
      this.analytics.failedStep = stepName;
    }
    return duration;
  }
  trackApiCall(model, step, durationMs, tokensIn, tokensOut) {
    this.analytics.apiModelsUsed.push({
      model,
      step,
      durationMs,
      tokensIn,
      tokensOut
    });
  }
  setBusinessMetrics(businessName, loanType, loanAmount, lendersMatched) {
    this.analytics.businessName = businessName;
    this.analytics.loanType = loanType;
    this.analytics.loanAmount = loanAmount;
    this.analytics.lendersMatched = lendersMatched;
  }
  setSuccess(success, errorMessage) {
    this.analytics.success = success;
    this.analytics.errorMessage = errorMessage;
    this.analytics.totalDurationMs = Math.round(performance.now() - this.startTime);
  }
  getSessionId() {
    return this.sessionId;
  }
  getAnalytics() {
    return { ...this.analytics };
  }
  getTotalDuration() {
    return Math.round(performance.now() - this.startTime);
  }
  /**
   * Get the duration of a completed step
   */
  getStepDuration(stepName) {
    switch (stepName) {
      case "step1_drive_upload":
        return this.analytics.step1DriveUploadMs || 0;
      case "step2_parse_application":
        return this.analytics.step2ParseApplicationMs || 0;
      case "step3_parse_statements":
        return this.analytics.step3ParseStatementsMs || 0;
      case "step4_create_deal":
        return this.analytics.step4CreateDealMs || 0;
      case "step5_match_lenders":
        return this.analytics.step5MatchLendersMs || 0;
      case "step6_submit":
        return this.analytics.step6SubmitMs || 0;
      default:
        return 0;
    }
  }
  /**
   * Save analytics to database
   */
  async save() {
    try {
      if (!this.analytics.totalDurationMs) {
        this.analytics.totalDurationMs = this.getTotalDuration();
      }
      const { error } = await supabase.from("deal_submission_analytics").insert({
        session_id: this.analytics.sessionId,
        deal_id: this.analytics.dealId,
        user_id: this.analytics.userId,
        total_duration_ms: this.analytics.totalDurationMs,
        success: this.analytics.success,
        error_message: this.analytics.errorMessage,
        total_documents: this.analytics.totalDocuments,
        application_documents: this.analytics.applicationDocuments,
        bank_statement_documents: this.analytics.bankStatementDocuments,
        other_documents: this.analytics.otherDocuments,
        total_document_size_bytes: this.analytics.totalDocumentSizeBytes,
        step1_drive_upload_ms: this.analytics.step1DriveUploadMs,
        step2_parse_application_ms: this.analytics.step2ParseApplicationMs,
        step3_parse_statements_ms: this.analytics.step3ParseStatementsMs,
        step4_create_deal_ms: this.analytics.step4CreateDealMs,
        step5_match_lenders_ms: this.analytics.step5MatchLendersMs,
        step6_submit_ms: this.analytics.step6SubmitMs,
        api_models_used: this.analytics.apiModelsUsed,
        steps_completed: this.analytics.stepsCompleted,
        failed_step: this.analytics.failedStep,
        client_info: this.analytics.clientInfo,
        business_name: this.analytics.businessName,
        loan_type: this.analytics.loanType,
        loan_amount: this.analytics.loanAmount,
        lenders_matched: this.analytics.lendersMatched
      });
      if (error) {
        console.error("Failed to save submission analytics:", error);
        return false;
      }
      console.log("[Analytics] Saved submission analytics:", {
        sessionId: this.sessionId,
        totalDurationMs: this.analytics.totalDurationMs,
        success: this.analytics.success
      });
      return true;
    } catch (err) {
      console.error("Failed to save submission analytics:", err);
      return false;
    }
  }
}
export async function getSubmissionAnalytics(days = 30) {
  const startDate = /* @__PURE__ */ new Date();
  startDate.setDate(startDate.getDate() - days);
  const { data, error } = await supabase.from("deal_submission_analytics").select("*").gte("created_at", startDate.toISOString()).order("created_at", { ascending: false });
  if (error || !data) {
    console.error("Failed to fetch submission analytics:", error);
    return {
      totalSubmissions: 0,
      successRate: 0,
      avgDurationMs: 0,
      avgDocuments: 0,
      stepPerformance: {},
      dailyStats: []
    };
  }
  const totalSubmissions = data.length;
  const successfulSubmissions = data.filter((d) => d.success).length;
  const successRate = totalSubmissions > 0 ? successfulSubmissions / totalSubmissions * 100 : 0;
  const avgDurationMs = totalSubmissions > 0 ? data.reduce((sum, d) => sum + (d.total_duration_ms || 0), 0) / totalSubmissions : 0;
  const avgDocuments = totalSubmissions > 0 ? data.reduce((sum, d) => sum + (d.total_documents || 0), 0) / totalSubmissions : 0;
  const stepPerformance = {};
  const stepFields = [
    "step1_drive_upload_ms",
    "step2_parse_application_ms",
    "step3_parse_statements_ms",
    "step4_create_deal_ms",
    "step5_match_lenders_ms",
    "step6_submit_ms"
  ];
  stepFields.forEach((field) => {
    const values = data.map((d) => d[field]).filter((v) => v !== null && v !== void 0);
    if (values.length > 0) {
      stepPerformance[field] = values.reduce((sum, v) => sum + v, 0) / values.length;
    }
  });
  const dailyMap = /* @__PURE__ */ new Map();
  data.forEach((d) => {
    const date = new Date(d.created_at).toISOString().split("T")[0];
    const existing = dailyMap.get(date) || { count: 0, success: 0, duration: 0 };
    existing.count++;
    if (d.success) existing.success++;
    existing.duration += d.total_duration_ms || 0;
    dailyMap.set(date, existing);
  });
  const dailyStats = Array.from(dailyMap.entries()).map(([date, stats]) => ({
    date,
    count: stats.count,
    successRate: stats.success / stats.count * 100,
    avgDuration: stats.duration / stats.count
  }));
  return {
    totalSubmissions,
    successRate,
    avgDurationMs,
    avgDocuments,
    stepPerformance,
    dailyStats
  };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN1Ym1pc3Npb25BbmFseXRpY3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIERlYWwgU3VibWlzc2lvbiBBbmFseXRpY3MgU2VydmljZVxyXG4gKiBUcmFja3MgZGV0YWlsZWQgcGVyZm9ybWFuY2UgbWV0cmljcyBmb3IgZGVhbCBzdWJtaXNzaW9uIHBpcGVsaW5lXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tICcuLi9saWIvc3VwYWJhc2UnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTdWJtaXNzaW9uQW5hbHl0aWNzIHtcclxuICBzZXNzaW9uSWQ6IHN0cmluZztcclxuICBkZWFsSWQ/OiBzdHJpbmc7XHJcbiAgdXNlcklkPzogc3RyaW5nO1xyXG5cclxuICAvLyBPdmVyYWxsIG1ldHJpY3NcclxuICB0b3RhbER1cmF0aW9uTXM/OiBudW1iZXI7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBlcnJvck1lc3NhZ2U/OiBzdHJpbmc7XHJcblxyXG4gIC8vIERvY3VtZW50IG1ldHJpY3NcclxuICB0b3RhbERvY3VtZW50czogbnVtYmVyO1xyXG4gIGFwcGxpY2F0aW9uRG9jdW1lbnRzOiBudW1iZXI7XHJcbiAgYmFua1N0YXRlbWVudERvY3VtZW50czogbnVtYmVyO1xyXG4gIG90aGVyRG9jdW1lbnRzOiBudW1iZXI7XHJcbiAgdG90YWxEb2N1bWVudFNpemVCeXRlczogbnVtYmVyO1xyXG5cclxuICAvLyBTdGVwIHRpbWluZ3MgKG1pbGxpc2Vjb25kcylcclxuICBzdGVwMURyaXZlVXBsb2FkTXM/OiBudW1iZXI7XHJcbiAgc3RlcDJQYXJzZUFwcGxpY2F0aW9uTXM/OiBudW1iZXI7XHJcbiAgc3RlcDNQYXJzZVN0YXRlbWVudHNNcz86IG51bWJlcjtcclxuICBzdGVwNENyZWF0ZURlYWxNcz86IG51bWJlcjtcclxuICBzdGVwNU1hdGNoTGVuZGVyc01zPzogbnVtYmVyO1xyXG4gIHN0ZXA2U3VibWl0TXM/OiBudW1iZXI7XHJcblxyXG4gIC8vIEFQSSB1c2FnZVxyXG4gIGFwaU1vZGVsc1VzZWQ6IEFycmF5PHtcclxuICAgIG1vZGVsOiBzdHJpbmc7XHJcbiAgICBzdGVwOiBzdHJpbmc7XHJcbiAgICBkdXJhdGlvbk1zOiBudW1iZXI7XHJcbiAgICB0b2tlbnNJbj86IG51bWJlcjtcclxuICAgIHRva2Vuc091dD86IG51bWJlcjtcclxuICB9PjtcclxuXHJcbiAgLy8gU3RlcCBjb21wbGV0aW9uIHRyYWNraW5nXHJcbiAgc3RlcHNDb21wbGV0ZWQ6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+O1xyXG4gIGZhaWxlZFN0ZXA/OiBzdHJpbmc7XHJcblxyXG4gIC8vIEJ1c2luZXNzIG1ldHJpY3NcclxuICBidXNpbmVzc05hbWU/OiBzdHJpbmc7XHJcbiAgbG9hblR5cGU/OiBzdHJpbmc7XHJcbiAgbG9hbkFtb3VudD86IG51bWJlcjtcclxuICBsZW5kZXJzTWF0Y2hlZD86IG51bWJlcjtcclxuXHJcbiAgLy8gQ2xpZW50IGluZm9cclxuICBjbGllbnRJbmZvPzoge1xyXG4gICAgYnJvd3Nlcj86IHN0cmluZztcclxuICAgIG9zPzogc3RyaW5nO1xyXG4gICAgc2NyZWVuU2l6ZT86IHN0cmluZztcclxuICAgIGNvbm5lY3Rpb25UeXBlPzogc3RyaW5nO1xyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTdWJtaXNzaW9uQW5hbHl0aWNzVHJhY2tlciB7XHJcbiAgcHJpdmF0ZSBhbmFseXRpY3M6IFN1Ym1pc3Npb25BbmFseXRpY3M7XHJcbiAgcHJpdmF0ZSBzdGFydFRpbWU6IG51bWJlcjtcclxuICBwcml2YXRlIHN0ZXBTdGFydFRpbWVzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5zZXNzaW9uSWQgPSBjcnlwdG8ucmFuZG9tVVVJRCgpO1xyXG4gICAgdGhpcy5zdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxuICAgIHRoaXMuYW5hbHl0aWNzID0ge1xyXG4gICAgICBzZXNzaW9uSWQ6IHRoaXMuc2Vzc2lvbklkLFxyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgdG90YWxEb2N1bWVudHM6IDAsXHJcbiAgICAgIGFwcGxpY2F0aW9uRG9jdW1lbnRzOiAwLFxyXG4gICAgICBiYW5rU3RhdGVtZW50RG9jdW1lbnRzOiAwLFxyXG4gICAgICBvdGhlckRvY3VtZW50czogMCxcclxuICAgICAgdG90YWxEb2N1bWVudFNpemVCeXRlczogMCxcclxuICAgICAgYXBpTW9kZWxzVXNlZDogW10sXHJcbiAgICAgIHN0ZXBzQ29tcGxldGVkOiB7fSxcclxuICAgIH07XHJcblxyXG4gICAgLy8gQ2FwdHVyZSBjbGllbnQgaW5mb1xyXG4gICAgdGhpcy5jYXB0dXJlQ2xpZW50SW5mbygpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzZXNzaW9uSWQ6IHN0cmluZztcclxuXHJcbiAgcHJpdmF0ZSBjYXB0dXJlQ2xpZW50SW5mbygpOiB2b2lkIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcclxuICAgICAgY29uc3QgY29ubmVjdGlvbiA9IChuYXZpZ2F0b3IgYXMgYW55KS5jb25uZWN0aW9uO1xyXG5cclxuICAgICAgdGhpcy5hbmFseXRpY3MuY2xpZW50SW5mbyA9IHtcclxuICAgICAgICBicm93c2VyOiB0aGlzLmdldEJyb3dzZXIodWEpLFxyXG4gICAgICAgIG9zOiB0aGlzLmdldE9TKHVhKSxcclxuICAgICAgICBzY3JlZW5TaXplOiBgJHt3aW5kb3cuc2NyZWVuLndpZHRofXgke3dpbmRvdy5zY3JlZW4uaGVpZ2h0fWAsXHJcbiAgICAgICAgY29ubmVjdGlvblR5cGU6IGNvbm5lY3Rpb24/LmVmZmVjdGl2ZVR5cGUgfHwgJ3Vua25vd24nLFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIC8vIElnbm9yZSBlcnJvcnMgaW4gbm9uLWJyb3dzZXIgZW52aXJvbm1lbnRzXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEJyb3dzZXIodWE6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBpZiAodWEuaW5jbHVkZXMoJ0Nocm9tZScpKSByZXR1cm4gJ0Nocm9tZSc7XHJcbiAgICBpZiAodWEuaW5jbHVkZXMoJ0ZpcmVmb3gnKSkgcmV0dXJuICdGaXJlZm94JztcclxuICAgIGlmICh1YS5pbmNsdWRlcygnU2FmYXJpJykpIHJldHVybiAnU2FmYXJpJztcclxuICAgIGlmICh1YS5pbmNsdWRlcygnRWRnZScpKSByZXR1cm4gJ0VkZ2UnO1xyXG4gICAgcmV0dXJuICdPdGhlcic7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldE9TKHVhOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgaWYgKHVhLmluY2x1ZGVzKCdXaW5kb3dzJykpIHJldHVybiAnV2luZG93cyc7XHJcbiAgICBpZiAodWEuaW5jbHVkZXMoJ01hYycpKSByZXR1cm4gJ21hY09TJztcclxuICAgIGlmICh1YS5pbmNsdWRlcygnTGludXgnKSkgcmV0dXJuICdMaW51eCc7XHJcbiAgICBpZiAodWEuaW5jbHVkZXMoJ2lQaG9uZScpIHx8IHVhLmluY2x1ZGVzKCdpUGFkJykpIHJldHVybiAnaU9TJztcclxuICAgIGlmICh1YS5pbmNsdWRlcygnQW5kcm9pZCcpKSByZXR1cm4gJ0FuZHJvaWQnO1xyXG4gICAgcmV0dXJuICdPdGhlcic7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySWQodXNlcklkOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMuYW5hbHl0aWNzLnVzZXJJZCA9IHVzZXJJZDtcclxuICB9XHJcblxyXG4gIHNldERlYWxJZChkZWFsSWQ6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgdGhpcy5hbmFseXRpY3MuZGVhbElkID0gZGVhbElkO1xyXG4gIH1cclxuXHJcbiAgc2V0RG9jdW1lbnRNZXRyaWNzKGZpbGVzOiBGaWxlW10pOiB2b2lkIHtcclxuICAgIHRoaXMuYW5hbHl0aWNzLnRvdGFsRG9jdW1lbnRzID0gZmlsZXMubGVuZ3RoO1xyXG4gICAgdGhpcy5hbmFseXRpY3MudG90YWxEb2N1bWVudFNpemVCeXRlcyA9IGZpbGVzLnJlZHVjZSgoc3VtLCBmKSA9PiBzdW0gKyBmLnNpemUsIDApO1xyXG5cclxuICAgIGZpbGVzLmZvckVhY2goZmlsZSA9PiB7XHJcbiAgICAgIGNvbnN0IG5hbWUgPSBmaWxlLm5hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgaWYgKG5hbWUuaW5jbHVkZXMoJ2FwcGxpY2F0aW9uJykgfHwgbmFtZS5pbmNsdWRlcygnYXBwJykpIHtcclxuICAgICAgICB0aGlzLmFuYWx5dGljcy5hcHBsaWNhdGlvbkRvY3VtZW50cysrO1xyXG4gICAgICB9IGVsc2UgaWYgKG5hbWUuaW5jbHVkZXMoJ3N0YXRlbWVudCcpIHx8IG5hbWUuaW5jbHVkZXMoJ2JhbmsnKSkge1xyXG4gICAgICAgIHRoaXMuYW5hbHl0aWNzLmJhbmtTdGF0ZW1lbnREb2N1bWVudHMrKztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmFuYWx5dGljcy5vdGhlckRvY3VtZW50cysrO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHN0YXJ0U3RlcChzdGVwTmFtZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICB0aGlzLnN0ZXBTdGFydFRpbWVzW3N0ZXBOYW1lXSA9IHBlcmZvcm1hbmNlLm5vdygpO1xyXG4gIH1cclxuXHJcbiAgZW5kU3RlcChzdGVwTmFtZTogc3RyaW5nLCBzdWNjZXNzOiBib29sZWFuID0gdHJ1ZSk6IG51bWJlciB7XHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSB0aGlzLnN0ZXBTdGFydFRpbWVzW3N0ZXBOYW1lXTtcclxuICAgIGlmICghc3RhcnRUaW1lKSByZXR1cm4gMDtcclxuXHJcbiAgICBjb25zdCBkdXJhdGlvbiA9IE1hdGgucm91bmQocGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWUpO1xyXG4gICAgdGhpcy5hbmFseXRpY3Muc3RlcHNDb21wbGV0ZWRbc3RlcE5hbWVdID0gc3VjY2VzcztcclxuXHJcbiAgICAvLyBNYXAgc3RlcCBuYW1lcyB0byBhbmFseXRpY3MgZmllbGRzXHJcbiAgICBzd2l0Y2ggKHN0ZXBOYW1lKSB7XHJcbiAgICAgIGNhc2UgJ3N0ZXAxX2RyaXZlX3VwbG9hZCc6XHJcbiAgICAgICAgdGhpcy5hbmFseXRpY3Muc3RlcDFEcml2ZVVwbG9hZE1zID0gZHVyYXRpb247XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3N0ZXAyX3BhcnNlX2FwcGxpY2F0aW9uJzpcclxuICAgICAgICB0aGlzLmFuYWx5dGljcy5zdGVwMlBhcnNlQXBwbGljYXRpb25NcyA9IGR1cmF0aW9uO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdzdGVwM19wYXJzZV9zdGF0ZW1lbnRzJzpcclxuICAgICAgICB0aGlzLmFuYWx5dGljcy5zdGVwM1BhcnNlU3RhdGVtZW50c01zID0gZHVyYXRpb247XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3N0ZXA0X2NyZWF0ZV9kZWFsJzpcclxuICAgICAgICB0aGlzLmFuYWx5dGljcy5zdGVwNENyZWF0ZURlYWxNcyA9IGR1cmF0aW9uO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdzdGVwNV9tYXRjaF9sZW5kZXJzJzpcclxuICAgICAgICB0aGlzLmFuYWx5dGljcy5zdGVwNU1hdGNoTGVuZGVyc01zID0gZHVyYXRpb247XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3N0ZXA2X3N1Ym1pdCc6XHJcbiAgICAgICAgdGhpcy5hbmFseXRpY3Muc3RlcDZTdWJtaXRNcyA9IGR1cmF0aW9uO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghc3VjY2Vzcykge1xyXG4gICAgICB0aGlzLmFuYWx5dGljcy5mYWlsZWRTdGVwID0gc3RlcE5hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGR1cmF0aW9uO1xyXG4gIH1cclxuXHJcbiAgdHJhY2tBcGlDYWxsKG1vZGVsOiBzdHJpbmcsIHN0ZXA6IHN0cmluZywgZHVyYXRpb25NczogbnVtYmVyLCB0b2tlbnNJbj86IG51bWJlciwgdG9rZW5zT3V0PzogbnVtYmVyKTogdm9pZCB7XHJcbiAgICB0aGlzLmFuYWx5dGljcy5hcGlNb2RlbHNVc2VkLnB1c2goe1xyXG4gICAgICBtb2RlbCxcclxuICAgICAgc3RlcCxcclxuICAgICAgZHVyYXRpb25NcyxcclxuICAgICAgdG9rZW5zSW4sXHJcbiAgICAgIHRva2Vuc091dCxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0QnVzaW5lc3NNZXRyaWNzKGJ1c2luZXNzTmFtZT86IHN0cmluZywgbG9hblR5cGU/OiBzdHJpbmcsIGxvYW5BbW91bnQ/OiBudW1iZXIsIGxlbmRlcnNNYXRjaGVkPzogbnVtYmVyKTogdm9pZCB7XHJcbiAgICB0aGlzLmFuYWx5dGljcy5idXNpbmVzc05hbWUgPSBidXNpbmVzc05hbWU7XHJcbiAgICB0aGlzLmFuYWx5dGljcy5sb2FuVHlwZSA9IGxvYW5UeXBlO1xyXG4gICAgdGhpcy5hbmFseXRpY3MubG9hbkFtb3VudCA9IGxvYW5BbW91bnQ7XHJcbiAgICB0aGlzLmFuYWx5dGljcy5sZW5kZXJzTWF0Y2hlZCA9IGxlbmRlcnNNYXRjaGVkO1xyXG4gIH1cclxuXHJcbiAgc2V0U3VjY2VzcyhzdWNjZXNzOiBib29sZWFuLCBlcnJvck1lc3NhZ2U/OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMuYW5hbHl0aWNzLnN1Y2Nlc3MgPSBzdWNjZXNzO1xyXG4gICAgdGhpcy5hbmFseXRpY3MuZXJyb3JNZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgdGhpcy5hbmFseXRpY3MudG90YWxEdXJhdGlvbk1zID0gTWF0aC5yb3VuZChwZXJmb3JtYW5jZS5ub3coKSAtIHRoaXMuc3RhcnRUaW1lKTtcclxuICB9XHJcblxyXG4gIGdldFNlc3Npb25JZCgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHRoaXMuc2Vzc2lvbklkO1xyXG4gIH1cclxuXHJcbiAgZ2V0QW5hbHl0aWNzKCk6IFN1Ym1pc3Npb25BbmFseXRpY3Mge1xyXG4gICAgcmV0dXJuIHsgLi4udGhpcy5hbmFseXRpY3MgfTtcclxuICB9XHJcblxyXG4gIGdldFRvdGFsRHVyYXRpb24oKTogbnVtYmVyIHtcclxuICAgIHJldHVybiBNYXRoLnJvdW5kKHBlcmZvcm1hbmNlLm5vdygpIC0gdGhpcy5zdGFydFRpbWUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRoZSBkdXJhdGlvbiBvZiBhIGNvbXBsZXRlZCBzdGVwXHJcbiAgICovXHJcbiAgZ2V0U3RlcER1cmF0aW9uKHN0ZXBOYW1lOiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgc3dpdGNoIChzdGVwTmFtZSkge1xyXG4gICAgICBjYXNlICdzdGVwMV9kcml2ZV91cGxvYWQnOlxyXG4gICAgICAgIHJldHVybiB0aGlzLmFuYWx5dGljcy5zdGVwMURyaXZlVXBsb2FkTXMgfHwgMDtcclxuICAgICAgY2FzZSAnc3RlcDJfcGFyc2VfYXBwbGljYXRpb24nOlxyXG4gICAgICAgIHJldHVybiB0aGlzLmFuYWx5dGljcy5zdGVwMlBhcnNlQXBwbGljYXRpb25NcyB8fCAwO1xyXG4gICAgICBjYXNlICdzdGVwM19wYXJzZV9zdGF0ZW1lbnRzJzpcclxuICAgICAgICByZXR1cm4gdGhpcy5hbmFseXRpY3Muc3RlcDNQYXJzZVN0YXRlbWVudHNNcyB8fCAwO1xyXG4gICAgICBjYXNlICdzdGVwNF9jcmVhdGVfZGVhbCc6XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYW5hbHl0aWNzLnN0ZXA0Q3JlYXRlRGVhbE1zIHx8IDA7XHJcbiAgICAgIGNhc2UgJ3N0ZXA1X21hdGNoX2xlbmRlcnMnOlxyXG4gICAgICAgIHJldHVybiB0aGlzLmFuYWx5dGljcy5zdGVwNU1hdGNoTGVuZGVyc01zIHx8IDA7XHJcbiAgICAgIGNhc2UgJ3N0ZXA2X3N1Ym1pdCc6XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYW5hbHl0aWNzLnN0ZXA2U3VibWl0TXMgfHwgMDtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNhdmUgYW5hbHl0aWNzIHRvIGRhdGFiYXNlXHJcbiAgICovXHJcbiAgYXN5bmMgc2F2ZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEVuc3VyZSB0b3RhbCBkdXJhdGlvbiBpcyBzZXRcclxuICAgICAgaWYgKCF0aGlzLmFuYWx5dGljcy50b3RhbER1cmF0aW9uTXMpIHtcclxuICAgICAgICB0aGlzLmFuYWx5dGljcy50b3RhbER1cmF0aW9uTXMgPSB0aGlzLmdldFRvdGFsRHVyYXRpb24oKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnZGVhbF9zdWJtaXNzaW9uX2FuYWx5dGljcycpXHJcbiAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICBzZXNzaW9uX2lkOiB0aGlzLmFuYWx5dGljcy5zZXNzaW9uSWQsXHJcbiAgICAgICAgICBkZWFsX2lkOiB0aGlzLmFuYWx5dGljcy5kZWFsSWQsXHJcbiAgICAgICAgICB1c2VyX2lkOiB0aGlzLmFuYWx5dGljcy51c2VySWQsXHJcbiAgICAgICAgICB0b3RhbF9kdXJhdGlvbl9tczogdGhpcy5hbmFseXRpY3MudG90YWxEdXJhdGlvbk1zLFxyXG4gICAgICAgICAgc3VjY2VzczogdGhpcy5hbmFseXRpY3Muc3VjY2VzcyxcclxuICAgICAgICAgIGVycm9yX21lc3NhZ2U6IHRoaXMuYW5hbHl0aWNzLmVycm9yTWVzc2FnZSxcclxuICAgICAgICAgIHRvdGFsX2RvY3VtZW50czogdGhpcy5hbmFseXRpY3MudG90YWxEb2N1bWVudHMsXHJcbiAgICAgICAgICBhcHBsaWNhdGlvbl9kb2N1bWVudHM6IHRoaXMuYW5hbHl0aWNzLmFwcGxpY2F0aW9uRG9jdW1lbnRzLFxyXG4gICAgICAgICAgYmFua19zdGF0ZW1lbnRfZG9jdW1lbnRzOiB0aGlzLmFuYWx5dGljcy5iYW5rU3RhdGVtZW50RG9jdW1lbnRzLFxyXG4gICAgICAgICAgb3RoZXJfZG9jdW1lbnRzOiB0aGlzLmFuYWx5dGljcy5vdGhlckRvY3VtZW50cyxcclxuICAgICAgICAgIHRvdGFsX2RvY3VtZW50X3NpemVfYnl0ZXM6IHRoaXMuYW5hbHl0aWNzLnRvdGFsRG9jdW1lbnRTaXplQnl0ZXMsXHJcbiAgICAgICAgICBzdGVwMV9kcml2ZV91cGxvYWRfbXM6IHRoaXMuYW5hbHl0aWNzLnN0ZXAxRHJpdmVVcGxvYWRNcyxcclxuICAgICAgICAgIHN0ZXAyX3BhcnNlX2FwcGxpY2F0aW9uX21zOiB0aGlzLmFuYWx5dGljcy5zdGVwMlBhcnNlQXBwbGljYXRpb25NcyxcclxuICAgICAgICAgIHN0ZXAzX3BhcnNlX3N0YXRlbWVudHNfbXM6IHRoaXMuYW5hbHl0aWNzLnN0ZXAzUGFyc2VTdGF0ZW1lbnRzTXMsXHJcbiAgICAgICAgICBzdGVwNF9jcmVhdGVfZGVhbF9tczogdGhpcy5hbmFseXRpY3Muc3RlcDRDcmVhdGVEZWFsTXMsXHJcbiAgICAgICAgICBzdGVwNV9tYXRjaF9sZW5kZXJzX21zOiB0aGlzLmFuYWx5dGljcy5zdGVwNU1hdGNoTGVuZGVyc01zLFxyXG4gICAgICAgICAgc3RlcDZfc3VibWl0X21zOiB0aGlzLmFuYWx5dGljcy5zdGVwNlN1Ym1pdE1zLFxyXG4gICAgICAgICAgYXBpX21vZGVsc191c2VkOiB0aGlzLmFuYWx5dGljcy5hcGlNb2RlbHNVc2VkLFxyXG4gICAgICAgICAgc3RlcHNfY29tcGxldGVkOiB0aGlzLmFuYWx5dGljcy5zdGVwc0NvbXBsZXRlZCxcclxuICAgICAgICAgIGZhaWxlZF9zdGVwOiB0aGlzLmFuYWx5dGljcy5mYWlsZWRTdGVwLFxyXG4gICAgICAgICAgY2xpZW50X2luZm86IHRoaXMuYW5hbHl0aWNzLmNsaWVudEluZm8sXHJcbiAgICAgICAgICBidXNpbmVzc19uYW1lOiB0aGlzLmFuYWx5dGljcy5idXNpbmVzc05hbWUsXHJcbiAgICAgICAgICBsb2FuX3R5cGU6IHRoaXMuYW5hbHl0aWNzLmxvYW5UeXBlLFxyXG4gICAgICAgICAgbG9hbl9hbW91bnQ6IHRoaXMuYW5hbHl0aWNzLmxvYW5BbW91bnQsXHJcbiAgICAgICAgICBsZW5kZXJzX21hdGNoZWQ6IHRoaXMuYW5hbHl0aWNzLmxlbmRlcnNNYXRjaGVkLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgc3VibWlzc2lvbiBhbmFseXRpY3M6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc29sZS5sb2coJ1tBbmFseXRpY3NdIFNhdmVkIHN1Ym1pc3Npb24gYW5hbHl0aWNzOicsIHtcclxuICAgICAgICBzZXNzaW9uSWQ6IHRoaXMuc2Vzc2lvbklkLFxyXG4gICAgICAgIHRvdGFsRHVyYXRpb25NczogdGhpcy5hbmFseXRpY3MudG90YWxEdXJhdGlvbk1zLFxyXG4gICAgICAgIHN1Y2Nlc3M6IHRoaXMuYW5hbHl0aWNzLnN1Y2Nlc3MsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgc3VibWlzc2lvbiBhbmFseXRpY3M6JywgZXJyKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIHN1Ym1pc3Npb24gYW5hbHl0aWNzIGZvciBkYXNoYm9hcmRcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTdWJtaXNzaW9uQW5hbHl0aWNzKFxyXG4gIGRheXM6IG51bWJlciA9IDMwXHJcbik6IFByb21pc2U8e1xyXG4gIHRvdGFsU3VibWlzc2lvbnM6IG51bWJlcjtcclxuICBzdWNjZXNzUmF0ZTogbnVtYmVyO1xyXG4gIGF2Z0R1cmF0aW9uTXM6IG51bWJlcjtcclxuICBhdmdEb2N1bWVudHM6IG51bWJlcjtcclxuICBzdGVwUGVyZm9ybWFuY2U6IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XHJcbiAgZGFpbHlTdGF0czogQXJyYXk8e1xyXG4gICAgZGF0ZTogc3RyaW5nO1xyXG4gICAgY291bnQ6IG51bWJlcjtcclxuICAgIHN1Y2Nlc3NSYXRlOiBudW1iZXI7XHJcbiAgICBhdmdEdXJhdGlvbjogbnVtYmVyO1xyXG4gIH0+O1xyXG59PiB7XHJcbiAgY29uc3Qgc3RhcnREYXRlID0gbmV3IERhdGUoKTtcclxuICBzdGFydERhdGUuc2V0RGF0ZShzdGFydERhdGUuZ2V0RGF0ZSgpIC0gZGF5cyk7XHJcblxyXG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAuZnJvbSgnZGVhbF9zdWJtaXNzaW9uX2FuYWx5dGljcycpXHJcbiAgICAuc2VsZWN0KCcqJylcclxuICAgIC5ndGUoJ2NyZWF0ZWRfYXQnLCBzdGFydERhdGUudG9JU09TdHJpbmcoKSlcclxuICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcclxuXHJcbiAgaWYgKGVycm9yIHx8ICFkYXRhKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggc3VibWlzc2lvbiBhbmFseXRpY3M6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdG90YWxTdWJtaXNzaW9uczogMCxcclxuICAgICAgc3VjY2Vzc1JhdGU6IDAsXHJcbiAgICAgIGF2Z0R1cmF0aW9uTXM6IDAsXHJcbiAgICAgIGF2Z0RvY3VtZW50czogMCxcclxuICAgICAgc3RlcFBlcmZvcm1hbmNlOiB7fSxcclxuICAgICAgZGFpbHlTdGF0czogW10sXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgY29uc3QgdG90YWxTdWJtaXNzaW9ucyA9IGRhdGEubGVuZ3RoO1xyXG4gIGNvbnN0IHN1Y2Nlc3NmdWxTdWJtaXNzaW9ucyA9IGRhdGEuZmlsdGVyKGQgPT4gZC5zdWNjZXNzKS5sZW5ndGg7XHJcbiAgY29uc3Qgc3VjY2Vzc1JhdGUgPSB0b3RhbFN1Ym1pc3Npb25zID4gMCA/IChzdWNjZXNzZnVsU3VibWlzc2lvbnMgLyB0b3RhbFN1Ym1pc3Npb25zKSAqIDEwMCA6IDA7XHJcblxyXG4gIGNvbnN0IGF2Z0R1cmF0aW9uTXMgPSB0b3RhbFN1Ym1pc3Npb25zID4gMFxyXG4gICAgPyBkYXRhLnJlZHVjZSgoc3VtLCBkKSA9PiBzdW0gKyAoZC50b3RhbF9kdXJhdGlvbl9tcyB8fCAwKSwgMCkgLyB0b3RhbFN1Ym1pc3Npb25zXHJcbiAgICA6IDA7XHJcblxyXG4gIGNvbnN0IGF2Z0RvY3VtZW50cyA9IHRvdGFsU3VibWlzc2lvbnMgPiAwXHJcbiAgICA/IGRhdGEucmVkdWNlKChzdW0sIGQpID0+IHN1bSArIChkLnRvdGFsX2RvY3VtZW50cyB8fCAwKSwgMCkgLyB0b3RhbFN1Ym1pc3Npb25zXHJcbiAgICA6IDA7XHJcblxyXG4gIC8vIENhbGN1bGF0ZSBhdmVyYWdlIHN0ZXAgcGVyZm9ybWFuY2VcclxuICBjb25zdCBzdGVwUGVyZm9ybWFuY2U6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcclxuICBjb25zdCBzdGVwRmllbGRzID0gW1xyXG4gICAgJ3N0ZXAxX2RyaXZlX3VwbG9hZF9tcycsXHJcbiAgICAnc3RlcDJfcGFyc2VfYXBwbGljYXRpb25fbXMnLFxyXG4gICAgJ3N0ZXAzX3BhcnNlX3N0YXRlbWVudHNfbXMnLFxyXG4gICAgJ3N0ZXA0X2NyZWF0ZV9kZWFsX21zJyxcclxuICAgICdzdGVwNV9tYXRjaF9sZW5kZXJzX21zJyxcclxuICAgICdzdGVwNl9zdWJtaXRfbXMnLFxyXG4gIF07XHJcblxyXG4gIHN0ZXBGaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XHJcbiAgICBjb25zdCB2YWx1ZXMgPSBkYXRhLm1hcChkID0+IGRbZmllbGRdKS5maWx0ZXIodiA9PiB2ICE9PSBudWxsICYmIHYgIT09IHVuZGVmaW5lZCk7XHJcbiAgICBpZiAodmFsdWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgc3RlcFBlcmZvcm1hbmNlW2ZpZWxkXSA9IHZhbHVlcy5yZWR1Y2UoKHN1bSwgdikgPT4gc3VtICsgdiwgMCkgLyB2YWx1ZXMubGVuZ3RoO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAvLyBHcm91cCBieSBkYXlcclxuICBjb25zdCBkYWlseU1hcCA9IG5ldyBNYXA8c3RyaW5nLCB7IGNvdW50OiBudW1iZXI7IHN1Y2Nlc3M6IG51bWJlcjsgZHVyYXRpb246IG51bWJlciB9PigpO1xyXG4gIGRhdGEuZm9yRWFjaChkID0+IHtcclxuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkLmNyZWF0ZWRfYXQpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcclxuICAgIGNvbnN0IGV4aXN0aW5nID0gZGFpbHlNYXAuZ2V0KGRhdGUpIHx8IHsgY291bnQ6IDAsIHN1Y2Nlc3M6IDAsIGR1cmF0aW9uOiAwIH07XHJcbiAgICBleGlzdGluZy5jb3VudCsrO1xyXG4gICAgaWYgKGQuc3VjY2VzcykgZXhpc3Rpbmcuc3VjY2VzcysrO1xyXG4gICAgZXhpc3RpbmcuZHVyYXRpb24gKz0gZC50b3RhbF9kdXJhdGlvbl9tcyB8fCAwO1xyXG4gICAgZGFpbHlNYXAuc2V0KGRhdGUsIGV4aXN0aW5nKTtcclxuICB9KTtcclxuXHJcbiAgY29uc3QgZGFpbHlTdGF0cyA9IEFycmF5LmZyb20oZGFpbHlNYXAuZW50cmllcygpKS5tYXAoKFtkYXRlLCBzdGF0c10pID0+ICh7XHJcbiAgICBkYXRlLFxyXG4gICAgY291bnQ6IHN0YXRzLmNvdW50LFxyXG4gICAgc3VjY2Vzc1JhdGU6IChzdGF0cy5zdWNjZXNzIC8gc3RhdHMuY291bnQpICogMTAwLFxyXG4gICAgYXZnRHVyYXRpb246IHN0YXRzLmR1cmF0aW9uIC8gc3RhdHMuY291bnQsXHJcbiAgfSkpO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgdG90YWxTdWJtaXNzaW9ucyxcclxuICAgIHN1Y2Nlc3NSYXRlLFxyXG4gICAgYXZnRHVyYXRpb25NcyxcclxuICAgIGF2Z0RvY3VtZW50cyxcclxuICAgIHN0ZXBQZXJmb3JtYW5jZSxcclxuICAgIGRhaWx5U3RhdHMsXHJcbiAgfTtcclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUtBLFNBQVMsZ0JBQWdCO0FBdURsQixhQUFNLDJCQUEyQjtBQUFBLEVBQzlCO0FBQUEsRUFDQTtBQUFBLEVBQ0EsaUJBQXlDLENBQUM7QUFBQSxFQUVsRCxjQUFjO0FBQ1osU0FBSyxZQUFZLE9BQU8sV0FBVztBQUNuQyxTQUFLLFlBQVksWUFBWSxJQUFJO0FBQ2pDLFNBQUssWUFBWTtBQUFBLE1BQ2YsV0FBVyxLQUFLO0FBQUEsTUFDaEIsU0FBUztBQUFBLE1BQ1QsZ0JBQWdCO0FBQUEsTUFDaEIsc0JBQXNCO0FBQUEsTUFDdEIsd0JBQXdCO0FBQUEsTUFDeEIsZ0JBQWdCO0FBQUEsTUFDaEIsd0JBQXdCO0FBQUEsTUFDeEIsZUFBZSxDQUFDO0FBQUEsTUFDaEIsZ0JBQWdCLENBQUM7QUFBQSxJQUNuQjtBQUdBLFNBQUssa0JBQWtCO0FBQUEsRUFDekI7QUFBQSxFQUVRO0FBQUEsRUFFQSxvQkFBMEI7QUFDaEMsUUFBSTtBQUNGLFlBQU0sS0FBSyxVQUFVO0FBQ3JCLFlBQU0sYUFBYyxVQUFrQjtBQUV0QyxXQUFLLFVBQVUsYUFBYTtBQUFBLFFBQzFCLFNBQVMsS0FBSyxXQUFXLEVBQUU7QUFBQSxRQUMzQixJQUFJLEtBQUssTUFBTSxFQUFFO0FBQUEsUUFDakIsWUFBWSxHQUFHLE9BQU8sT0FBTyxLQUFLLElBQUksT0FBTyxPQUFPLE1BQU07QUFBQSxRQUMxRCxnQkFBZ0IsWUFBWSxpQkFBaUI7QUFBQSxNQUMvQztBQUFBLElBQ0YsUUFBUTtBQUFB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