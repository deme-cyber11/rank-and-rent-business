import __vite__cjsImport0_papaparse from "/node_modules/.vite/deps/papaparse.js?v=9303f522"; const Papa = __vite__cjsImport0_papaparse.__esModule ? __vite__cjsImport0_papaparse.default : __vite__cjsImport0_papaparse;
import * as XLSX from "/node_modules/.vite/deps/xlsx.js?v=9303f522";
const COLUMN_PATTERNS = {
  sku: [
    /^sku$/i,
    /^product\s*id$/i,
    /^product\s*sku$/i,
    /^item\s*id$/i,
    /^variant\s*sku$/i,
    /^handle$/i
  ],
  newPrice: [
    /^new\s*price$/i,
    /^price$/i,
    /^new\s*cost$/i,
    /^updated\s*price$/i,
    /^sell\s*price$/i,
    /^selling\s*price$/i
  ],
  compareAtPrice: [
    /^compare\s*at\s*price$/i,
    /^compare\s*price$/i,
    /^msrp$/i,
    /^list\s*price$/i,
    /^was\s*price$/i
  ],
  notes: [
    /^notes?$/i,
    /^comments?$/i,
    /^remarks?$/i,
    /^memo$/i
  ]
};
function detectColumns(headers) {
  const detected = {};
  for (const header of headers) {
    const trimmedHeader = header.trim();
    if (!trimmedHeader) continue;
    for (const [fieldName, patterns] of Object.entries(COLUMN_PATTERNS)) {
      for (const pattern of patterns) {
        if (pattern.test(trimmedHeader)) {
          detected[fieldName] = trimmedHeader;
          break;
        }
      }
      if (detected[fieldName]) break;
    }
  }
  return detected;
}
export async function parseUploadedFile(file) {
  const errors = [];
  try {
    const fileName = file.name.toLowerCase();
    const isCSV = fileName.endsWith(".csv");
    const isExcel = fileName.endsWith(".xlsx") || fileName.endsWith(".xls");
    if (!isCSV && !isExcel) {
      return {
        success: false,
        rows: [],
        totalRows: 0,
        detectedColumns: {},
        errors: ["Unsupported file format. Please upload a CSV or Excel file."]
      };
    }
    let rows = [];
    let headers = [];
    if (isCSV) {
      const text = await file.text();
      const parseResult = Papa.parse(text, {
        header: true,
        skipEmptyLines: true,
        dynamicTyping: false,
        // Keep everything as strings for consistent handling
        transformHeader: (header) => header.trim()
      });
      if (parseResult.errors.length > 0) {
        parseResult.errors.forEach((err) => {
          errors.push(`CSV Parse Error (Row ${err.row}): ${err.message}`);
        });
      }
      rows = parseResult.data;
      headers = parseResult.meta.fields || [];
    } else {
      const arrayBuffer = await file.arrayBuffer();
      const workbook = XLSX.read(arrayBuffer, { type: "array" });
      const sheetName = workbook.SheetNames[0];
      if (!sheetName) {
        return {
          success: false,
          rows: [],
          totalRows: 0,
          detectedColumns: {},
          errors: ["Excel file has no sheets."]
        };
      }
      const worksheet = workbook.Sheets[sheetName];
      const jsonData = XLSX.utils.sheet_to_json(worksheet, {
        defval: "",
        raw: false
        // Convert everything to strings
      });
      rows = jsonData;
      const range = XLSX.utils.decode_range(worksheet["!ref"] || "A1");
      for (let col = range.s.c; col <= range.e.c; col++) {
        const cellAddress = XLSX.utils.encode_cell({ r: range.s.r, c: col });
        const cell = worksheet[cellAddress];
        if (cell && cell.v) {
          headers.push(String(cell.v).trim());
        }
      }
    }
    const detectedColumns = detectColumns(headers);
    if (!detectedColumns.sku) {
      errors.push(
        "Could not detect SKU column. Please ensure your file has a column named 'SKU', 'Product ID', or 'Handle'."
      );
    }
    if (!detectedColumns.newPrice) {
      errors.push(
        "Could not detect price column. Please ensure your file has a column named 'New Price' or 'Price'."
      );
    }
    if (errors.length > 0) {
      return {
        success: false,
        rows: [],
        totalRows: rows.length,
        detectedColumns,
        errors
      };
    }
    return {
      success: true,
      rows,
      totalRows: rows.length,
      detectedColumns,
      errors: []
    };
  } catch (error) {
    return {
      success: false,
      rows: [],
      totalRows: 0,
      detectedColumns: {},
      errors: [
        `Failed to parse file: ${error instanceof Error ? error.message : "Unknown error"}`
      ]
    };
  }
}
function parseNumericValue(value) {
  if (value === null || value === void 0 || value === "") return null;
  const str = String(value).replace(/[$,]/g, "").trim();
  const num = parseFloat(str);
  return isNaN(num) ? null : num;
}
function normalizeSku(sku) {
  if (!sku || String(sku).trim() === "") return "";
  return String(sku).trim().toUpperCase();
}
export function validatePricingData(rows, detectedColumns, shopifyData, largePriceChangeThreshold = 0.5) {
  const validRows = [];
  const errors = [];
  const warnings = [];
  const seenSkus = /* @__PURE__ */ new Set();
  const duplicateSkus = /* @__PURE__ */ new Set();
  let skuNotFoundCount = 0;
  let largePriceChangeCount = 0;
  const skuCol = detectedColumns.sku;
  const priceCol = detectedColumns.newPrice;
  const compareCol = detectedColumns.compareAtPrice;
  const notesCol = detectedColumns.notes;
  rows.forEach((row, index) => {
    const rowNumber = index + 2;
    const rawSku = row[skuCol];
    const sku = normalizeSku(rawSku);
    if (!sku) {
      errors.push({
        rowNumber,
        sku: String(rawSku || ""),
        field: skuCol,
        message: "SKU is required",
        severity: "error"
      });
      return;
    }
    if (seenSkus.has(sku)) {
      duplicateSkus.add(sku);
      errors.push({
        rowNumber,
        sku,
        field: skuCol,
        message: `Duplicate SKU found in file (first occurrence processed)`,
        severity: "error"
      });
      return;
    }
    seenSkus.add(sku);
    const newPrice = parseNumericValue(row[priceCol]);
    if (newPrice === null) {
      errors.push({
        rowNumber,
        sku,
        field: priceCol,
        message: "New Price is required and must be a valid number",
        severity: "error"
      });
      return;
    }
    if (newPrice <= 0) {
      errors.push({
        rowNumber,
        sku,
        field: priceCol,
        message: "New Price must be greater than 0",
        severity: "error"
      });
      return;
    }
    const productData = shopifyData.get(sku);
    if (!productData) {
      skuNotFoundCount++;
      errors.push({
        rowNumber,
        sku,
        field: skuCol,
        message: "SKU not found in Shopify products",
        severity: "error"
      });
      return;
    }
    const currentPrice = productData.currentPrice;
    if (currentPrice > 0) {
      const changePercent = Math.abs((newPrice - currentPrice) / currentPrice);
      if (changePercent > largePriceChangeThreshold) {
        largePriceChangeCount++;
        warnings.push({
          rowNumber,
          sku,
          field: priceCol,
          message: `Large price change: ${(changePercent * 100).toFixed(1)}% (from $${currentPrice.toFixed(2)} to $${newPrice.toFixed(2)})`,
          severity: "warning"
        });
      }
    }
    const compareAtPrice = compareCol ? parseNumericValue(row[compareCol]) : void 0;
    const notes = notesCol ? String(row[notesCol] || "").trim() : void 0;
    validRows.push({
      sku,
      newPrice,
      compareAtPrice,
      notes,
      rowNumber
    });
  });
  return {
    success: errors.length === 0,
    validRows,
    errors,
    warnings,
    summary: {
      totalRows: rows.length,
      validRows: validRows.length,
      errorRows: errors.filter((e) => e.severity === "error").length,
      warningRows: warnings.length,
      duplicateSkus: duplicateSkus.size,
      skuNotFound: skuNotFoundCount,
      largePriceChanges: largePriceChangeCount
    }
  };
}
export function buildPriceUpdateRecords(validRows, shopifyData) {
  const records = [];
  for (const row of validRows) {
    const productData = shopifyData.get(row.sku);
    if (!productData) {
      console.warn(`Skipping SKU ${row.sku} - not found in Shopify data`);
      continue;
    }
    const priceChange = row.newPrice - productData.currentPrice;
    const priceChangePercent = productData.currentPrice > 0 ? priceChange / productData.currentPrice : 0;
    let newCompareAtPrice = productData.compareAtPrice;
    if (row.compareAtPrice !== void 0) {
      newCompareAtPrice = row.compareAtPrice > 0 ? row.compareAtPrice : null;
    }
    records.push({
      sku: row.sku,
      variantId: productData.variantId,
      productId: productData.productId,
      productTitle: productData.productTitle,
      variantTitle: productData.variantTitle,
      handle: productData.handle,
      currentPrice: productData.currentPrice,
      newPrice: row.newPrice,
      priceChange,
      priceChangePercent,
      compareAtPrice: productData.compareAtPrice,
      newCompareAtPrice,
      notes: row.notes,
      rowNumber: row.rowNumber
    });
  }
  return records;
}
export async function processPricingFile(file, shopifyData, largePriceChangeThreshold = 0.5) {
  const parseResult = await parseUploadedFile(file);
  if (!parseResult.success) {
    return {
      success: false,
      records: [],
      validation: {
        success: false,
        validRows: [],
        errors: parseResult.errors.map((msg, i) => ({
          rowNumber: 0,
          sku: "",
          field: "file",
          message: msg,
          severity: "error"
        })),
        warnings: [],
        summary: {
          totalRows: 0,
          validRows: 0,
          errorRows: parseResult.errors.length,
          warningRows: 0,
          duplicateSkus: 0,
          skuNotFound: 0,
          largePriceChanges: 0
        }
      },
      summary: {
        totalRecords: 0,
        totalPriceIncrease: 0,
        totalPriceDecrease: 0,
        avgPriceChange: 0,
        avgPriceChangePercent: 0,
        maxPriceChange: 0,
        minPriceChange: 0
      }
    };
  }
  const validationResult = validatePricingData(
    parseResult.rows,
    parseResult.detectedColumns,
    shopifyData,
    largePriceChangeThreshold
  );
  const records = buildPriceUpdateRecords(
    validationResult.validRows,
    shopifyData
  );
  let totalPriceIncrease = 0;
  let totalPriceDecrease = 0;
  let totalPriceChange = 0;
  let totalPriceChangePercent = 0;
  let maxPriceChange = 0;
  let minPriceChange = 0;
  records.forEach((record) => {
    const change = record.priceChange;
    totalPriceChange += change;
    totalPriceChangePercent += record.priceChangePercent;
    if (change > 0) {
      totalPriceIncrease += change;
    } else if (change < 0) {
      totalPriceDecrease += Math.abs(change);
    }
    if (change > maxPriceChange) maxPriceChange = change;
    if (change < minPriceChange) minPriceChange = change;
  });
  const avgPriceChange = records.length > 0 ? totalPriceChange / records.length : 0;
  const avgPriceChangePercent = records.length > 0 ? totalPriceChangePercent / records.length : 0;
  return {
    success: validationResult.success && records.length > 0,
    records,
    validation: validationResult,
    summary: {
      totalRecords: records.length,
      totalPriceIncrease,
      totalPriceDecrease,
      avgPriceChange,
      avgPriceChangePercent,
      maxPriceChange,
      minPriceChange
    }
  };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByaWNpbmctcHJvY2Vzc29yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBQcmljaW5nIFByb2Nlc3NvciBmb3IgYnVsayBwcmljZSB1cGRhdGVzIGZyb20gQ1NWL0V4Y2VsIGZpbGVzLlxyXG4gKiBIYW5kbGVzIGZpbGUgcGFyc2luZywgdmFsaWRhdGlvbiwgYW5kIHByZXBhcmF0aW9uIGZvciBTaG9waWZ5IHByaWNlIHVwZGF0ZXMuXHJcbiAqXHJcbiAqIEZpbGUgRm9ybWF0OlxyXG4gKiAtIFN1cHBvcnRzIGJvdGggQ1NWIGFuZCBFeGNlbCAoLnhsc3gsIC54bHMpXHJcbiAqIC0gUmVxdWlyZWQgY29sdW1uczogU0tVIChvciBQcm9kdWN0IElELCBIYW5kbGUpLCBOZXcgUHJpY2VcclxuICogLSBPcHRpb25hbCBjb2x1bW5zOiBDb21wYXJlIEF0IFByaWNlLCBOb3Rlc1xyXG4gKiAtIEF1dG8tZGV0ZWN0cyBjb2x1bW4gbmFtZXMgKGNhc2UtaW5zZW5zaXRpdmUsIGZsZXhpYmxlIG1hdGNoaW5nKVxyXG4gKlxyXG4gKiBWYWxpZGF0aW9uIFN0cmF0ZWd5OlxyXG4gKiAxLiBDaGVjayByZXF1aXJlZCBmaWVsZHMgKFNLVSwgTmV3IFByaWNlKVxyXG4gKiAyLiBWYWxpZGF0ZSBudW1lcmljIHByaWNlcyA+IDBcclxuICogMy4gVmVyaWZ5IFNLVSBleGlzdHMgaW4gU2hvcGlmeSBkYXRhXHJcbiAqIDQuIERldGVjdCBkdXBsaWNhdGUgU0tVcyBpbiBmaWxlXHJcbiAqIDUuIEZsYWcgbGFyZ2UgcHJpY2UgY2hhbmdlcyAoPjUwJSBieSBkZWZhdWx0KVxyXG4gKi9cclxuXHJcbmltcG9ydCBQYXBhIGZyb20gXCJwYXBhcGFyc2VcIjtcclxuaW1wb3J0ICogYXMgWExTWCBmcm9tIFwieGxzeFwiO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBUWVBFU1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogUmF3IHJvdyBmcm9tIHVwbG9hZGVkIGZpbGUgKGJlZm9yZSB2YWxpZGF0aW9uKVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBSYXdQcmljaW5nUm93IHtcclxuICBba2V5OiBzdHJpbmddOiBzdHJpbmcgfCBudW1iZXIgfCBudWxsIHwgdW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogUHJvZHVjdCBkYXRhIGZyb20gU2hvcGlmeSAobWFzdGVyIGRhdGEgZm9yIHZhbGlkYXRpb24pXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFByb2R1Y3REYXRhIHtcclxuICBza3U6IHN0cmluZztcclxuICB2YXJpYW50SWQ6IHN0cmluZztcclxuICBwcm9kdWN0SWQ6IHN0cmluZztcclxuICBwcm9kdWN0VGl0bGU6IHN0cmluZztcclxuICB2YXJpYW50VGl0bGU6IHN0cmluZztcclxuICBjdXJyZW50UHJpY2U6IG51bWJlcjtcclxuICBjb21wYXJlQXRQcmljZTogbnVtYmVyIHwgbnVsbDtcclxuICBoYW5kbGU6IHN0cmluZztcclxuICBzdGF0dXM6IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlZCByb3cgcmVhZHkgZm9yIHByb2Nlc3NpbmdcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRQcmljaW5nUm93IHtcclxuICBza3U6IHN0cmluZztcclxuICBuZXdQcmljZTogbnVtYmVyO1xyXG4gIGNvbXBhcmVBdFByaWNlPzogbnVtYmVyO1xyXG4gIG5vdGVzPzogc3RyaW5nO1xyXG4gIHJvd051bWJlcjogbnVtYmVyOyAvLyBUcmFjayBvcmlnaW5hbCByb3cgbnVtYmVyIGZvciBlcnJvciByZXBvcnRpbmdcclxufVxyXG5cclxuLyoqXHJcbiAqIFByaWNlIHVwZGF0ZSByZWNvcmQgcmVhZHkgZm9yIGRhdGFiYXNlIGluc2VydGlvblxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBQcmljZVVwZGF0ZVJlY29yZCB7XHJcbiAgc2t1OiBzdHJpbmc7XHJcbiAgdmFyaWFudElkOiBzdHJpbmc7XHJcbiAgcHJvZHVjdElkOiBzdHJpbmc7XHJcbiAgcHJvZHVjdFRpdGxlOiBzdHJpbmc7XHJcbiAgdmFyaWFudFRpdGxlOiBzdHJpbmc7XHJcbiAgaGFuZGxlOiBzdHJpbmc7XHJcbiAgY3VycmVudFByaWNlOiBudW1iZXI7XHJcbiAgbmV3UHJpY2U6IG51bWJlcjtcclxuICBwcmljZUNoYW5nZTogbnVtYmVyOyAvLyBEb2xsYXIgY2hhbmdlXHJcbiAgcHJpY2VDaGFuZ2VQZXJjZW50OiBudW1iZXI7IC8vIFBlcmNlbnRhZ2UgY2hhbmdlXHJcbiAgY29tcGFyZUF0UHJpY2U6IG51bWJlciB8IG51bGw7XHJcbiAgbmV3Q29tcGFyZUF0UHJpY2U6IG51bWJlciB8IG51bGw7XHJcbiAgbm90ZXM/OiBzdHJpbmc7XHJcbiAgcm93TnVtYmVyOiBudW1iZXI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0aW9uIGVycm9yIHdpdGggZGV0YWlsc1xyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0aW9uRXJyb3Ige1xyXG4gIHJvd051bWJlcjogbnVtYmVyO1xyXG4gIHNrdTogc3RyaW5nO1xyXG4gIGZpZWxkOiBzdHJpbmc7XHJcbiAgbWVzc2FnZTogc3RyaW5nO1xyXG4gIHNldmVyaXR5OiBcImVycm9yXCIgfCBcIndhcm5pbmdcIjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlc3VsdCBvZiBwYXJzaW5nIHVwbG9hZGVkIGZpbGVcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgUGFyc2VSZXN1bHQge1xyXG4gIHN1Y2Nlc3M6IGJvb2xlYW47XHJcbiAgcm93czogUmF3UHJpY2luZ1Jvd1tdO1xyXG4gIHRvdGFsUm93czogbnVtYmVyO1xyXG4gIGRldGVjdGVkQ29sdW1uczoge1xyXG4gICAgc2t1Pzogc3RyaW5nO1xyXG4gICAgbmV3UHJpY2U/OiBzdHJpbmc7XHJcbiAgICBjb21wYXJlQXRQcmljZT86IHN0cmluZztcclxuICAgIG5vdGVzPzogc3RyaW5nO1xyXG4gIH07XHJcbiAgZXJyb3JzOiBzdHJpbmdbXTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlc3VsdCBvZiB2YWxpZGF0aW9uIHByb2Nlc3NcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICB2YWxpZFJvd3M6IFZhbGlkUHJpY2luZ1Jvd1tdO1xyXG4gIGVycm9yczogVmFsaWRhdGlvbkVycm9yW107XHJcbiAgd2FybmluZ3M6IFZhbGlkYXRpb25FcnJvcltdO1xyXG4gIHN1bW1hcnk6IHtcclxuICAgIHRvdGFsUm93czogbnVtYmVyO1xyXG4gICAgdmFsaWRSb3dzOiBudW1iZXI7XHJcbiAgICBlcnJvclJvd3M6IG51bWJlcjtcclxuICAgIHdhcm5pbmdSb3dzOiBudW1iZXI7XHJcbiAgICBkdXBsaWNhdGVTa3VzOiBudW1iZXI7XHJcbiAgICBza3VOb3RGb3VuZDogbnVtYmVyO1xyXG4gICAgbGFyZ2VQcmljZUNoYW5nZXM6IG51bWJlcjtcclxuICB9O1xyXG59XHJcblxyXG4vKipcclxuICogRmluYWwgcmVzdWx0IHdpdGggcHJlcGFyZWQgcmVjb3Jkc1xyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBQcmljaW5nUHJvY2Vzc29yUmVzdWx0IHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIHJlY29yZHM6IFByaWNlVXBkYXRlUmVjb3JkW107XHJcbiAgdmFsaWRhdGlvbjogVmFsaWRhdGlvblJlc3VsdDtcclxuICBzdW1tYXJ5OiB7XHJcbiAgICB0b3RhbFJlY29yZHM6IG51bWJlcjtcclxuICAgIHRvdGFsUHJpY2VJbmNyZWFzZTogbnVtYmVyO1xyXG4gICAgdG90YWxQcmljZURlY3JlYXNlOiBudW1iZXI7XHJcbiAgICBhdmdQcmljZUNoYW5nZTogbnVtYmVyO1xyXG4gICAgYXZnUHJpY2VDaGFuZ2VQZXJjZW50OiBudW1iZXI7XHJcbiAgICBtYXhQcmljZUNoYW5nZTogbnVtYmVyO1xyXG4gICAgbWluUHJpY2VDaGFuZ2U6IG51bWJlcjtcclxuICB9O1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTFVNTiBNQVBQSU5HXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBGbGV4aWJsZSBjb2x1bW4gbmFtZSBwYXR0ZXJucyBmb3IgYXV0by1kZXRlY3Rpb25cclxuICogTWF0Y2hlcyBjb21tb24gdmFyaWF0aW9ucyAoY2FzZS1pbnNlbnNpdGl2ZSlcclxuICovXHJcbmNvbnN0IENPTFVNTl9QQVRURVJOUyA9IHtcclxuICBza3U6IFtcclxuICAgIC9ec2t1JC9pLFxyXG4gICAgL15wcm9kdWN0XFxzKmlkJC9pLFxyXG4gICAgL15wcm9kdWN0XFxzKnNrdSQvaSxcclxuICAgIC9eaXRlbVxccyppZCQvaSxcclxuICAgIC9edmFyaWFudFxccypza3UkL2ksXHJcbiAgICAvXmhhbmRsZSQvaSxcclxuICBdLFxyXG4gIG5ld1ByaWNlOiBbXHJcbiAgICAvXm5ld1xccypwcmljZSQvaSxcclxuICAgIC9ecHJpY2UkL2ksXHJcbiAgICAvXm5ld1xccypjb3N0JC9pLFxyXG4gICAgL151cGRhdGVkXFxzKnByaWNlJC9pLFxyXG4gICAgL15zZWxsXFxzKnByaWNlJC9pLFxyXG4gICAgL15zZWxsaW5nXFxzKnByaWNlJC9pLFxyXG4gIF0sXHJcbiAgY29tcGFyZUF0UHJpY2U6IFtcclxuICAgIC9eY29tcGFyZVxccyphdFxccypwcmljZSQvaSxcclxuICAgIC9eY29tcGFyZVxccypwcmljZSQvaSxcclxuICAgIC9ebXNycCQvaSxcclxuICAgIC9ebGlzdFxccypwcmljZSQvaSxcclxuICAgIC9ed2FzXFxzKnByaWNlJC9pLFxyXG4gIF0sXHJcbiAgbm90ZXM6IFtcclxuICAgIC9ebm90ZXM/JC9pLFxyXG4gICAgL15jb21tZW50cz8kL2ksXHJcbiAgICAvXnJlbWFya3M/JC9pLFxyXG4gICAgL15tZW1vJC9pLFxyXG4gIF0sXHJcbn07XHJcblxyXG4vKipcclxuICogRGV0ZWN0IGNvbHVtbiBuYW1lcyBmcm9tIGhlYWRlcnMgdXNpbmcgcGF0dGVybiBtYXRjaGluZ1xyXG4gKi9cclxuZnVuY3Rpb24gZGV0ZWN0Q29sdW1ucyhoZWFkZXJzOiBzdHJpbmdbXSk6IFBhcnNlUmVzdWx0W1wiZGV0ZWN0ZWRDb2x1bW5zXCJdIHtcclxuICBjb25zdCBkZXRlY3RlZDogUGFyc2VSZXN1bHRbXCJkZXRlY3RlZENvbHVtbnNcIl0gPSB7fTtcclxuXHJcbiAgZm9yIChjb25zdCBoZWFkZXIgb2YgaGVhZGVycykge1xyXG4gICAgY29uc3QgdHJpbW1lZEhlYWRlciA9IGhlYWRlci50cmltKCk7XHJcbiAgICBpZiAoIXRyaW1tZWRIZWFkZXIpIGNvbnRpbnVlO1xyXG5cclxuICAgIC8vIENoZWNrIGVhY2ggcGF0dGVybiBjYXRlZ29yeVxyXG4gICAgZm9yIChjb25zdCBbZmllbGROYW1lLCBwYXR0ZXJuc10gb2YgT2JqZWN0LmVudHJpZXMoQ09MVU1OX1BBVFRFUk5TKSkge1xyXG4gICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcclxuICAgICAgICBpZiAocGF0dGVybi50ZXN0KHRyaW1tZWRIZWFkZXIpKSB7XHJcbiAgICAgICAgICBkZXRlY3RlZFtmaWVsZE5hbWUgYXMga2V5b2YgdHlwZW9mIGRldGVjdGVkXSA9IHRyaW1tZWRIZWFkZXI7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGRldGVjdGVkW2ZpZWxkTmFtZSBhcyBrZXlvZiB0eXBlb2YgZGV0ZWN0ZWRdKSBicmVhaztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiBkZXRlY3RlZDtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBGSUxFIFBBUlNJTkdcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIFBhcnNlIHVwbG9hZGVkIENTViBvciBFeGNlbCBmaWxlXHJcbiAqIEF1dG8tZGV0ZWN0cyBmaWxlIHR5cGUgYW5kIGNvbHVtbiBtYXBwaW5nc1xyXG4gKlxyXG4gKiBAcGFyYW0gZmlsZSAtIEZpbGUgb2JqZWN0IGZyb20gZmlsZSBpbnB1dFxyXG4gKiBAcmV0dXJucyBQYXJzZVJlc3VsdCB3aXRoIHJvd3MgYW5kIGRldGVjdGVkIGNvbHVtbnNcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZVVwbG9hZGVkRmlsZShmaWxlOiBGaWxlKTogUHJvbWlzZTxQYXJzZVJlc3VsdD4ge1xyXG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIC8vIERldGVjdCBmaWxlIHR5cGVcclxuICAgIGNvbnN0IGZpbGVOYW1lID0gZmlsZS5uYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBpc0NTViA9IGZpbGVOYW1lLmVuZHNXaXRoKFwiLmNzdlwiKTtcclxuICAgIGNvbnN0IGlzRXhjZWwgPSBmaWxlTmFtZS5lbmRzV2l0aChcIi54bHN4XCIpIHx8IGZpbGVOYW1lLmVuZHNXaXRoKFwiLnhsc1wiKTtcclxuXHJcbiAgICBpZiAoIWlzQ1NWICYmICFpc0V4Y2VsKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgcm93czogW10sXHJcbiAgICAgICAgdG90YWxSb3dzOiAwLFxyXG4gICAgICAgIGRldGVjdGVkQ29sdW1uczoge30sXHJcbiAgICAgICAgZXJyb3JzOiBbXCJVbnN1cHBvcnRlZCBmaWxlIGZvcm1hdC4gUGxlYXNlIHVwbG9hZCBhIENTViBvciBFeGNlbCBmaWxlLlwiXSxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgcm93czogUmF3UHJpY2luZ1Jvd1tdID0gW107XHJcbiAgICBsZXQgaGVhZGVyczogc3RyaW5nW10gPSBbXTtcclxuXHJcbiAgICBpZiAoaXNDU1YpIHtcclxuICAgICAgLy8gUGFyc2UgQ1NWIHVzaW5nIHBhcGFwYXJzZVxyXG4gICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgZmlsZS50ZXh0KCk7XHJcbiAgICAgIGNvbnN0IHBhcnNlUmVzdWx0ID0gUGFwYS5wYXJzZTxSYXdQcmljaW5nUm93Pih0ZXh0LCB7XHJcbiAgICAgICAgaGVhZGVyOiB0cnVlLFxyXG4gICAgICAgIHNraXBFbXB0eUxpbmVzOiB0cnVlLFxyXG4gICAgICAgIGR5bmFtaWNUeXBpbmc6IGZhbHNlLCAvLyBLZWVwIGV2ZXJ5dGhpbmcgYXMgc3RyaW5ncyBmb3IgY29uc2lzdGVudCBoYW5kbGluZ1xyXG4gICAgICAgIHRyYW5zZm9ybUhlYWRlcjogKGhlYWRlcjogc3RyaW5nKSA9PiBoZWFkZXIudHJpbSgpLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmIChwYXJzZVJlc3VsdC5lcnJvcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHBhcnNlUmVzdWx0LmVycm9ycy5mb3JFYWNoKChlcnIpID0+IHtcclxuICAgICAgICAgIGVycm9ycy5wdXNoKGBDU1YgUGFyc2UgRXJyb3IgKFJvdyAke2Vyci5yb3d9KTogJHtlcnIubWVzc2FnZX1gKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcm93cyA9IHBhcnNlUmVzdWx0LmRhdGE7XHJcbiAgICAgIGhlYWRlcnMgPSBwYXJzZVJlc3VsdC5tZXRhLmZpZWxkcyB8fCBbXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIFBhcnNlIEV4Y2VsIHVzaW5nIHhsc3hcclxuICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBmaWxlLmFycmF5QnVmZmVyKCk7XHJcbiAgICAgIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkKGFycmF5QnVmZmVyLCB7IHR5cGU6IFwiYXJyYXlcIiB9KTtcclxuXHJcbiAgICAgIC8vIFVzZSBmaXJzdCBzaGVldFxyXG4gICAgICBjb25zdCBzaGVldE5hbWUgPSB3b3JrYm9vay5TaGVldE5hbWVzWzBdO1xyXG4gICAgICBpZiAoIXNoZWV0TmFtZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIHJvd3M6IFtdLFxyXG4gICAgICAgICAgdG90YWxSb3dzOiAwLFxyXG4gICAgICAgICAgZGV0ZWN0ZWRDb2x1bW5zOiB7fSxcclxuICAgICAgICAgIGVycm9yczogW1wiRXhjZWwgZmlsZSBoYXMgbm8gc2hlZXRzLlwiXSxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB3b3Jrc2hlZXQgPSB3b3JrYm9vay5TaGVldHNbc2hlZXROYW1lXTtcclxuICAgICAgY29uc3QganNvbkRhdGEgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb248UmF3UHJpY2luZ1Jvdz4od29ya3NoZWV0LCB7XHJcbiAgICAgICAgZGVmdmFsOiBcIlwiLFxyXG4gICAgICAgIHJhdzogZmFsc2UsIC8vIENvbnZlcnQgZXZlcnl0aGluZyB0byBzdHJpbmdzXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcm93cyA9IGpzb25EYXRhO1xyXG5cclxuICAgICAgLy8gRXh0cmFjdCBoZWFkZXJzXHJcbiAgICAgIGNvbnN0IHJhbmdlID0gWExTWC51dGlscy5kZWNvZGVfcmFuZ2Uod29ya3NoZWV0W1wiIXJlZlwiXSB8fCBcIkExXCIpO1xyXG4gICAgICBmb3IgKGxldCBjb2wgPSByYW5nZS5zLmM7IGNvbCA8PSByYW5nZS5lLmM7IGNvbCsrKSB7XHJcbiAgICAgICAgY29uc3QgY2VsbEFkZHJlc3MgPSBYTFNYLnV0aWxzLmVuY29kZV9jZWxsKHsgcjogcmFuZ2Uucy5yLCBjOiBjb2wgfSk7XHJcbiAgICAgICAgY29uc3QgY2VsbCA9IHdvcmtzaGVldFtjZWxsQWRkcmVzc107XHJcbiAgICAgICAgaWYgKGNlbGwgJiYgY2VsbC52KSB7XHJcbiAgICAgICAgICBoZWFkZXJzLnB1c2goU3RyaW5nKGNlbGwudikudHJpbSgpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBEZXRlY3QgY29sdW1uc1xyXG4gICAgY29uc3QgZGV0ZWN0ZWRDb2x1bW5zID0gZGV0ZWN0Q29sdW1ucyhoZWFkZXJzKTtcclxuXHJcbiAgICAvLyBWYWxpZGF0ZSB3ZSBoYXZlIHJlcXVpcmVkIGNvbHVtbnNcclxuICAgIGlmICghZGV0ZWN0ZWRDb2x1bW5zLnNrdSkge1xyXG4gICAgICBlcnJvcnMucHVzaChcclxuICAgICAgICBcIkNvdWxkIG5vdCBkZXRlY3QgU0tVIGNvbHVtbi4gUGxlYXNlIGVuc3VyZSB5b3VyIGZpbGUgaGFzIGEgY29sdW1uIG5hbWVkICdTS1UnLCAnUHJvZHVjdCBJRCcsIG9yICdIYW5kbGUnLlwiXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBpZiAoIWRldGVjdGVkQ29sdW1ucy5uZXdQcmljZSkge1xyXG4gICAgICBlcnJvcnMucHVzaChcclxuICAgICAgICBcIkNvdWxkIG5vdCBkZXRlY3QgcHJpY2UgY29sdW1uLiBQbGVhc2UgZW5zdXJlIHlvdXIgZmlsZSBoYXMgYSBjb2x1bW4gbmFtZWQgJ05ldyBQcmljZScgb3IgJ1ByaWNlJy5cIlxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIHJvd3M6IFtdLFxyXG4gICAgICAgIHRvdGFsUm93czogcm93cy5sZW5ndGgsXHJcbiAgICAgICAgZGV0ZWN0ZWRDb2x1bW5zLFxyXG4gICAgICAgIGVycm9ycyxcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICByb3dzLFxyXG4gICAgICB0b3RhbFJvd3M6IHJvd3MubGVuZ3RoLFxyXG4gICAgICBkZXRlY3RlZENvbHVtbnMsXHJcbiAgICAgIGVycm9yczogW10sXHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgcm93czogW10sXHJcbiAgICAgIHRvdGFsUm93czogMCxcclxuICAgICAgZGV0ZWN0ZWRDb2x1bW5zOiB7fSxcclxuICAgICAgZXJyb3JzOiBbXHJcbiAgICAgICAgYEZhaWxlZCB0byBwYXJzZSBmaWxlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCJ9YCxcclxuICAgICAgXSxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFZBTElEQVRJT05cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIENsZWFuIGFuZCBwYXJzZSBudW1lcmljIHZhbHVlIChoYW5kbGUgY3VycmVuY3kgc3ltYm9scywgY29tbWFzKVxyXG4gKi9cclxuZnVuY3Rpb24gcGFyc2VOdW1lcmljVmFsdWUodmFsdWU6IHVua25vd24pOiBudW1iZXIgfCBudWxsIHtcclxuICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gXCJcIikgcmV0dXJuIG51bGw7XHJcblxyXG4gIGNvbnN0IHN0ciA9IFN0cmluZyh2YWx1ZSlcclxuICAgIC5yZXBsYWNlKC9bJCxdL2csIFwiXCIpXHJcbiAgICAudHJpbSgpO1xyXG5cclxuICBjb25zdCBudW0gPSBwYXJzZUZsb2F0KHN0cik7XHJcbiAgcmV0dXJuIGlzTmFOKG51bSkgPyBudWxsIDogbnVtO1xyXG59XHJcblxyXG4vKipcclxuICogTm9ybWFsaXplIFNLVSBmb3IgbWF0Y2hpbmcgKHVwcGVyY2FzZSwgdHJpbSwgcmVtb3ZlIHNwZWNpYWwgY2hhcnMpXHJcbiAqL1xyXG5mdW5jdGlvbiBub3JtYWxpemVTa3Uoc2t1OiB1bmtub3duKTogc3RyaW5nIHtcclxuICBpZiAoIXNrdSB8fCBTdHJpbmcoc2t1KS50cmltKCkgPT09IFwiXCIpIHJldHVybiBcIlwiO1xyXG4gIHJldHVybiBTdHJpbmcoc2t1KS50cmltKCkudG9VcHBlckNhc2UoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIHByaWNpbmcgZGF0YSBhZ2FpbnN0IFNob3BpZnkgcHJvZHVjdCBkYXRhXHJcbiAqXHJcbiAqIEBwYXJhbSByb3dzIC0gUmF3IHJvd3MgZnJvbSBwYXJzZWQgZmlsZVxyXG4gKiBAcGFyYW0gZGV0ZWN0ZWRDb2x1bW5zIC0gQ29sdW1uIG1hcHBpbmdzIGZyb20gZGV0ZWN0aW9uXHJcbiAqIEBwYXJhbSBzaG9waWZ5RGF0YSAtIE1hcCBvZiBTS1UgdG8gcHJvZHVjdCBkYXRhXHJcbiAqIEBwYXJhbSBsYXJnZVByaWNlQ2hhbmdlVGhyZXNob2xkIC0gVGhyZXNob2xkIGZvciBmbGFnZ2luZyBsYXJnZSBjaGFuZ2VzIChkZWZhdWx0IDAuNSA9IDUwJSlcclxuICogQHJldHVybnMgVmFsaWRhdGlvblJlc3VsdCB3aXRoIHZhbGlkIHJvd3MgYW5kIGVycm9yc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlUHJpY2luZ0RhdGEoXHJcbiAgcm93czogUmF3UHJpY2luZ1Jvd1tdLFxyXG4gIGRldGVjdGVkQ29sdW1uczogUGFyc2VSZXN1bHRbXCJkZXRlY3RlZENvbHVtbnNcIl0sXHJcbiAgc2hvcGlmeURhdGE6IE1hcDxzdHJpbmcsIFByb2R1Y3REYXRhPixcclxuICBsYXJnZVByaWNlQ2hhbmdlVGhyZXNob2xkOiBudW1iZXIgPSAwLjVcclxuKTogVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgY29uc3QgdmFsaWRSb3dzOiBWYWxpZFByaWNpbmdSb3dbXSA9IFtdO1xyXG4gIGNvbnN0IGVycm9yczogVmFsaWRhdGlvbkVycm9yW10gPSBbXTtcclxuICBjb25zdCB3YXJuaW5nczogVmFsaWRhdGlvbkVycm9yW10gPSBbXTtcclxuXHJcbiAgY29uc3Qgc2VlblNrdXMgPSBuZXcgU2V0PHN0cmluZz4oKTtcclxuICBjb25zdCBkdXBsaWNhdGVTa3VzID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbiAgbGV0IHNrdU5vdEZvdW5kQ291bnQgPSAwO1xyXG4gIGxldCBsYXJnZVByaWNlQ2hhbmdlQ291bnQgPSAwO1xyXG5cclxuICBjb25zdCBza3VDb2wgPSBkZXRlY3RlZENvbHVtbnMuc2t1ITtcclxuICBjb25zdCBwcmljZUNvbCA9IGRldGVjdGVkQ29sdW1ucy5uZXdQcmljZSE7XHJcbiAgY29uc3QgY29tcGFyZUNvbCA9IGRldGVjdGVkQ29sdW1ucy5jb21wYXJlQXRQcmljZTtcclxuICBjb25zdCBub3Rlc0NvbCA9IGRldGVjdGVkQ29sdW1ucy5ub3RlcztcclxuXHJcbiAgcm93cy5mb3JFYWNoKChyb3csIGluZGV4KSA9PiB7XHJcbiAgICBjb25zdCByb3dOdW1iZXIgPSBpbmRleCArIDI7IC8vICsyIGJlY2F1c2U6IDAtaW5kZXhlZCArIDEgaGVhZGVyIHJvdyArIDEgZm9yIGh1bWFuLXJlYWRhYmxlXHJcblxyXG4gICAgLy8gRXh0cmFjdCBhbmQgbm9ybWFsaXplIFNLVVxyXG4gICAgY29uc3QgcmF3U2t1ID0gcm93W3NrdUNvbF07XHJcbiAgICBjb25zdCBza3UgPSBub3JtYWxpemVTa3UocmF3U2t1KTtcclxuXHJcbiAgICAvLyBWYWxpZGF0aW9uIDE6IFJlcXVpcmVkIGZpZWxkIC0gU0tVXHJcbiAgICBpZiAoIXNrdSkge1xyXG4gICAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgICAgcm93TnVtYmVyLFxyXG4gICAgICAgIHNrdTogU3RyaW5nKHJhd1NrdSB8fCBcIlwiKSxcclxuICAgICAgICBmaWVsZDogc2t1Q29sLFxyXG4gICAgICAgIG1lc3NhZ2U6IFwiU0tVIGlzIHJlcXVpcmVkXCIsXHJcbiAgICAgICAgc2V2ZXJpdHk6IFwiZXJyb3JcIixcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybjsgLy8gU2tpcCB0aGlzIHJvd1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZhbGlkYXRpb24gMjogRHVwbGljYXRlIFNLVSBpbiBmaWxlXHJcbiAgICBpZiAoc2VlblNrdXMuaGFzKHNrdSkpIHtcclxuICAgICAgZHVwbGljYXRlU2t1cy5hZGQoc2t1KTtcclxuICAgICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICAgIHJvd051bWJlcixcclxuICAgICAgICBza3UsXHJcbiAgICAgICAgZmllbGQ6IHNrdUNvbCxcclxuICAgICAgICBtZXNzYWdlOiBgRHVwbGljYXRlIFNLVSBmb3VuZCBpbiBmaWxlIChmaXJzdCBvY2N1cnJlbmNlIHByb2Nlc3NlZClgLFxyXG4gICAgICAgIHNldmVyaXR5OiBcImVycm9yXCIsXHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm47IC8vIFNraXAgZHVwbGljYXRlc1xyXG4gICAgfVxyXG4gICAgc2VlblNrdXMuYWRkKHNrdSk7XHJcblxyXG4gICAgLy8gVmFsaWRhdGlvbiAzOiBSZXF1aXJlZCBmaWVsZCAtIE5ldyBQcmljZVxyXG4gICAgY29uc3QgbmV3UHJpY2UgPSBwYXJzZU51bWVyaWNWYWx1ZShyb3dbcHJpY2VDb2xdKTtcclxuICAgIGlmIChuZXdQcmljZSA9PT0gbnVsbCkge1xyXG4gICAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgICAgcm93TnVtYmVyLFxyXG4gICAgICAgIHNrdSxcclxuICAgICAgICBmaWVsZDogcHJpY2VDb2wsXHJcbiAgICAgICAgbWVzc2FnZTogXCJOZXcgUHJpY2UgaXMgcmVxdWlyZWQgYW5kIG11c3QgYmUgYSB2YWxpZCBudW1iZXJcIixcclxuICAgICAgICBzZXZlcml0eTogXCJlcnJvclwiLFxyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZhbGlkYXRpb24gNDogUHJpY2UgbXVzdCBiZSBwb3NpdGl2ZVxyXG4gICAgaWYgKG5ld1ByaWNlIDw9IDApIHtcclxuICAgICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICAgIHJvd051bWJlcixcclxuICAgICAgICBza3UsXHJcbiAgICAgICAgZmllbGQ6IHByaWNlQ29sLFxyXG4gICAgICAgIG1lc3NhZ2U6IFwiTmV3IFByaWNlIG11c3QgYmUgZ3JlYXRlciB0aGFuIDBcIixcclxuICAgICAgICBzZXZlcml0eTogXCJlcnJvclwiLFxyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZhbGlkYXRpb24gNTogU0tVIGV4aXN0cyBpbiBTaG9waWZ5XHJcbiAgICBjb25zdCBwcm9kdWN0RGF0YSA9IHNob3BpZnlEYXRhLmdldChza3UpO1xyXG4gICAgaWYgKCFwcm9kdWN0RGF0YSkge1xyXG4gICAgICBza3VOb3RGb3VuZENvdW50Kys7XHJcbiAgICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgICByb3dOdW1iZXIsXHJcbiAgICAgICAgc2t1LFxyXG4gICAgICAgIGZpZWxkOiBza3VDb2wsXHJcbiAgICAgICAgbWVzc2FnZTogXCJTS1Ugbm90IGZvdW5kIGluIFNob3BpZnkgcHJvZHVjdHNcIixcclxuICAgICAgICBzZXZlcml0eTogXCJlcnJvclwiLFxyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZhbGlkYXRpb24gNjogQ2hlY2sgZm9yIGxhcmdlIHByaWNlIGNoYW5nZXMgKHdhcm5pbmcgb25seSlcclxuICAgIGNvbnN0IGN1cnJlbnRQcmljZSA9IHByb2R1Y3REYXRhLmN1cnJlbnRQcmljZTtcclxuICAgIGlmIChjdXJyZW50UHJpY2UgPiAwKSB7XHJcbiAgICAgIGNvbnN0IGNoYW5nZVBlcmNlbnQgPSBNYXRoLmFicygobmV3UHJpY2UgLSBjdXJyZW50UHJpY2UpIC8gY3VycmVudFByaWNlKTtcclxuICAgICAgaWYgKGNoYW5nZVBlcmNlbnQgPiBsYXJnZVByaWNlQ2hhbmdlVGhyZXNob2xkKSB7XHJcbiAgICAgICAgbGFyZ2VQcmljZUNoYW5nZUNvdW50Kys7XHJcbiAgICAgICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgICAgICByb3dOdW1iZXIsXHJcbiAgICAgICAgICBza3UsXHJcbiAgICAgICAgICBmaWVsZDogcHJpY2VDb2wsXHJcbiAgICAgICAgICBtZXNzYWdlOiBgTGFyZ2UgcHJpY2UgY2hhbmdlOiAkeygoY2hhbmdlUGVyY2VudCkgKiAxMDApLnRvRml4ZWQoMSl9JSAoZnJvbSAkJHtjdXJyZW50UHJpY2UudG9GaXhlZCgyKX0gdG8gJCR7bmV3UHJpY2UudG9GaXhlZCgyKX0pYCxcclxuICAgICAgICAgIHNldmVyaXR5OiBcIndhcm5pbmdcIixcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFBhcnNlIG9wdGlvbmFsIGZpZWxkc1xyXG4gICAgY29uc3QgY29tcGFyZUF0UHJpY2UgPSBjb21wYXJlQ29sID8gcGFyc2VOdW1lcmljVmFsdWUocm93W2NvbXBhcmVDb2xdKSA6IHVuZGVmaW5lZDtcclxuICAgIGNvbnN0IG5vdGVzID0gbm90ZXNDb2wgPyBTdHJpbmcocm93W25vdGVzQ29sXSB8fCBcIlwiKS50cmltKCkgOiB1bmRlZmluZWQ7XHJcblxyXG4gICAgLy8gUm93IGlzIHZhbGlkXHJcbiAgICB2YWxpZFJvd3MucHVzaCh7XHJcbiAgICAgIHNrdSxcclxuICAgICAgbmV3UHJpY2UsXHJcbiAgICAgIGNvbXBhcmVBdFByaWNlLFxyXG4gICAgICBub3RlcyxcclxuICAgICAgcm93TnVtYmVyLFxyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBzdWNjZXNzOiBlcnJvcnMubGVuZ3RoID09PSAwLFxyXG4gICAgdmFsaWRSb3dzLFxyXG4gICAgZXJyb3JzLFxyXG4gICAgd2FybmluZ3MsXHJcbiAgICBzdW1tYXJ5OiB7XHJcbiAgICAgIHRvdGFsUm93czogcm93cy5sZW5ndGgsXHJcbiAgICAgIHZhbGlkUm93czogdmFsaWRSb3dzLmxlbmd0aCxcclxuICAgICAgZXJyb3JSb3dzOiBlcnJvcnMuZmlsdGVyKChlKSA9PiBlLnNldmVyaXR5ID09PSBcImVycm9yXCIpLmxlbmd0aCxcclxuICAgICAgd2FybmluZ1Jvd3M6IHdhcm5pbmdzLmxlbmd0aCxcclxuICAgICAgZHVwbGljYXRlU2t1czogZHVwbGljYXRlU2t1cy5zaXplLFxyXG4gICAgICBza3VOb3RGb3VuZDogc2t1Tm90Rm91bmRDb3VudCxcclxuICAgICAgbGFyZ2VQcmljZUNoYW5nZXM6IGxhcmdlUHJpY2VDaGFuZ2VDb3VudCxcclxuICAgIH0sXHJcbiAgfTtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBCVUlMRCBSRUNPUkRTXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBCdWlsZCBwcmljZSB1cGRhdGUgcmVjb3JkcyBmcm9tIHZhbGlkYXRlZCByb3dzXHJcbiAqIEVucmljaGVzIHdpdGggcHJvZHVjdCBkYXRhIGFuZCBjYWxjdWxhdGVzIHByaWNlIGNoYW5nZXNcclxuICpcclxuICogQHBhcmFtIHZhbGlkUm93cyAtIFZhbGlkYXRlZCByb3dzIHJlYWR5IGZvciBwcm9jZXNzaW5nXHJcbiAqIEBwYXJhbSBzaG9waWZ5RGF0YSAtIE1hcCBvZiBTS1UgdG8gcHJvZHVjdCBkYXRhXHJcbiAqIEByZXR1cm5zIEFycmF5IG9mIGNvbXBsZXRlIHByaWNlIHVwZGF0ZSByZWNvcmRzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRQcmljZVVwZGF0ZVJlY29yZHMoXHJcbiAgdmFsaWRSb3dzOiBWYWxpZFByaWNpbmdSb3dbXSxcclxuICBzaG9waWZ5RGF0YTogTWFwPHN0cmluZywgUHJvZHVjdERhdGE+XHJcbik6IFByaWNlVXBkYXRlUmVjb3JkW10ge1xyXG4gIGNvbnN0IHJlY29yZHM6IFByaWNlVXBkYXRlUmVjb3JkW10gPSBbXTtcclxuXHJcbiAgZm9yIChjb25zdCByb3cgb2YgdmFsaWRSb3dzKSB7XHJcbiAgICBjb25zdCBwcm9kdWN0RGF0YSA9IHNob3BpZnlEYXRhLmdldChyb3cuc2t1KTtcclxuICAgIGlmICghcHJvZHVjdERhdGEpIHtcclxuICAgICAgLy8gU2hvdWxkIG5vdCBoYXBwZW4gYWZ0ZXIgdmFsaWRhdGlvbiwgYnV0IGRlZmVuc2l2ZSBjaGVja1xyXG4gICAgICBjb25zb2xlLndhcm4oYFNraXBwaW5nIFNLVSAke3Jvdy5za3V9IC0gbm90IGZvdW5kIGluIFNob3BpZnkgZGF0YWApO1xyXG4gICAgICBjb250aW51ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgcHJpY2UgY2hhbmdlc1xyXG4gICAgY29uc3QgcHJpY2VDaGFuZ2UgPSByb3cubmV3UHJpY2UgLSBwcm9kdWN0RGF0YS5jdXJyZW50UHJpY2U7XHJcbiAgICBjb25zdCBwcmljZUNoYW5nZVBlcmNlbnQgPVxyXG4gICAgICBwcm9kdWN0RGF0YS5jdXJyZW50UHJpY2UgPiAwXHJcbiAgICAgICAgPyAocHJpY2VDaGFuZ2UgLyBwcm9kdWN0RGF0YS5jdXJyZW50UHJpY2UpXHJcbiAgICAgICAgOiAwO1xyXG5cclxuICAgIC8vIERldGVybWluZSBuZXcgY29tcGFyZSBhdCBwcmljZVxyXG4gICAgbGV0IG5ld0NvbXBhcmVBdFByaWNlID0gcHJvZHVjdERhdGEuY29tcGFyZUF0UHJpY2U7XHJcbiAgICBpZiAocm93LmNvbXBhcmVBdFByaWNlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgbmV3Q29tcGFyZUF0UHJpY2UgPSByb3cuY29tcGFyZUF0UHJpY2UgPiAwID8gcm93LmNvbXBhcmVBdFByaWNlIDogbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICByZWNvcmRzLnB1c2goe1xyXG4gICAgICBza3U6IHJvdy5za3UsXHJcbiAgICAgIHZhcmlhbnRJZDogcHJvZHVjdERhdGEudmFyaWFudElkLFxyXG4gICAgICBwcm9kdWN0SWQ6IHByb2R1Y3REYXRhLnByb2R1Y3RJZCxcclxuICAgICAgcHJvZHVjdFRpdGxlOiBwcm9kdWN0RGF0YS5wcm9kdWN0VGl0bGUsXHJcbiAgICAgIHZhcmlhbnRUaXRsZTogcHJvZHVjdERhdGEudmFyaWFudFRpdGxlLFxyXG4gICAgICBoYW5kbGU6IHByb2R1Y3REYXRhLmhhbmRsZSxcclxuICAgICAgY3VycmVudFByaWNlOiBwcm9kdWN0RGF0YS5jdXJyZW50UHJpY2UsXHJcbiAgICAgIG5ld1ByaWNlOiByb3cubmV3UHJpY2UsXHJcbiAgICAgIHByaWNlQ2hhbmdlLFxyXG4gICAgICBwcmljZUNoYW5nZVBlcmNlbnQsXHJcbiAgICAgIGNvbXBhcmVBdFByaWNlOiBwcm9kdWN0RGF0YS5jb21wYXJlQXRQcmljZSxcclxuICAgICAgbmV3Q29tcGFyZUF0UHJpY2UsXHJcbiAgICAgIG5vdGVzOiByb3cubm90ZXMsXHJcbiAgICAgIHJvd051bWJlcjogcm93LnJvd051bWJlcixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJlY29yZHM7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ09NUExFVEUgUFJPQ0VTU0lORyBQSVBFTElORVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQ29tcGxldGUgcHJvY2Vzc2luZyBwaXBlbGluZTogcGFyc2UsIHZhbGlkYXRlLCBhbmQgYnVpbGQgcmVjb3Jkc1xyXG4gKlxyXG4gKiBAcGFyYW0gZmlsZSAtIFVwbG9hZGVkIENTViBvciBFeGNlbCBmaWxlXHJcbiAqIEBwYXJhbSBzaG9waWZ5RGF0YSAtIE1hcCBvZiBTS1UgdG8gcHJvZHVjdCBkYXRhIGZyb20gU2hvcGlmeVxyXG4gKiBAcGFyYW0gbGFyZ2VQcmljZUNoYW5nZVRocmVzaG9sZCAtIFRocmVzaG9sZCBmb3Igd2FybmluZyBvbiBsYXJnZSBjaGFuZ2VzIChkZWZhdWx0IDAuNSA9IDUwJSlcclxuICogQHJldHVybnMgQ29tcGxldGUgcHJpY2luZyBwcm9jZXNzb3IgcmVzdWx0XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1ByaWNpbmdGaWxlKFxyXG4gIGZpbGU6IEZpbGUsXHJcbiAgc2hvcGlmeURhdGE6IE1hcDxzdHJpbmcsIFByb2R1Y3REYXRhPixcclxuICBsYXJnZVByaWNlQ2hhbmdlVGhyZXNob2xkOiBudW1iZXIgPSAwLjVcclxuKTogUHJvbWlzZTxQcmljaW5nUHJvY2Vzc29yUmVzdWx0PiB7XHJcbiAgLy8gU3RlcCAxOiBQYXJzZSBmaWxlXHJcbiAgY29uc3QgcGFyc2VSZXN1bHQgPSBhd2FpdCBwYXJzZVVwbG9hZGVkRmlsZShmaWxlKTtcclxuICBpZiAoIXBhcnNlUmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICByZWNvcmRzOiBbXSxcclxuICAgICAgdmFsaWRhdGlvbjoge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIHZhbGlkUm93czogW10sXHJcbiAgICAgICAgZXJyb3JzOiBwYXJzZVJlc3VsdC5lcnJvcnMubWFwKChtc2csIGkpID0+ICh7XHJcbiAgICAgICAgICByb3dOdW1iZXI6IDAsXHJcbiAgICAgICAgICBza3U6IFwiXCIsXHJcbiAgICAgICAgICBmaWVsZDogXCJmaWxlXCIsXHJcbiAgICAgICAgICBtZXNzYWdlOiBtc2csXHJcbiAgICAgICAgICBzZXZlcml0eTogXCJlcnJvclwiLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgICB3YXJuaW5nczogW10sXHJcbiAgICAgICAgc3VtbWFyeToge1xyXG4gICAgICAgICAgdG90YWxSb3dzOiAwLFxyXG4gICAgICAgICAgdmFsaWRSb3dzOiAwLFxyXG4gICAgICAgICAgZXJyb3JSb3dzOiBwYXJzZVJlc3VsdC5lcnJvcnMubGVuZ3RoLFxyXG4gICAgICAgICAgd2FybmluZ1Jvd3M6IDAsXHJcbiAgICAgICAgICBkdXBsaWNhdGVTa3VzOiAwLFxyXG4gICAgICAgICAgc2t1Tm90Rm91bmQ6IDAsXHJcbiAgICAgICAgICBsYXJnZVByaWNlQ2hhbmdlczogMCxcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBzdW1tYXJ5OiB7XHJcbiAgICAgICAgdG90YWxSZWNvcmRzOiAwLFxyXG4gICAgICAgIHRvdGFsUHJpY2VJbmNyZWFzZTogMCxcclxuICAgICAgICB0b3RhbFByaWNlRGVjcmVhc2U6IDAsXHJcbiAgICAgICAgYXZnUHJpY2VDaGFuZ2U6IDAsXHJcbiAgICAgICAgYXZnUHJpY2VDaGFuZ2VQZXJjZW50OiAwLFxyXG4gICAgICAgIG1heFByaWNlQ2hhbmdlOiAwLFxyXG4gICAgICAgIG1pblByaWNlQ2hhbmdlOiAwLFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vIFN0ZXAgMjogVmFsaWRhdGUgcm93c1xyXG4gIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSB2YWxpZGF0ZVByaWNpbmdEYXRhKFxyXG4gICAgcGFyc2VSZXN1bHQucm93cyxcclxuICAgIHBhcnNlUmVzdWx0LmRldGVjdGVkQ29sdW1ucyxcclxuICAgIHNob3BpZnlEYXRhLFxyXG4gICAgbGFyZ2VQcmljZUNoYW5nZVRocmVzaG9sZFxyXG4gICk7XHJcblxyXG4gIC8vIFN0ZXAgMzogQnVpbGQgcmVjb3JkcyBmcm9tIHZhbGlkIHJvd3NcclxuICBjb25zdCByZWNvcmRzID0gYnVpbGRQcmljZVVwZGF0ZVJlY29yZHMoXHJcbiAgICB2YWxpZGF0aW9uUmVzdWx0LnZhbGlkUm93cyxcclxuICAgIHNob3BpZnlEYXRhXHJcbiAgKTtcclxuXHJcbiAgLy8gU3RlcCA0OiBDYWxjdWxhdGUgc3VtbWFyeSBzdGF0aXN0aWNzXHJcbiAgbGV0IHRvdGFsUHJpY2VJbmNyZWFzZSA9IDA7XHJcbiAgbGV0IHRvdGFsUHJpY2VEZWNyZWFzZSA9IDA7XHJcbiAgbGV0IHRvdGFsUHJpY2VDaGFuZ2UgPSAwO1xyXG4gIGxldCB0b3RhbFByaWNlQ2hhbmdlUGVyY2VudCA9IDA7XHJcbiAgbGV0IG1heFByaWNlQ2hhbmdlID0gMDtcclxuICBsZXQgbWluUHJpY2VDaGFuZ2UgPSAwO1xyXG5cclxuICByZWNvcmRzLmZvckVhY2goKHJlY29yZCkgPT4ge1xyXG4gICAgY29uc3QgY2hhbmdlID0gcmVjb3JkLnByaWNlQ2hhbmdlO1xyXG4gICAgdG90YWxQcmljZUNoYW5nZSArPSBjaGFuZ2U7XHJcbiAgICB0b3RhbFByaWNlQ2hhbmdlUGVyY2VudCArPSByZWNvcmQucHJpY2VDaGFuZ2VQZXJjZW50O1xyXG5cclxuICAgIGlmIChjaGFuZ2UgPiAwKSB7XHJcbiAgICAgIHRvdGFsUHJpY2VJbmNyZWFzZSArPSBjaGFuZ2U7XHJcbiAgICB9IGVsc2UgaWYgKGNoYW5nZSA8IDApIHtcclxuICAgICAgdG90YWxQcmljZURlY3JlYXNlICs9IE1hdGguYWJzKGNoYW5nZSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGNoYW5nZSA+IG1heFByaWNlQ2hhbmdlKSBtYXhQcmljZUNoYW5nZSA9IGNoYW5nZTtcclxuICAgIGlmIChjaGFuZ2UgPCBtaW5QcmljZUNoYW5nZSkgbWluUHJpY2VDaGFuZ2UgPSBjaGFuZ2U7XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGF2Z1ByaWNlQ2hhbmdlID0gcmVjb3Jkcy5sZW5ndGggPiAwID8gdG90YWxQcmljZUNoYW5nZSAvIHJlY29yZHMubGVuZ3RoIDogMDtcclxuICBjb25zdCBhdmdQcmljZUNoYW5nZVBlcmNlbnQgPVxyXG4gICAgcmVjb3Jkcy5sZW5ndGggPiAwID8gdG90YWxQcmljZUNoYW5nZVBlcmNlbnQgLyByZWNvcmRzLmxlbmd0aCA6IDA7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBzdWNjZXNzOiB2YWxpZGF0aW9uUmVzdWx0LnN1Y2Nlc3MgJiYgcmVjb3Jkcy5sZW5ndGggPiAwLFxyXG4gICAgcmVjb3JkcyxcclxuICAgIHZhbGlkYXRpb246IHZhbGlkYXRpb25SZXN1bHQsXHJcbiAgICBzdW1tYXJ5OiB7XHJcbiAgICAgIHRvdGFsUmVjb3JkczogcmVjb3Jkcy5sZW5ndGgsXHJcbiAgICAgIHRvdGFsUHJpY2VJbmNyZWFzZSxcclxuICAgICAgdG90YWxQcmljZURlY3JlYXNlLFxyXG4gICAgICBhdmdQcmljZUNoYW5nZSxcclxuICAgICAgYXZnUHJpY2VDaGFuZ2VQZXJjZW50LFxyXG4gICAgICBtYXhQcmljZUNoYW5nZSxcclxuICAgICAgbWluUHJpY2VDaGFuZ2UsXHJcbiAgICB9LFxyXG4gIH07XHJcbn1cclxuIl0sIm1hcHBpbmdzIjoiQUFrQkEsT0FBTyxVQUFVO0FBQ2pCLFlBQVksVUFBVTtBQW1JdEIsTUFBTSxrQkFBa0I7QUFBQSxFQUN0QixLQUFLO0FBQUEsSUFDSDtBQUFB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