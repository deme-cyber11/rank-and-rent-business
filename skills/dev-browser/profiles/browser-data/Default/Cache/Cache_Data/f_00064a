import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/components/profit-loss/expense-category.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=9303f522"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = RefreshRuntime.getRefreshReg("C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx");
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
"use client";
var _s = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=9303f522"; const useState = __vite__cjsImport3_react["useState"];
import { ChevronDown, ChevronRight } from "/node_modules/.vite/deps/lucide-react.js?v=9303f522";
import { cn } from "/src/lib/utils.ts";
import { formatCurrency, formatPercent } from "/src/lib/data/profit-loss.ts";
export function ExpenseCategory({
  categoryName,
  subcategory,
  lineItems,
  netSales,
  defaultExpanded = false
}) {
  _s();
  const [isExpanded, setIsExpanded] = useState(defaultExpanded);
  const categoryTotal = lineItems.reduce((sum, item) => sum + item.amount, 0);
  const categoryPercent = netSales > 0 ? categoryTotal / netSales * 100 : 0;
  const sortedItems = [...lineItems].sort((a, b) => a.line_item_order - b.line_item_order);
  return /* @__PURE__ */ jsxDEV("div", { className: "border-b border-border/50 last:border-b-0", children: [
    /* @__PURE__ */ jsxDEV(
      "button",
      {
        onClick: () => setIsExpanded(!isExpanded),
        className: "flex w-full items-center justify-between px-4 py-3 text-left transition-colors hover:bg-muted/40",
        children: [
          /* @__PURE__ */ jsxDEV("div", { className: "flex items-center gap-2", children: [
            isExpanded ? /* @__PURE__ */ jsxDEV(ChevronDown, { className: "h-4 w-4 text-muted-foreground" }, void 0, false, {
              fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
              lineNumber: 61,
              columnNumber: 11
            }, this) : /* @__PURE__ */ jsxDEV(ChevronRight, { className: "h-4 w-4 text-muted-foreground" }, void 0, false, {
              fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
              lineNumber: 63,
              columnNumber: 11
            }, this),
            /* @__PURE__ */ jsxDEV("span", { className: "font-medium text-foreground", children: categoryName }, void 0, false, {
              fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
              lineNumber: 65,
              columnNumber: 11
            }, this)
          ] }, void 0, true, {
            fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
            lineNumber: 59,
            columnNumber: 9
          }, this),
          /* @__PURE__ */ jsxDEV("div", { className: "flex items-center gap-6", children: [
            /* @__PURE__ */ jsxDEV("span", { className: "font-semibold text-foreground", children: formatCurrency(categoryTotal) }, void 0, false, {
              fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
              lineNumber: 68,
              columnNumber: 11
            }, this),
            /* @__PURE__ */ jsxDEV("span", { className: "w-16 text-right text-sm text-muted-foreground", children: formatPercent(categoryPercent) }, void 0, false, {
              fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
              lineNumber: 71,
              columnNumber: 11
            }, this)
          ] }, void 0, true, {
            fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
            lineNumber: 67,
            columnNumber: 9
          }, this)
        ]
      },
      void 0,
      true,
      {
        fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
        lineNumber: 55,
        columnNumber: 7
      },
      this
    ),
    isExpanded && /* @__PURE__ */ jsxDEV("div", { className: "bg-muted/20", children: sortedItems.map((item) => {
      const itemPercent = netSales > 0 ? item.amount / netSales * 100 : 0;
      return /* @__PURE__ */ jsxDEV(
        "div",
        {
          className: "flex items-center justify-between border-t border-border/30 px-4 py-2.5 pl-12",
          children: [
            /* @__PURE__ */ jsxDEV("span", { className: "text-sm text-muted-foreground", children: item.line_item_name }, void 0, false, {
              fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
              lineNumber: 87,
              columnNumber: 17
            }, this),
            /* @__PURE__ */ jsxDEV("div", { className: "flex items-center gap-6", children: [
              /* @__PURE__ */ jsxDEV("span", { className: "text-sm text-foreground", children: formatCurrency(item.amount) }, void 0, false, {
                fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
                lineNumber: 89,
                columnNumber: 19
              }, this),
              /* @__PURE__ */ jsxDEV("span", { className: "w-16 text-right text-sm text-muted-foreground", children: formatPercent(itemPercent) }, void 0, false, {
                fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
                lineNumber: 92,
                columnNumber: 19
              }, this)
            ] }, void 0, true, {
              fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
              lineNumber: 88,
              columnNumber: 17
            }, this)
          ]
        },
        item.id,
        true,
        {
          fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
          lineNumber: 83,
          columnNumber: 13
        },
        this
      );
    }) }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
      lineNumber: 79,
      columnNumber: 7
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
    lineNumber: 53,
    columnNumber: 5
  }, this);
}
_s(ExpenseCategory, "hXm97mhk9SycwrMiz/XacDFEqLM=");
_c = ExpenseCategory;
export function ExpenseCategoriesGroup({
  lineItems,
  netSales,
  className
}) {
  const subcategories = lineItems.reduce(
    (acc, item) => {
      const subcat = item.subcategory || "Other";
      if (!acc[subcat]) {
        acc[subcat] = [];
      }
      acc[subcat].push(item);
      return acc;
    },
    {}
  );
  const subcategoryOrder = {
    sales_marketing: { name: "Sales & Marketing", order: 1 },
    operations: { name: "Operations", order: 2 },
    personnel: { name: "Personnel", order: 3 },
    administrative: { name: "Administrative", order: 4 },
    other_expenses: { name: "Other Expenses", order: 5 },
    Other: { name: "Other", order: 6 }
  };
  const sortedSubcategories = Object.entries(subcategories).sort((a, b) => {
    const orderA = subcategoryOrder[a[0]]?.order || 999;
    const orderB = subcategoryOrder[b[0]]?.order || 999;
    return orderA - orderB;
  });
  return /* @__PURE__ */ jsxDEV("div", { className: cn("rounded-lg border border-border bg-card", className), children: sortedSubcategories.map(
    ([subcategory, items]) => /* @__PURE__ */ jsxDEV(
      ExpenseCategory,
      {
        categoryName: subcategoryOrder[subcategory]?.name || subcategory,
        subcategory,
        lineItems: items,
        netSales
      },
      subcategory,
      false,
      {
        fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
        lineNumber: 149,
        columnNumber: 7
      },
      this
    )
  ) }, void 0, false, {
    fileName: "C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx",
    lineNumber: 147,
    columnNumber: 5
  }, this);
}
_c2 = ExpenseCategoriesGroup;
var _c, _c2;
$RefreshReg$(_c, "ExpenseCategory");
$RefreshReg$(_c2, "ExpenseCategoriesGroup");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/Projects/Source 4 Industries/src/components/profit-loss/expense-category.tsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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QVMsR0FDcEVjLDhCQUFvQnBCO0FBQUFBLElBQUksQ0FBQyxDQUFDakIsYUFBYTBDLEtBQUssTUFDM0M7QUFBQSxNQUFDO0FBQUE7QUFBQSxRQUVDLGNBQWNkLGlCQUFpQjVCLFdBQVcsR0FBRzhCLFFBQVE5QjtBQUFBQSxRQUNyRDtBQUFBLFFBQ0EsV0FBVzBDO0FBQUFBLFFBQ1g7QUFBQTtBQUFBLE1BSksxQztBQUFBQSxNQURQO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFLcUI7QUFBQSxFQUV0QixLQVRIO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0FVQTtBQUVKO0FBQUMyQyxNQWhEZXJCO0FBQXNCLElBQUFELElBQUFzQjtBQUFBQyxhQUFBdkIsSUFBQTtBQUFBdUIsYUFBQUQsS0FBQSIsIm5hbWVzIjpbIl9zIiwiJFJlZnJlc2hTaWckIiwidXNlU3RhdGUiLCJDaGV2cm9uRG93biIsIkNoZXZyb25SaWdodCIsImNuIiwiZm9ybWF0Q3VycmVuY3kiLCJmb3JtYXRQZXJjZW50IiwiRXhwZW5zZUNhdGVnb3J5IiwiY2F0ZWdvcnlOYW1lIiwic3ViY2F0ZWdvcnkiLCJsaW5lSXRlbXMiLCJuZXRTYWxlcyIsImRlZmF1bHRFeHBhbmRlZCIsImlzRXhwYW5kZWQiLCJzZXRJc0V4cGFuZGVkIiwiY2F0ZWdvcnlUb3RhbCIsInJlZHVjZSIsInN1bSIsIml0ZW0iLCJhbW91bnQiLCJjYXRlZ29yeVBlcmNlbnQiLCJzb3J0ZWRJdGVtcyIsInNvcnQiLCJhIiwiYiIsImxpbmVfaXRlbV9vcmRlciIsIm1hcCIsIml0ZW1QZXJjZW50IiwibGluZV9pdGVtX25hbWUiLCJpZCIsIl9jIiwiRXhwZW5zZUNhdGVnb3JpZXNHcm91cCIsImNsYXNzTmFtZSIsInN1YmNhdGVnb3JpZXMiLCJhY2MiLCJzdWJjYXQiLCJwdXNoIiwic3ViY2F0ZWdvcnlPcmRlciIsInNhbGVzX21hcmtldGluZyIsIm5hbWUiLCJvcmRlciIsIm9wZXJhdGlvbnMiLCJwZXJzb25uZWwiLCJhZG1pbmlzdHJhdGl2ZSIsIm90aGVyX2V4cGVuc2VzIiwiT3RoZXIiLCJzb3J0ZWRTdWJjYXRlZ29yaWVzIiwiT2JqZWN0IiwiZW50cmllcyIsIm9yZGVyQSIsIm9yZGVyQiIsIml0ZW1zIiwiX2MyIiwiJFJlZnJlc2hSZWckIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbImV4cGVuc2UtY2F0ZWdvcnkudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIGNsaWVudFwiO1xyXG5cclxuaW1wb3J0IHsgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHsgQ2hldnJvbkRvd24sIENoZXZyb25SaWdodCB9IGZyb20gXCJsdWNpZGUtcmVhY3RcIjtcclxuaW1wb3J0IHsgY24gfSBmcm9tIFwiQC9saWIvdXRpbHNcIjtcclxuaW1wb3J0IHsgZm9ybWF0Q3VycmVuY3ksIGZvcm1hdFBlcmNlbnQgfSBmcm9tIFwiQC9saWIvZGF0YS9wcm9maXQtbG9zc1wiO1xyXG5pbXBvcnQgdHlwZSB7IFByb2ZpdExvc3NMaW5lSXRlbSB9IGZyb20gXCJAL2xpYi9kYXRhL3Byb2ZpdC1sb3NzXCI7XHJcblxyXG5pbnRlcmZhY2UgRXhwZW5zZUNhdGVnb3J5UHJvcHMge1xyXG4gIGNhdGVnb3J5TmFtZTogc3RyaW5nO1xyXG4gIHN1YmNhdGVnb3J5OiBzdHJpbmc7XHJcbiAgbGluZUl0ZW1zOiBQcm9maXRMb3NzTGluZUl0ZW1bXTtcclxuICBuZXRTYWxlczogbnVtYmVyO1xyXG4gIGRlZmF1bHRFeHBhbmRlZD86IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBFeHBlbnNlQ2F0ZWdvcnkoe1xyXG4gIGNhdGVnb3J5TmFtZSxcclxuICBzdWJjYXRlZ29yeSxcclxuICBsaW5lSXRlbXMsXHJcbiAgbmV0U2FsZXMsXHJcbiAgZGVmYXVsdEV4cGFuZGVkID0gZmFsc2UsXHJcbn06IEV4cGVuc2VDYXRlZ29yeVByb3BzKSB7XHJcbiAgY29uc3QgW2lzRXhwYW5kZWQsIHNldElzRXhwYW5kZWRdID0gdXNlU3RhdGUoZGVmYXVsdEV4cGFuZGVkKTtcclxuXHJcbiAgLy8gQ2FsY3VsYXRlIGNhdGVnb3J5IHRvdGFsXHJcbiAgY29uc3QgY2F0ZWdvcnlUb3RhbCA9IGxpbmVJdGVtcy5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgaXRlbS5hbW91bnQsIDApO1xyXG4gIGNvbnN0IGNhdGVnb3J5UGVyY2VudCA9IG5ldFNhbGVzID4gMCA/IChjYXRlZ29yeVRvdGFsIC8gbmV0U2FsZXMpICogMTAwIDogMDtcclxuXHJcbiAgLy8gU29ydCBsaW5lIGl0ZW1zIGJ5IG9yZGVyXHJcbiAgY29uc3Qgc29ydGVkSXRlbXMgPSBbLi4ubGluZUl0ZW1zXS5zb3J0KChhLCBiKSA9PiBhLmxpbmVfaXRlbV9vcmRlciAtIGIubGluZV9pdGVtX29yZGVyKTtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxkaXYgY2xhc3NOYW1lPVwiYm9yZGVyLWIgYm9yZGVyLWJvcmRlci81MCBsYXN0OmJvcmRlci1iLTBcIj5cclxuICAgICAgey8qIENhdGVnb3J5IEhlYWRlciAtIENsaWNrYWJsZSB0byBleHBhbmQvY29sbGFwc2UgKi99XHJcbiAgICAgIDxidXR0b25cclxuICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRJc0V4cGFuZGVkKCFpc0V4cGFuZGVkKX1cclxuICAgICAgICBjbGFzc05hbWU9XCJmbGV4IHctZnVsbCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIHB4LTQgcHktMyB0ZXh0LWxlZnQgdHJhbnNpdGlvbi1jb2xvcnMgaG92ZXI6YmctbXV0ZWQvNDBcIlxyXG4gICAgICA+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMlwiPlxyXG4gICAgICAgICAge2lzRXhwYW5kZWQgPyAoXHJcbiAgICAgICAgICAgIDxDaGV2cm9uRG93biBjbGFzc05hbWU9XCJoLTQgdy00IHRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiIC8+XHJcbiAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICA8Q2hldnJvblJpZ2h0IGNsYXNzTmFtZT1cImgtNCB3LTQgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kXCIgLz5cclxuICAgICAgICAgICl9XHJcbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJmb250LW1lZGl1bSB0ZXh0LWZvcmVncm91bmRcIj57Y2F0ZWdvcnlOYW1lfTwvc3Bhbj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC02XCI+XHJcbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJmb250LXNlbWlib2xkIHRleHQtZm9yZWdyb3VuZFwiPlxyXG4gICAgICAgICAgICB7Zm9ybWF0Q3VycmVuY3koY2F0ZWdvcnlUb3RhbCl9XHJcbiAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ3LTE2IHRleHQtcmlnaHQgdGV4dC1zbSB0ZXh0LW11dGVkLWZvcmVncm91bmRcIj5cclxuICAgICAgICAgICAge2Zvcm1hdFBlcmNlbnQoY2F0ZWdvcnlQZXJjZW50KX1cclxuICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9idXR0b24+XHJcblxyXG4gICAgICB7LyogTGluZSBJdGVtcyAtIFNob3duIHdoZW4gZXhwYW5kZWQgKi99XHJcbiAgICAgIHtpc0V4cGFuZGVkICYmIChcclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLW11dGVkLzIwXCI+XHJcbiAgICAgICAgICB7c29ydGVkSXRlbXMubWFwKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1QZXJjZW50ID0gbmV0U2FsZXMgPiAwID8gKGl0ZW0uYW1vdW50IC8gbmV0U2FsZXMpICogMTAwIDogMDtcclxuICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICBrZXk9e2l0ZW0uaWR9XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gYm9yZGVyLXQgYm9yZGVyLWJvcmRlci8zMCBweC00IHB5LTIuNSBwbC0xMlwiXHJcbiAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LW11dGVkLWZvcmVncm91bmRcIj57aXRlbS5saW5lX2l0ZW1fbmFtZX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC02XCI+XHJcbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1mb3JlZ3JvdW5kXCI+XHJcbiAgICAgICAgICAgICAgICAgICAge2Zvcm1hdEN1cnJlbmN5KGl0ZW0uYW1vdW50KX1cclxuICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ3LTE2IHRleHQtcmlnaHQgdGV4dC1zbSB0ZXh0LW11dGVkLWZvcmVncm91bmRcIj5cclxuICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0UGVyY2VudChpdGVtUGVyY2VudCl9XHJcbiAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfSl9XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICl9XHJcbiAgICA8L2Rpdj5cclxuICApO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgRXhwZW5zZUNhdGVnb3JpZXNHcm91cFByb3BzIHtcclxuICBsaW5lSXRlbXM6IFByb2ZpdExvc3NMaW5lSXRlbVtdO1xyXG4gIG5ldFNhbGVzOiBudW1iZXI7XHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gRXhwZW5zZUNhdGVnb3JpZXNHcm91cCh7XHJcbiAgbGluZUl0ZW1zLFxyXG4gIG5ldFNhbGVzLFxyXG4gIGNsYXNzTmFtZSxcclxufTogRXhwZW5zZUNhdGVnb3JpZXNHcm91cFByb3BzKSB7XHJcbiAgLy8gR3JvdXAgbGluZSBpdGVtcyBieSBzdWJjYXRlZ29yeVxyXG4gIGNvbnN0IHN1YmNhdGVnb3JpZXMgPSBsaW5lSXRlbXMucmVkdWNlKFxyXG4gICAgKGFjYywgaXRlbSkgPT4ge1xyXG4gICAgICBjb25zdCBzdWJjYXQgPSBpdGVtLnN1YmNhdGVnb3J5IHx8IFwiT3RoZXJcIjtcclxuICAgICAgaWYgKCFhY2Nbc3ViY2F0XSkge1xyXG4gICAgICAgIGFjY1tzdWJjYXRdID0gW107XHJcbiAgICAgIH1cclxuICAgICAgYWNjW3N1YmNhdF0ucHVzaChpdGVtKTtcclxuICAgICAgcmV0dXJuIGFjYztcclxuICAgIH0sXHJcbiAgICB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBQcm9maXRMb3NzTGluZUl0ZW1bXT5cclxuICApO1xyXG5cclxuICAvLyBEZWZpbmUgZGlzcGxheSBuYW1lcyBhbmQgb3JkZXIgZm9yIHN1YmNhdGVnb3JpZXNcclxuICBjb25zdCBzdWJjYXRlZ29yeU9yZGVyOiBSZWNvcmQ8c3RyaW5nLCB7IG5hbWU6IHN0cmluZzsgb3JkZXI6IG51bWJlciB9PiA9IHtcclxuICAgIHNhbGVzX21hcmtldGluZzogeyBuYW1lOiBcIlNhbGVzICYgTWFya2V0aW5nXCIsIG9yZGVyOiAxIH0sXHJcbiAgICBvcGVyYXRpb25zOiB7IG5hbWU6IFwiT3BlcmF0aW9uc1wiLCBvcmRlcjogMiB9LFxyXG4gICAgcGVyc29ubmVsOiB7IG5hbWU6IFwiUGVyc29ubmVsXCIsIG9yZGVyOiAzIH0sXHJcbiAgICBhZG1pbmlzdHJhdGl2ZTogeyBuYW1lOiBcIkFkbWluaXN0cmF0aXZlXCIsIG9yZGVyOiA0IH0sXHJcbiAgICBvdGhlcl9leHBlbnNlczogeyBuYW1lOiBcIk90aGVyIEV4cGVuc2VzXCIsIG9yZGVyOiA1IH0sXHJcbiAgICBPdGhlcjogeyBuYW1lOiBcIk90aGVyXCIsIG9yZGVyOiA2IH0sXHJcbiAgfTtcclxuXHJcbiAgLy8gU29ydCBzdWJjYXRlZ29yaWVzIGJ5IGRlZmluZWQgb3JkZXJcclxuICBjb25zdCBzb3J0ZWRTdWJjYXRlZ29yaWVzID0gT2JqZWN0LmVudHJpZXMoc3ViY2F0ZWdvcmllcykuc29ydCgoYSwgYikgPT4ge1xyXG4gICAgY29uc3Qgb3JkZXJBID0gc3ViY2F0ZWdvcnlPcmRlclthWzBdXT8ub3JkZXIgfHwgOTk5O1xyXG4gICAgY29uc3Qgb3JkZXJCID0gc3ViY2F0ZWdvcnlPcmRlcltiWzBdXT8ub3JkZXIgfHwgOTk5O1xyXG4gICAgcmV0dXJuIG9yZGVyQSAtIG9yZGVyQjtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxkaXYgY2xhc3NOYW1lPXtjbihcInJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1ib3JkZXIgYmctY2FyZFwiLCBjbGFzc05hbWUpfT5cclxuICAgICAge3NvcnRlZFN1YmNhdGVnb3JpZXMubWFwKChbc3ViY2F0ZWdvcnksIGl0ZW1zXSkgPT4gKFxyXG4gICAgICAgIDxFeHBlbnNlQ2F0ZWdvcnlcclxuICAgICAgICAgIGtleT17c3ViY2F0ZWdvcnl9XHJcbiAgICAgICAgICBjYXRlZ29yeU5hbWU9e3N1YmNhdGVnb3J5T3JkZXJbc3ViY2F0ZWdvcnldPy5uYW1lIHx8IHN1YmNhdGVnb3J5fVxyXG4gICAgICAgICAgc3ViY2F0ZWdvcnk9e3N1YmNhdGVnb3J5fVxyXG4gICAgICAgICAgbGluZUl0ZW1zPXtpdGVtc31cclxuICAgICAgICAgIG5ldFNhbGVzPXtuZXRTYWxlc31cclxuICAgICAgICAvPlxyXG4gICAgICApKX1cclxuICAgIDwvZGl2PlxyXG4gICk7XHJcbn1cclxuIl0sImZpbGUiOiJDOi9Qcm9qZWN0cy9Tb3VyY2UgNCBJbmR1c3RyaWVzL3NyYy9jb21wb25lbnRzL3Byb2ZpdC1sb3NzL2V4cGVuc2UtY2F0ZWdvcnkudHN4In0=