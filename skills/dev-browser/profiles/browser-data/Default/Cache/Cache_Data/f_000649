import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/components/admin/vendor-activity-log.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=9303f522"; const Fragment = __vite__cjsImport0_react_jsxDevRuntime["Fragment"]; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = RefreshRuntime.getRefreshReg("C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx");
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
"use client";
var _s = $RefreshSig$(), _s2 = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=9303f522"; const useState = __vite__cjsImport3_react["useState"]; const useEffect = __vite__cjsImport3_react["useEffect"]; const useCallback = __vite__cjsImport3_react["useCallback"];
import { Card, CardHeader, CardTitle } from "/src/components/ui/card.tsx";
import { Badge } from "/src/components/ui/badge.tsx";
import { Button } from "/src/components/ui/button.tsx";
import { Textarea } from "/src/components/ui/textarea.tsx";
import { MessageSquare, DollarSign, Users, AlertCircle, FileText, Loader2, Send } from "/node_modules/.vite/deps/lucide-react.js?v=9303f522";
const UPDATE_TYPE_CONFIG = {
  comment: { label: "Comment", variant: "default", icon: MessageSquare },
  pricing_update: { label: "Pricing Update", variant: "warning", icon: DollarSign },
  contact_change: { label: "Contact Change", variant: "secondary", icon: Users },
  status_change: { label: "Status Change", variant: "success", icon: AlertCircle },
  note: { label: "Note", variant: "outline", icon: FileText }
};
const CREATABLE_UPDATE_TYPES = ["comment", "pricing_update", "contact_change", "note"];
function formatDateTime(isoString) {
  const date = new Date(isoString);
  const now = /* @__PURE__ */ new Date();
  const diffMs = now.getTime() - date.getTime();
  const diffMins = Math.floor(diffMs / 6e4);
  const diffHours = Math.floor(diffMs / 36e5);
  const diffDays = Math.floor(diffMs / 864e5);
  if (diffMins < 1) {
    return "Just now";
  } else if (diffMins < 60) {
    return `${diffMins} minute${diffMins !== 1 ? "s" : ""} ago`;
  } else if (diffHours < 24) {
    return `${diffHours} hour${diffHours !== 1 ? "s" : ""} ago`;
  } else if (diffDays < 7) {
    return `${diffDays} day${diffDays !== 1 ? "s" : ""} ago`;
  }
  return date.toLocaleDateString("en-US", {
    month: "short",
    day: "numeric",
    year: date.getFullYear() !== now.getFullYear() ? "numeric" : void 0,
    hour: "numeric",
    minute: "2-digit"
  });
}
function getUpdateTypeConfig(updateType) {
  return UPDATE_TYPE_CONFIG[updateType] || {
    label: updateType,
    variant: "outline",
    icon: FileText
  };
}
function ActivityEntry({ update }) {
  const config = getUpdateTypeConfig(update.update_type);
  const Icon = config.icon;
  return /* @__PURE__ */ jsxDEV("div", { className: "flex gap-3 py-4 border-b border-border last:border-b-0", children: [
    /* @__PURE__ */ jsxDEV("div", { className: "flex-shrink-0 mt-0.5", children: /* @__PURE__ */ jsxDEV("div", { className: "w-8 h-8 rounded-full bg-muted flex items-center justify-center", children: /* @__PURE__ */ jsxDEV(Icon, { className: "h-4 w-4 text-muted-foreground" }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
      lineNumber: 114,
      columnNumber: 11
    }, this) }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
      lineNumber: 113,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
      lineNumber: 112,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV("div", { className: "flex-1 min-w-0", children: [
      /* @__PURE__ */ jsxDEV("div", { className: "flex flex-wrap items-center gap-2 mb-1", children: [
        /* @__PURE__ */ jsxDEV(Badge, { variant: config.variant, children: config.label }, void 0, false, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 122,
          columnNumber: 11
        }, this),
        update.created_by && /* @__PURE__ */ jsxDEV("span", { className: "text-sm font-medium text-foreground", children: update.created_by }, void 0, false, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 124,
          columnNumber: 11
        }, this),
        /* @__PURE__ */ jsxDEV("span", { className: "text-xs text-muted-foreground", children: formatDateTime(update.created_at) }, void 0, false, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 128,
          columnNumber: 11
        }, this)
      ] }, void 0, true, {
        fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
        lineNumber: 121,
        columnNumber: 9
      }, this),
      /* @__PURE__ */ jsxDEV("p", { className: "text-sm text-foreground whitespace-pre-wrap break-words", children: update.content }, void 0, false, {
        fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
        lineNumber: 134,
        columnNumber: 9
      }, this)
    ] }, void 0, true, {
      fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
      lineNumber: 119,
      columnNumber: 7
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
    lineNumber: 110,
    columnNumber: 5
  }, this);
}
_c = ActivityEntry;
function AddUpdateForm({
  onSubmit,
  isSubmitting
}) {
  _s();
  const [content, setContent] = useState("");
  const handleSubmit = async (e) => {
    e.preventDefault();
    if (!content.trim() || isSubmitting) return;
    await onSubmit("comment", content.trim());
    setContent("");
  };
  return /* @__PURE__ */ jsxDEV("form", { onSubmit: handleSubmit, className: "space-y-3", children: [
    /* @__PURE__ */ jsxDEV(
      Textarea,
      {
        value: content,
        onChange: (e) => setContent(e.target.value),
        placeholder: "Add a comment...",
        rows: 3,
        disabled: isSubmitting
      },
      void 0,
      false,
      {
        fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
        lineNumber: 166,
        columnNumber: 7
      },
      this
    ),
    /* @__PURE__ */ jsxDEV("div", { className: "flex justify-end", children: /* @__PURE__ */ jsxDEV(
      Button,
      {
        type: "submit",
        variant: "primary",
        size: "sm",
        disabled: !content.trim() || isSubmitting,
        children: isSubmitting ? /* @__PURE__ */ jsxDEV(Fragment, { children: [
          /* @__PURE__ */ jsxDEV(Loader2, { className: "h-4 w-4 animate-spin" }, void 0, false, {
            fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
            lineNumber: 184,
            columnNumber: 15
          }, this),
          "Posting..."
        ] }, void 0, true, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 183,
          columnNumber: 11
        }, this) : /* @__PURE__ */ jsxDEV(Fragment, { children: [
          /* @__PURE__ */ jsxDEV(Send, { className: "h-4 w-4" }, void 0, false, {
            fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
            lineNumber: 189,
            columnNumber: 15
          }, this),
          "Post Comment"
        ] }, void 0, true, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 188,
          columnNumber: 11
        }, this)
      },
      void 0,
      false,
      {
        fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
        lineNumber: 176,
        columnNumber: 9
      },
      this
    ) }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
      lineNumber: 175,
      columnNumber: 7
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
    lineNumber: 164,
    columnNumber: 5
  }, this);
}
_s(AddUpdateForm, "KPwtwb4lt1NZxOwnjhyyIoKb9lQ=");
_c2 = AddUpdateForm;
export function VendorActivityLog({ vendorId, vendorName }) {
  _s2();
  const [updates, setUpdates] = useState([]);
  const [isLoading, setIsLoading] = useState(true);
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [error, setError] = useState(null);
  const fetchUpdates = useCallback(async () => {
    try {
      setError(null);
      const response = await fetch(`/api/vendors/${vendorId}/updates`);
      if (!response.ok) {
        throw new Error(`Failed to fetch updates: ${response.statusText}`);
      }
      const result = await response.json();
      if (result.error) {
        throw new Error(result.error);
      }
      setUpdates(result.data || []);
    } catch (err) {
      console.error("Error fetching vendor updates:", err);
      setError(err instanceof Error ? err.message : "Failed to load updates");
    } finally {
      setIsLoading(false);
    }
  }, [vendorId]);
  useEffect(() => {
    fetchUpdates();
  }, [fetchUpdates]);
  const handleSubmit = async (updateType, content) => {
    setIsSubmitting(true);
    setError(null);
    try {
      const response = await fetch(`/api/vendors/${vendorId}/updates`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          update_type: updateType,
          content
        })
      });
      if (!response.ok) {
        throw new Error(`Failed to create update: ${response.statusText}`);
      }
      const result = await response.json();
      if (!result.success) {
        throw new Error(result.error || "Failed to create update");
      }
      if (result.data) {
        setUpdates((prev) => [result.data, ...prev]);
      } else {
        await fetchUpdates();
      }
    } catch (err) {
      console.error("Error creating vendor update:", err);
      setError(err instanceof Error ? err.message : "Failed to post update");
    } finally {
      setIsSubmitting(false);
    }
  };
  return /* @__PURE__ */ jsxDEV(Card, { padding: "none", className: "overflow-hidden", children: [
    /* @__PURE__ */ jsxDEV(CardHeader, { className: "px-6 pt-6 pb-0", children: /* @__PURE__ */ jsxDEV(CardTitle, { children: "Comments" }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
      lineNumber: 282,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
      lineNumber: 281,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV("div", { className: "p-6", children: [
      /* @__PURE__ */ jsxDEV("div", { className: "mb-6 pb-6 border-b border-border", children: /* @__PURE__ */ jsxDEV(AddUpdateForm, { onSubmit: handleSubmit, isSubmitting }, void 0, false, {
        fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
        lineNumber: 288,
        columnNumber: 11
      }, this) }, void 0, false, {
        fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
        lineNumber: 287,
        columnNumber: 9
      }, this),
      error && /* @__PURE__ */ jsxDEV("div", { className: "mb-4 p-3 rounded-md bg-danger/10 text-danger text-sm flex items-center gap-2", children: [
        /* @__PURE__ */ jsxDEV(AlertCircle, { className: "h-4 w-4 flex-shrink-0" }, void 0, false, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 294,
          columnNumber: 13
        }, this),
        error
      ] }, void 0, true, {
        fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
        lineNumber: 293,
        columnNumber: 9
      }, this),
      /* @__PURE__ */ jsxDEV("div", { className: "space-y-0", children: isLoading ? /* @__PURE__ */ jsxDEV("div", { className: "flex items-center justify-center py-8", children: [
        /* @__PURE__ */ jsxDEV(Loader2, { className: "h-6 w-6 animate-spin text-muted-foreground" }, void 0, false, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 303,
          columnNumber: 15
        }, this),
        /* @__PURE__ */ jsxDEV("span", { className: "ml-2 text-sm text-muted-foreground", children: "Loading updates..." }, void 0, false, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 304,
          columnNumber: 15
        }, this)
      ] }, void 0, true, {
        fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
        lineNumber: 302,
        columnNumber: 11
      }, this) : updates.length === 0 ? /* @__PURE__ */ jsxDEV("div", { className: "text-center py-8 text-muted-foreground", children: [
        /* @__PURE__ */ jsxDEV(MessageSquare, { className: "h-8 w-8 mx-auto mb-2 opacity-50" }, void 0, false, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 308,
          columnNumber: 15
        }, this),
        /* @__PURE__ */ jsxDEV("p", { className: "text-sm", children: [
          "No comments yet for ",
          vendorName
        ] }, void 0, true, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 309,
          columnNumber: 15
        }, this),
        /* @__PURE__ */ jsxDEV("p", { className: "text-xs mt-1", children: "Be the first to add a comment." }, void 0, false, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 310,
          columnNumber: 15
        }, this)
      ] }, void 0, true, {
        fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
        lineNumber: 307,
        columnNumber: 11
      }, this) : updates.map(
        (update) => /* @__PURE__ */ jsxDEV(ActivityEntry, { update }, update.id, false, {
          fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
          lineNumber: 314,
          columnNumber: 11
        }, this)
      ) }, void 0, false, {
        fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
        lineNumber: 300,
        columnNumber: 9
      }, this)
    ] }, void 0, true, {
      fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
      lineNumber: 285,
      columnNumber: 7
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx",
    lineNumber: 280,
    columnNumber: 5
  }, this);
}
_s2(VendorActivityLog, "6RkJbak/BlANmTzBTVLvu3CYjfg=");
_c3 = VendorActivityLog;
var _c, _c2, _c3;
$RefreshReg$(_c, "ActivityEntry");
$RefreshReg$(_c2, "AddUpdateForm");
$RefreshReg$(_c3, "VendorActivityLog");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/Projects/Source 4 Industries/src/components/admin/vendor-activity-log.tsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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QUE7QUFBQTtBQUFBO0FBQUEsZUFBdUU7QUFBQSxXQUZ6RTtBQUFBO0FBQUE7QUFBQTtBQUFBLGFBR0EsSUFDRUYsUUFBUTBCLFdBQVcsSUFDckIsdUJBQUMsU0FBSSxXQUFVLDBDQUNiO0FBQUEsK0JBQUMsaUJBQWMsV0FBVSxxQ0FBekI7QUFBQTtBQUFBO0FBQUE7QUFBQSxlQUEwRDtBQUFBLFFBQzFELHVCQUFDLE9BQUUsV0FBVSxXQUFVO0FBQUE7QUFBQSxVQUFxQjNCO0FBQUFBLGFBQTVDO0FBQUE7QUFBQTtBQUFBO0FBQUEsZUFBdUQ7QUFBQSxRQUN2RCx1QkFBQyxPQUFFLFdBQVUsZ0JBQWUsOENBQTVCO0FBQUE7QUFBQTtBQUFBO0FBQUEsZUFBMEQ7QUFBQSxXQUg1RDtBQUFBO0FBQUE7QUFBQTtBQUFBLGFBSUEsSUFFQUMsUUFBUTJCO0FBQUFBLFFBQUksQ0FBQ2pELFdBQ1gsdUJBQUMsaUJBQThCLFVBQVhBLE9BQU9rRCxJQUEzQjtBQUFBO0FBQUE7QUFBQTtBQUFBLGVBQThDO0FBQUEsTUFDL0MsS0FmTDtBQUFBO0FBQUE7QUFBQTtBQUFBLGFBaUJBO0FBQUEsU0FoQ0Y7QUFBQTtBQUFBO0FBQUE7QUFBQSxXQWlDQTtBQUFBLE9BdENGO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0F1Q0E7QUFFSjtBQUFDcEcsSUF0SGVxRSxtQkFBaUI7QUFBQWdDLE1BQWpCaEM7QUFBaUIsSUFBQVosSUFBQVcsS0FBQWlDO0FBQUFDLGFBQUE3QyxJQUFBO0FBQUE2QyxhQUFBbEMsS0FBQTtBQUFBa0MsYUFBQUQsS0FBQSIsIm5hbWVzIjpbIl9zIiwiJFJlZnJlc2hTaWckIiwiX3MyIiwidXNlU3RhdGUiLCJ1c2VFZmZlY3QiLCJ1c2VDYWxsYmFjayIsIkNhcmQiLCJDYXJkSGVhZGVyIiwiQ2FyZFRpdGxlIiwiQmFkZ2UiLCJCdXR0b24iLCJUZXh0YXJlYSIsIk1lc3NhZ2VTcXVhcmUiLCJEb2xsYXJTaWduIiwiVXNlcnMiLCJBbGVydENpcmNsZSIsIkZpbGVUZXh0IiwiTG9hZGVyMiIsIlNlbmQiLCJVUERBVEVfVFlQRV9DT05GSUciLCJjb21tZW50IiwibGFiZWwiLCJ2YXJpYW50IiwiaWNvbiIsInByaWNpbmdfdXBkYXRlIiwiY29udGFjdF9jaGFuZ2UiLCJzdGF0dXNfY2hhbmdlIiwibm90ZSIsIkNSRUFUQUJMRV9VUERBVEVfVFlQRVMiLCJmb3JtYXREYXRlVGltZSIsImlzb1N0cmluZyIsImRhdGUiLCJEYXRlIiwibm93IiwiZGlmZk1zIiwiZ2V0VGltZSIsImRpZmZNaW5zIiwiTWF0aCIsImZsb29yIiwiZGlmZkhvdXJzIiwiZGlmZkRheXMiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJtb250aCIsImRheSIsInllYXIiLCJnZXRGdWxsWWVhciIsInVuZGVmaW5lZCIsImhvdXIiLCJtaW51dGUiLCJnZXRVcGRhdGVUeXBlQ29uZmlnIiwidXBkYXRlVHlwZSIsIkFjdGl2aXR5RW50cnkiLCJ1cGRhdGUiLCJjb25maWciLCJ1cGRhdGVfdHlwZSIsIkljb24iLCJjcmVhdGVkX2J5IiwiY3JlYXRlZF9hdCIsImNvbnRlbnQiLCJfYyIsIkFkZFVwZGF0ZUZvcm0iLCJvblN1Ym1pdCIsImlzU3VibWl0dGluZyIsInNldENvbnRlbnQiLCJoYW5kbGVTdWJtaXQiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0cmltIiwidGFyZ2V0IiwidmFsdWUiLCJfYzIiLCJWZW5kb3JBY3Rpdml0eUxvZyIsInZlbmRvcklkIiwidmVuZG9yTmFtZSIsInVwZGF0ZXMiLCJzZXRVcGRhdGVzIiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwic2V0SXNTdWJtaXR0aW5nIiwiZXJyb3IiLCJzZXRFcnJvciIsImZldGNoVXBkYXRlcyIsInJlc3BvbnNlIiwiZmV0Y2giLCJvayIsIkVycm9yIiwic3RhdHVzVGV4dCIsInJlc3VsdCIsImpzb24iLCJkYXRhIiwiZXJyIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdWNjZXNzIiwicHJldiIsImxlbmd0aCIsIm1hcCIsImlkIiwiX2MzIiwiJFJlZnJlc2hSZWckIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbInZlbmRvci1hY3Rpdml0eS1sb2cudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIGNsaWVudFwiO1xyXG5cclxuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2sgfSBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHsgQ2FyZCwgQ2FyZEhlYWRlciwgQ2FyZFRpdGxlIH0gZnJvbSBcIkAvY29tcG9uZW50cy91aS9jYXJkXCI7XHJcbmltcG9ydCB7IEJhZGdlLCBCYWRnZVZhcmlhbnQgfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2JhZGdlXCI7XHJcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvYnV0dG9uXCI7XHJcbmltcG9ydCB7IFRleHRhcmVhIH0gZnJvbSBcIkAvY29tcG9uZW50cy91aS90ZXh0YXJlYVwiO1xyXG5pbXBvcnQgeyBWZW5kb3JVcGRhdGUgfSBmcm9tIFwiQC9saWIvZGF0YS92ZW5kb3JzXCI7XHJcbmltcG9ydCB7IE1lc3NhZ2VTcXVhcmUsIERvbGxhclNpZ24sIFVzZXJzLCBBbGVydENpcmNsZSwgRmlsZVRleHQsIExvYWRlcjIsIFNlbmQgfSBmcm9tIFwibHVjaWRlLXJlYWN0XCI7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFR5cGVzXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbnR5cGUgVmVuZG9yQWN0aXZpdHlMb2dQcm9wcyA9IHtcclxuICB2ZW5kb3JJZDogc3RyaW5nO1xyXG4gIHZlbmRvck5hbWU6IHN0cmluZztcclxufTtcclxuXHJcbnR5cGUgVXBkYXRlVHlwZSA9IFwiY29tbWVudFwiIHwgXCJwcmljaW5nX3VwZGF0ZVwiIHwgXCJjb250YWN0X2NoYW5nZVwiIHwgXCJzdGF0dXNfY2hhbmdlXCIgfCBcIm5vdGVcIjtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ29uc3RhbnRzXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmNvbnN0IFVQREFURV9UWVBFX0NPTkZJRzogUmVjb3JkPFxyXG4gIFVwZGF0ZVR5cGUsXHJcbiAgeyBsYWJlbDogc3RyaW5nOyB2YXJpYW50OiBCYWRnZVZhcmlhbnQ7IGljb246IFJlYWN0LkVsZW1lbnRUeXBlIH1cclxuPiA9IHtcclxuICBjb21tZW50OiB7IGxhYmVsOiBcIkNvbW1lbnRcIiwgdmFyaWFudDogXCJkZWZhdWx0XCIsIGljb246IE1lc3NhZ2VTcXVhcmUgfSxcclxuICBwcmljaW5nX3VwZGF0ZTogeyBsYWJlbDogXCJQcmljaW5nIFVwZGF0ZVwiLCB2YXJpYW50OiBcIndhcm5pbmdcIiwgaWNvbjogRG9sbGFyU2lnbiB9LFxyXG4gIGNvbnRhY3RfY2hhbmdlOiB7IGxhYmVsOiBcIkNvbnRhY3QgQ2hhbmdlXCIsIHZhcmlhbnQ6IFwic2Vjb25kYXJ5XCIsIGljb246IFVzZXJzIH0sXHJcbiAgc3RhdHVzX2NoYW5nZTogeyBsYWJlbDogXCJTdGF0dXMgQ2hhbmdlXCIsIHZhcmlhbnQ6IFwic3VjY2Vzc1wiLCBpY29uOiBBbGVydENpcmNsZSB9LFxyXG4gIG5vdGU6IHsgbGFiZWw6IFwiTm90ZVwiLCB2YXJpYW50OiBcIm91dGxpbmVcIiwgaWNvbjogRmlsZVRleHQgfSxcclxufTtcclxuXHJcbmNvbnN0IENSRUFUQUJMRV9VUERBVEVfVFlQRVM6IFVwZGF0ZVR5cGVbXSA9IFtcImNvbW1lbnRcIiwgXCJwcmljaW5nX3VwZGF0ZVwiLCBcImNvbnRhY3RfY2hhbmdlXCIsIFwibm90ZVwiXTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gSGVscGVyIEZ1bmN0aW9uc1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5mdW5jdGlvbiBmb3JtYXREYXRlVGltZShpc29TdHJpbmc6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGlzb1N0cmluZyk7XHJcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICBjb25zdCBkaWZmTXMgPSBub3cuZ2V0VGltZSgpIC0gZGF0ZS5nZXRUaW1lKCk7XHJcbiAgY29uc3QgZGlmZk1pbnMgPSBNYXRoLmZsb29yKGRpZmZNcyAvIDYwMDAwKTtcclxuICBjb25zdCBkaWZmSG91cnMgPSBNYXRoLmZsb29yKGRpZmZNcyAvIDM2MDAwMDApO1xyXG4gIGNvbnN0IGRpZmZEYXlzID0gTWF0aC5mbG9vcihkaWZmTXMgLyA4NjQwMDAwMCk7XHJcblxyXG4gIC8vIFNob3cgcmVsYXRpdmUgdGltZSBmb3IgcmVjZW50IHVwZGF0ZXNcclxuICBpZiAoZGlmZk1pbnMgPCAxKSB7XHJcbiAgICByZXR1cm4gXCJKdXN0IG5vd1wiO1xyXG4gIH0gZWxzZSBpZiAoZGlmZk1pbnMgPCA2MCkge1xyXG4gICAgcmV0dXJuIGAke2RpZmZNaW5zfSBtaW51dGUke2RpZmZNaW5zICE9PSAxID8gXCJzXCIgOiBcIlwifSBhZ29gO1xyXG4gIH0gZWxzZSBpZiAoZGlmZkhvdXJzIDwgMjQpIHtcclxuICAgIHJldHVybiBgJHtkaWZmSG91cnN9IGhvdXIke2RpZmZIb3VycyAhPT0gMSA/IFwic1wiIDogXCJcIn0gYWdvYDtcclxuICB9IGVsc2UgaWYgKGRpZmZEYXlzIDwgNykge1xyXG4gICAgcmV0dXJuIGAke2RpZmZEYXlzfSBkYXkke2RpZmZEYXlzICE9PSAxID8gXCJzXCIgOiBcIlwifSBhZ29gO1xyXG4gIH1cclxuXHJcbiAgLy8gU2hvdyBmdWxsIGRhdGUgZm9yIG9sZGVyIHVwZGF0ZXNcclxuICByZXR1cm4gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoXCJlbi1VU1wiLCB7XHJcbiAgICBtb250aDogXCJzaG9ydFwiLFxyXG4gICAgZGF5OiBcIm51bWVyaWNcIixcclxuICAgIHllYXI6IGRhdGUuZ2V0RnVsbFllYXIoKSAhPT0gbm93LmdldEZ1bGxZZWFyKCkgPyBcIm51bWVyaWNcIiA6IHVuZGVmaW5lZCxcclxuICAgIGhvdXI6IFwibnVtZXJpY1wiLFxyXG4gICAgbWludXRlOiBcIjItZGlnaXRcIixcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VXBkYXRlVHlwZUNvbmZpZyh1cGRhdGVUeXBlOiBzdHJpbmcpIHtcclxuICByZXR1cm4gKFxyXG4gICAgVVBEQVRFX1RZUEVfQ09ORklHW3VwZGF0ZVR5cGUgYXMgVXBkYXRlVHlwZV0gfHwge1xyXG4gICAgICBsYWJlbDogdXBkYXRlVHlwZSxcclxuICAgICAgdmFyaWFudDogXCJvdXRsaW5lXCIgYXMgQmFkZ2VWYXJpYW50LFxyXG4gICAgICBpY29uOiBGaWxlVGV4dCxcclxuICAgIH1cclxuICApO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEFjdGl2aXR5IEVudHJ5IENvbXBvbmVudFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5mdW5jdGlvbiBBY3Rpdml0eUVudHJ5KHsgdXBkYXRlIH06IHsgdXBkYXRlOiBWZW5kb3JVcGRhdGUgfSkge1xyXG4gIGNvbnN0IGNvbmZpZyA9IGdldFVwZGF0ZVR5cGVDb25maWcodXBkYXRlLnVwZGF0ZV90eXBlKTtcclxuICBjb25zdCBJY29uID0gY29uZmlnLmljb247XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZ2FwLTMgcHktNCBib3JkZXItYiBib3JkZXItYm9yZGVyIGxhc3Q6Ym9yZGVyLWItMFwiPlxyXG4gICAgICB7LyogSWNvbiAqL31cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LXNocmluay0wIG10LTAuNVwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy04IGgtOCByb3VuZGVkLWZ1bGwgYmctbXV0ZWQgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cclxuICAgICAgICAgIDxJY29uIGNsYXNzTmFtZT1cImgtNCB3LTQgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kXCIgLz5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcblxyXG4gICAgICB7LyogQ29udGVudCAqL31cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgbWluLXctMFwiPlxyXG4gICAgICAgIHsvKiBIZWFkZXI6IEJhZGdlICsgQXV0aG9yICsgVGltZSAqL31cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC13cmFwIGl0ZW1zLWNlbnRlciBnYXAtMiBtYi0xXCI+XHJcbiAgICAgICAgICA8QmFkZ2UgdmFyaWFudD17Y29uZmlnLnZhcmlhbnR9Pntjb25maWcubGFiZWx9PC9CYWRnZT5cclxuICAgICAgICAgIHt1cGRhdGUuY3JlYXRlZF9ieSAmJiAoXHJcbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW0gdGV4dC1mb3JlZ3JvdW5kXCI+XHJcbiAgICAgICAgICAgICAge3VwZGF0ZS5jcmVhdGVkX2J5fVxyXG4gICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICApfVxyXG4gICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LW11dGVkLWZvcmVncm91bmRcIj5cclxuICAgICAgICAgICAge2Zvcm1hdERhdGVUaW1lKHVwZGF0ZS5jcmVhdGVkX2F0KX1cclxuICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgey8qIENvbnRlbnQgdGV4dCAqL31cclxuICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZm9yZWdyb3VuZCB3aGl0ZXNwYWNlLXByZS13cmFwIGJyZWFrLXdvcmRzXCI+XHJcbiAgICAgICAgICB7dXBkYXRlLmNvbnRlbnR9XHJcbiAgICAgICAgPC9wPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gICk7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQWRkIFVwZGF0ZSBGb3JtIENvbXBvbmVudFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5mdW5jdGlvbiBBZGRVcGRhdGVGb3JtKHtcclxuICBvblN1Ym1pdCxcclxuICBpc1N1Ym1pdHRpbmcsXHJcbn06IHtcclxuICBvblN1Ym1pdDogKHVwZGF0ZVR5cGU6IFVwZGF0ZVR5cGUsIGNvbnRlbnQ6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcclxuICBpc1N1Ym1pdHRpbmc6IGJvb2xlYW47XHJcbn0pIHtcclxuICBjb25zdCBbY29udGVudCwgc2V0Q29udGVudF0gPSB1c2VTdGF0ZShcIlwiKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlU3VibWl0ID0gYXN5bmMgKGU6IFJlYWN0LkZvcm1FdmVudCkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaWYgKCFjb250ZW50LnRyaW0oKSB8fCBpc1N1Ym1pdHRpbmcpIHJldHVybjtcclxuXHJcbiAgICBhd2FpdCBvblN1Ym1pdChcImNvbW1lbnRcIiwgY29udGVudC50cmltKCkpO1xyXG4gICAgc2V0Q29udGVudChcIlwiKTtcclxuICB9O1xyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPGZvcm0gb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdH0gY2xhc3NOYW1lPVwic3BhY2UteS0zXCI+XHJcbiAgICAgIHsvKiBDb250ZW50IHRleHRhcmVhICovfVxyXG4gICAgICA8VGV4dGFyZWFcclxuICAgICAgICB2YWx1ZT17Y29udGVudH1cclxuICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldENvbnRlbnQoZS50YXJnZXQudmFsdWUpfVxyXG4gICAgICAgIHBsYWNlaG9sZGVyPVwiQWRkIGEgY29tbWVudC4uLlwiXHJcbiAgICAgICAgcm93cz17M31cclxuICAgICAgICBkaXNhYmxlZD17aXNTdWJtaXR0aW5nfVxyXG4gICAgICAvPlxyXG5cclxuICAgICAgey8qIFN1Ym1pdCBidXR0b24gKi99XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBqdXN0aWZ5LWVuZFwiPlxyXG4gICAgICAgIDxCdXR0b25cclxuICAgICAgICAgIHR5cGU9XCJzdWJtaXRcIlxyXG4gICAgICAgICAgdmFyaWFudD1cInByaW1hcnlcIlxyXG4gICAgICAgICAgc2l6ZT1cInNtXCJcclxuICAgICAgICAgIGRpc2FibGVkPXshY29udGVudC50cmltKCkgfHwgaXNTdWJtaXR0aW5nfVxyXG4gICAgICAgID5cclxuICAgICAgICAgIHtpc1N1Ym1pdHRpbmcgPyAoXHJcbiAgICAgICAgICAgIDw+XHJcbiAgICAgICAgICAgICAgPExvYWRlcjIgY2xhc3NOYW1lPVwiaC00IHctNCBhbmltYXRlLXNwaW5cIiAvPlxyXG4gICAgICAgICAgICAgIFBvc3RpbmcuLi5cclxuICAgICAgICAgICAgPC8+XHJcbiAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICA8PlxyXG4gICAgICAgICAgICAgIDxTZW5kIGNsYXNzTmFtZT1cImgtNCB3LTRcIiAvPlxyXG4gICAgICAgICAgICAgIFBvc3QgQ29tbWVudFxyXG4gICAgICAgICAgICA8Lz5cclxuICAgICAgICAgICl9XHJcbiAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9mb3JtPlxyXG4gICk7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gTWFpbiBDb21wb25lbnRcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIFZlbmRvckFjdGl2aXR5TG9nKHsgdmVuZG9ySWQsIHZlbmRvck5hbWUgfTogVmVuZG9yQWN0aXZpdHlMb2dQcm9wcykge1xyXG4gIGNvbnN0IFt1cGRhdGVzLCBzZXRVcGRhdGVzXSA9IHVzZVN0YXRlPFZlbmRvclVwZGF0ZVtdPihbXSk7XHJcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xyXG4gIGNvbnN0IFtpc1N1Ym1pdHRpbmcsIHNldElzU3VibWl0dGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcclxuXHJcbiAgLy8gRmV0Y2ggdXBkYXRlc1xyXG4gIGNvbnN0IGZldGNoVXBkYXRlcyA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHNldEVycm9yKG51bGwpO1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL3ZlbmRvcnMvJHt2ZW5kb3JJZH0vdXBkYXRlc2ApO1xyXG5cclxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIHVwZGF0ZXM6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG5cclxuICAgICAgaWYgKHJlc3VsdC5lcnJvcikge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihyZXN1bHQuZXJyb3IpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBzZXRVcGRhdGVzKHJlc3VsdC5kYXRhIHx8IFtdKTtcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgdmVuZG9yIHVwZGF0ZXM6XCIsIGVycik7XHJcbiAgICAgIHNldEVycm9yKGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiBcIkZhaWxlZCB0byBsb2FkIHVwZGF0ZXNcIik7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xyXG4gICAgfVxyXG4gIH0sIFt2ZW5kb3JJZF0pO1xyXG5cclxuICAvLyBJbml0aWFsIGZldGNoXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGZldGNoVXBkYXRlcygpO1xyXG4gIH0sIFtmZXRjaFVwZGF0ZXNdKTtcclxuXHJcbiAgLy8gU3VibWl0IG5ldyB1cGRhdGVcclxuICBjb25zdCBoYW5kbGVTdWJtaXQgPSBhc3luYyAodXBkYXRlVHlwZTogVXBkYXRlVHlwZSwgY29udGVudDogc3RyaW5nKSA9PiB7XHJcbiAgICBzZXRJc1N1Ym1pdHRpbmcodHJ1ZSk7XHJcbiAgICBzZXRFcnJvcihudWxsKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL3ZlbmRvcnMvJHt2ZW5kb3JJZH0vdXBkYXRlc2AsIHtcclxuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICB1cGRhdGVfdHlwZTogdXBkYXRlVHlwZSxcclxuICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXHJcbiAgICAgICAgfSksXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGNyZWF0ZSB1cGRhdGU6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG5cclxuICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihyZXN1bHQuZXJyb3IgfHwgXCJGYWlsZWQgdG8gY3JlYXRlIHVwZGF0ZVwiKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQWRkIG5ldyB1cGRhdGUgdG8gdGhlIHRvcCBvZiB0aGUgbGlzdFxyXG4gICAgICBpZiAocmVzdWx0LmRhdGEpIHtcclxuICAgICAgICBzZXRVcGRhdGVzKChwcmV2KSA9PiBbcmVzdWx0LmRhdGEsIC4uLnByZXZdKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBSZWZldGNoIGlmIHdlIGRpZG4ndCBnZXQgdGhlIG5ldyB1cGRhdGUgYmFja1xyXG4gICAgICAgIGF3YWl0IGZldGNoVXBkYXRlcygpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNyZWF0aW5nIHZlbmRvciB1cGRhdGU6XCIsIGVycik7XHJcbiAgICAgIHNldEVycm9yKGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiBcIkZhaWxlZCB0byBwb3N0IHVwZGF0ZVwiKTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHNldElzU3VibWl0dGluZyhmYWxzZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxDYXJkIHBhZGRpbmc9XCJub25lXCIgY2xhc3NOYW1lPVwib3ZlcmZsb3ctaGlkZGVuXCI+XHJcbiAgICAgIDxDYXJkSGVhZGVyIGNsYXNzTmFtZT1cInB4LTYgcHQtNiBwYi0wXCI+XHJcbiAgICAgICAgPENhcmRUaXRsZT5Db21tZW50czwvQ2FyZFRpdGxlPlxyXG4gICAgICA8L0NhcmRIZWFkZXI+XHJcblxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInAtNlwiPlxyXG4gICAgICAgIHsvKiBBZGQgdXBkYXRlIGZvcm0gKi99XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYi02IHBiLTYgYm9yZGVyLWIgYm9yZGVyLWJvcmRlclwiPlxyXG4gICAgICAgICAgPEFkZFVwZGF0ZUZvcm0gb25TdWJtaXQ9e2hhbmRsZVN1Ym1pdH0gaXNTdWJtaXR0aW5nPXtpc1N1Ym1pdHRpbmd9IC8+XHJcbiAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgIHsvKiBFcnJvciBtZXNzYWdlICovfVxyXG4gICAgICAgIHtlcnJvciAmJiAoXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1iLTQgcC0zIHJvdW5kZWQtbWQgYmctZGFuZ2VyLzEwIHRleHQtZGFuZ2VyIHRleHQtc20gZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTJcIj5cclxuICAgICAgICAgICAgPEFsZXJ0Q2lyY2xlIGNsYXNzTmFtZT1cImgtNCB3LTQgZmxleC1zaHJpbmstMFwiIC8+XHJcbiAgICAgICAgICAgIHtlcnJvcn1cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICl9XHJcblxyXG4gICAgICAgIHsvKiBVcGRhdGVzIGxpc3QgKi99XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTBcIj5cclxuICAgICAgICAgIHtpc0xvYWRpbmcgPyAoXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcHktOFwiPlxyXG4gICAgICAgICAgICAgIDxMb2FkZXIyIGNsYXNzTmFtZT1cImgtNiB3LTYgYW5pbWF0ZS1zcGluIHRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiIC8+XHJcbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibWwtMiB0ZXh0LXNtIHRleHQtbXV0ZWQtZm9yZWdyb3VuZFwiPkxvYWRpbmcgdXBkYXRlcy4uLjwvc3Bhbj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICApIDogdXBkYXRlcy5sZW5ndGggPT09IDAgPyAoXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgcHktOCB0ZXh0LW11dGVkLWZvcmVncm91bmRcIj5cclxuICAgICAgICAgICAgICA8TWVzc2FnZVNxdWFyZSBjbGFzc05hbWU9XCJoLTggdy04IG14LWF1dG8gbWItMiBvcGFjaXR5LTUwXCIgLz5cclxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtXCI+Tm8gY29tbWVudHMgeWV0IGZvciB7dmVuZG9yTmFtZX08L3A+XHJcbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC14cyBtdC0xXCI+QmUgdGhlIGZpcnN0IHRvIGFkZCBhIGNvbW1lbnQuPC9wPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgIHVwZGF0ZXMubWFwKCh1cGRhdGUpID0+IChcclxuICAgICAgICAgICAgICA8QWN0aXZpdHlFbnRyeSBrZXk9e3VwZGF0ZS5pZH0gdXBkYXRlPXt1cGRhdGV9IC8+XHJcbiAgICAgICAgICAgICkpXHJcbiAgICAgICAgICApfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvQ2FyZD5cclxuICApO1xyXG59XHJcbiJdLCJmaWxlIjoiQzovUHJvamVjdHMvU291cmNlIDQgSW5kdXN0cmllcy9zcmMvY29tcG9uZW50cy9hZG1pbi92ZW5kb3ItYWN0aXZpdHktbG9nLnRzeCJ9